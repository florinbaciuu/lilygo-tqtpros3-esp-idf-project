<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-73KGWFC8DM"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-73KGWFC8DM');
        </script><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ESP-NOW - ESP32 -  &mdash; ESP-IDF Programming Guide v5.4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=a60756f2" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=949a1ff5" />
      <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css?v=851bd809" />

  
    <link rel="canonical" href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/network/esp_now.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=c241bbaf"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=ff8fa330"></script>
        <script src="https://wavedrom.com/skins/default.js"></script>
        <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <script src="../../_static/js/theme.js"></script>

    
        

    <script type="text/javascript">
        DOCUMENTATION_OPTIONS.PAGENAME = 'api-reference/network/esp_now';
        DOCUMENTATION_OPTIONS.PROJECT_SLUG = 'esp-idf';
        DOCUMENTATION_OPTIONS.LATEST_BRANCH_NAME = 'master';
        DOCUMENTATION_OPTIONS.VERSIONS_URL = 'https://dl.espressif.com/dl/esp-idf/idf_versions.js';
        DOCUMENTATION_OPTIONS.LANGUAGES = ["en", "zh_CN"];
        DOCUMENTATION_OPTIONS.IDF_TARGET = 'esp32';
        DOCUMENTATION_OPTIONS.HAS_IDF_TARGETS = ["esp32", "esp32s2", "esp32s3", "esp32c3", "esp32c2", "esp32c5", "esp32c6", "esp32p4"]
        DOCUMENTATION_OPTIONS.RELEASE = 'v5.4.2';
        DOCUMENTATION_OPTIONS.LANGUAGE_URL = 'en';

    </script>

    <script type="text/javascript" src="https://dl.espressif.com/dl/esp-idf/idf_versions.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ESP-WIFI-MESH Programming Guide" href="esp-wifi-mesh.html" />
    <link rel="prev" title="Networking APIs" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            ESP-IDF Programming Guide
              <img src="../../_static/espressif-logo.svg" class="logo" alt="Logo"/>
          </a>

          
            <div class="selectors">
              <select id="target-select" style="width: 150px;" hidden>
                <option value="" disabled selected>Choose target...</option>
              </select>
            </div>
          

          <div class="selectors">
            <select id="version-select" style="width: 150px;" hidden>
              <option value="" disabled selected>Choose version...</option>
            </select>
          </div>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../get-started/index.html">Get Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api-conventions.html">API Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/index.html">Application Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/index.html">Bluetooth® API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-codes.html">Error Codes Reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Networking APIs</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html#wi-fi">Wi-Fi</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">ESP-NOW</a></li>
<li class="toctree-l4"><a class="reference internal" href="esp-wifi-mesh.html">ESP-WIFI-MESH Programming Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="esp_smartconfig.html">SmartConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="esp_wifi.html">Wi-Fi</a></li>
<li class="toctree-l4"><a class="reference internal" href="esp_dpp.html">Wi-Fi Easy Connect<sup>TM</sup> (DPP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="esp_nan.html">Wi-Fi Aware<sup>TM</sup> (NAN)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ethernet">Ethernet</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#thread">Thread</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#esp-netif">ESP-NETIF</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ip-network-layer">IP Network Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#application-layer">Application Layer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../peripherals/index.html">Peripherals API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kconfig.html">Project Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../provisioning/index.html">Provisioning API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.html">Storage API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../system/index.html">System API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hw-reference/index.html">Hardware Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api-guides/index.html">API Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration-guides/index.html">Migration Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../libraries-and-frameworks/index.html">Libraries and Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contributions Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">ESP-IDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COPYRIGHT.html">Copyrights and Licenses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../languages.html">Switch Between Languages</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ESP-IDF Programming Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="index.html">Networking APIs</a></li>
      <li class="breadcrumb-item active">ESP-NOW</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/espressif/esp-idf/blob/v5.4.2/docs/en/api-reference/network/esp_now.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="esp-now">
<h1>ESP-NOW<a class="headerlink" href="#esp-now" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="../../../../../zh_CN/v5.4.2/esp32/api-reference/network/esp_now.html">[中文]</a></p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>ESP-NOW is a kind of connectionless Wi-Fi communication protocol that is defined by Espressif. In ESP-NOW, application data is encapsulated in a vendor-specific action frame and then transmitted from one Wi-Fi device to another without connection.</p>
<p>CTR with CBC-MAC Protocol (CCMP) is used to protect the action frame for security. ESP-NOW is widely used in smart light, remote controlling, sensor, etc.</p>
</section>
<section id="frame-format">
<h2>Frame Format<a class="headerlink" href="#frame-format" title="Permalink to this heading"></a></h2>
<p>ESP-NOW uses a vendor-specific action frame to transmit ESP-NOW data. The default ESP-NOW bit rate is 1 Mbps.</p>
<p>Currently, ESP-NOW supports two versions: v1.0 and v2.0. The maximum packet length supported by v2.0 devices is 1470 (<code class="docutils literal notranslate"><span class="pre">ESP_NOW_MAX_DATA_LEN_V2</span></code>) bytes, while the maximum packet length supported by v1.0 devices is 250 (<code class="docutils literal notranslate"><span class="pre">ESP_NOW_MAX_DATA_LEN</span></code>)  bytes.</p>
<p>The v2.0 devices are capable of receiving packets from both v2.0 and v1.0 devices. In contrast, v1.0 devices can only receive packets from other v1.0 devices.
However, v1.0 devices can receive v2.0 packets if the packet length is less than or equal to ESP_NOW_MAX_IE_DATA_LEN.
For packets exceeding this length, the v1.0 devices will either truncate the data to the first ESP_NOW_MAX_IE_DATA_LEN bytes or discard the packet entirely.
For detailed behavior, please refer to the documentation corresponding to the specific IDF version.</p>
<p>The format of the vendor-specific action frame is as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>------------------------------------------------------------------------------------------------------------
| MAC Header | Category Code | Organization Identifier | Random Values | Vendor Specific Content |   FCS   |
------------------------------------------------------------------------------------------------------------
  24 bytes         1 byte              3 bytes               4 bytes             7-x bytes        4 bytes
</pre></div>
</div>
<ul class="simple">
<li><p>Category Code: The Category Code field is set to the value (127) indicating the vendor-specific category.</p></li>
<li><p>Organization Identifier: The Organization Identifier contains a unique identifier (0x18fe34), which is the first three bytes of MAC address applied by Espressif.</p></li>
<li><p>Random Value: The Random Value filed is used to prevents relay attacks.</p></li>
<li><p>Vendor Specific Content: The Vendor Specific Content contains several (at least one) vendor-specific element fields. For version v2.0, x = 1512(1470 + 6*7), for version v1.0, x = 257(250 + 7).</p></li>
</ul>
<p>The format of the vendor-specific element frame is as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ESP-NOW v1.0:
------------------------------------------------------------------------------------------
| Element ID | Length | Organization Identifier | Type | Reserved | Version |    Body    |
------------------------------------------------------------------------------------------
                                                         7~4 bits | 3~0 bits
    1 byte     1 byte            3 bytes         1 byte        1 byte         0-250 bytes

ESP-NOW v2.0:
-----------------------------------------------------------------------------------------------------
| Element ID | Length | Organization Identifier | Type | Reserved | More data |Version |    Body    |
-----------------------------------------------------------------------------------------------------
                                                         7~5 bits |   1 bit   |3~0 bits
    1 byte     1 byte            3 bytes         1 byte             1 byte                0-250 bytes
</pre></div>
</div>
<ul class="simple">
<li><p>Element ID: The Element ID field is set to the value (221), indicating the vendor-specific element.</p></li>
<li><p>Length: The length is the total length of Organization Identifier, Type, Version and Body, the maximum value is 255.</p></li>
<li><p>Organization Identifier: The Organization Identifier contains a unique identifier (0x18fe34), which is the first three bytes of MAC address applied by Espressif.</p></li>
<li><p>Type: The Type field is set to the value (4) indicating ESP-NOW.</p></li>
<li><p>Version: The Version field is set to the version of ESP-NOW.</p></li>
<li><p>Body: The Body contains the actual ESP-NOW data to be transmitted.</p></li>
</ul>
<p>As ESP-NOW is connectionless, the MAC header is a little different from that of standard frames. The FromDS and ToDS bits of FrameControl field are both 0. The first address field is set to the destination address. The second address field is set to the source address. The third address field is set to broadcast address (0xff:0xff:0xff:0xff:0xff:0xff).</p>
</section>
<section id="security">
<h2>Security<a class="headerlink" href="#security" title="Permalink to this heading"></a></h2>
<p>ESP-NOW uses the CCMP method, which is described in IEEE Std. 802.11-2012, to protect the vendor-specific action frame. The Wi-Fi device maintains a Primary Master Key (PMK) and several Local Master Keys (LMKs, each paired device has one LMK). The lengths of both PMK and LMK are 16 bytes.</p>
<blockquote>
<div><ul class="simple">
<li><p>PMK is used to encrypt LMK with the AES-128 algorithm. Call <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_set_pmk()</span></code> to set PMK. If PMK is not set, a default PMK will be used.</p></li>
<li><p>LMK of the paired device is used to encrypt the vendor-specific action frame with the CCMP method. If the LMK of the paired device is not set, the vendor-specific action frame will not be encrypted.</p></li>
</ul>
</div></blockquote>
<p>Encrypting multicast vendor-specific action frame is not supported.</p>
</section>
<section id="initialization-and-deinitialization">
<h2>Initialization and Deinitialization<a class="headerlink" href="#initialization-and-deinitialization" title="Permalink to this heading"></a></h2>
<p>Call <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_init()</span></code> to initialize ESP-NOW and <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_deinit()</span></code> to de-initialize ESP-NOW. ESP-NOW data must be transmitted after Wi-Fi is started, so it is recommended to start Wi-Fi before initializing ESP-NOW and stop Wi-Fi after de-initializing ESP-NOW.</p>
<p>When <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_deinit()</span></code> is called, all of the information of paired devices are deleted.</p>
</section>
<section id="add-paired-device">
<h2>Add Paired Device<a class="headerlink" href="#add-paired-device" title="Permalink to this heading"></a></h2>
<p>Call <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_add_peer()</span></code> to add the device to the paired device list before you send data to this device. If security is enabled, the LMK must be set. A device with a broadcast MAC address must be added before sending broadcast data.</p>
<p>You can send ESP-NOW data via both the Station and the SoftAP interface. Make sure that the interface is enabled before sending ESP-NOW data.</p>
<p>The range of the channel of paired devices is from 0 to 14. If the channel is set to 0, data will be sent on the current channel. Otherwise, the channel must be set as the channel that the local device is on.</p>
<p>For the receiving device, calling <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_add_peer()</span></code> is not required. If no paired device is added, it can only receive broadcast packets and unencrypted unicast packets. To receive encrypted unicast packets, a paired device must be added, and the same LMK must be set.</p>
<p>The maximum number of paired devices is 20, and the paired encryption devices are no more than 17, the default is 7. If you want to change the number of paired encryption devices, set <a class="reference internal" href="../kconfig.html#config-esp-wifi-espnow-max-encrypt-num"><span class="std std-ref">CONFIG_ESP_WIFI_ESPNOW_MAX_ENCRYPT_NUM</span></a> in the Wi-Fi component configuration menu.</p>
</section>
<section id="send-esp-now-data">
<h2>Send ESP-NOW Data<a class="headerlink" href="#send-esp-now-data" title="Permalink to this heading"></a></h2>
<p>Call <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_send()</span></code> to send ESP-NOW data and <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_register_send_cb()</span></code> to register sending callback function. It will return <cite>ESP_NOW_SEND_SUCCESS</cite> in sending callback function if the data is received successfully on the MAC layer. Otherwise, it will return <cite>ESP_NOW_SEND_FAIL</cite>. Several reasons can lead to ESP-NOW fails to send data. For example, the destination device does not exist; the channels of the devices are not the same; the action frame is lost when transmitting on the air, etc. It is not guaranteed that application layer can receive the data. If necessary, send back ack data when receiving ESP-NOW data. If receiving ack data timeouts, retransmit the ESP-NOW data. A sequence number can also be assigned to ESP-NOW data to drop the duplicate data.</p>
<p>If there is a lot of ESP-NOW data to send, call <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_send()</span></code> to send less than or equal to the maximum packet length (v1.0 is 250 bytes, v2.0 is 1470 bytes) of data once a time. Note that too short interval between sending two ESP-NOW data may lead to disorder of sending callback function. So, it is recommended that sending the next ESP-NOW data after the sending callback function of the previous sending has returned. The sending callback function runs from a high-priority Wi-Fi task. So, do not do lengthy operations in the callback function. Instead, post the necessary data to a queue and handle it from a lower priority task.</p>
</section>
<section id="receiving-esp-now-data">
<h2>Receiving ESP-NOW Data<a class="headerlink" href="#receiving-esp-now-data" title="Permalink to this heading"></a></h2>
<p>Call <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_register_recv_cb()</span></code> to register receiving callback function.  Call the receiving callback function when receiving ESP-NOW. The receiving callback function also runs from the Wi-Fi task. So, do not do lengthy operations in the callback function.
Instead, post the necessary data to a queue and handle it from a lower priority task.</p>
</section>
<section id="config-esp-now-rate">
<h2>Config ESP-NOW Rate<a class="headerlink" href="#config-esp-now-rate" title="Permalink to this heading"></a></h2>
<p>Call <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_wifi_config_espnow_rate()</span></code> to config ESP-NOW rate of specified interface. Make sure that the interface is enabled before config rate. This API should be called after <a class="reference internal" href="esp_wifi.html#_CPPv414esp_wifi_startv" title="esp_wifi_start"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_wifi_start()</span></code></a>.</p>
</section>
<section id="config-esp-now-power-saving-parameter">
<h2>Config ESP-NOW Power-saving Parameter<a class="headerlink" href="#config-esp-now-power-saving-parameter" title="Permalink to this heading"></a></h2>
<p>Sleep is supported only when ESP32 is configured as station.</p>
<p>Call <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_now_set_wake_window()</span></code> to configure Window for ESP-NOW RX at sleep. The default value is the maximum, which allowing RX all the time.</p>
<p>If Power-saving is needed for ESP-NOW, call <a class="reference internal" href="esp_wifi.html#_CPPv448esp_wifi_connectionless_module_set_wake_interval8uint16_t" title="esp_wifi_connectionless_module_set_wake_interval"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_wifi_connectionless_module_set_wake_interval()</span></code></a> to configure Interval as well.</p>
<p>Please refer to <a class="reference internal" href="../../api-guides/wifi.html#connectionless-module-power-save"><span class="std std-ref">connectionless module power save</span></a> to get more detail.</p>
</section>
<section id="application-examples">
<h2>Application Examples<a class="headerlink" href="#application-examples" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/tree/v5.4.2/examples/wifi/espnow">wifi/espnow</a> demonstrates how to use the ESPNOW feature of ESP32's Wi-Fi, including starting Wi-Fi, initializing ESP-NOW, registering ESP-NOW sending or receiving callback function, adding ESP-NOW peer information, and sending and receiving ESP-NOW data between two devices.</p></li>
</ul>
</section>
<section id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this heading"></a></h2>
<section id="header-file">
<h3>Header File<a class="headerlink" href="#header-file" title="Permalink to this heading"></a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/blob/v5.4.2/components/esp_wifi/include/esp_now.h">components/esp_wifi/include/esp_now.h</a></p></li>
<li><p>This header file can be included with:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;esp_now.h&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>This header file is a part of the API provided by the <code class="docutils literal notranslate"><span class="pre">esp_wifi</span></code> component. To declare that your component depends on <code class="docutils literal notranslate"><span class="pre">esp_wifi</span></code>, add the following to your CMakeLists.txt:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>REQUIRES esp_wifi
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>PRIV_REQUIRES esp_wifi
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="structures">
<h3>Structures<a class="headerlink" href="#structures" title="Permalink to this heading"></a></h3>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv417esp_now_peer_info">
<span id="_CPPv317esp_now_peer_info"></span><span id="_CPPv217esp_now_peer_info"></span><span id="esp_now_peer_info"></span><span class="target" id="structesp__now__peer__info"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_now_peer_info</span></span></span><a class="headerlink" href="#_CPPv417esp_now_peer_info" title="Permalink to this definition"></a><br /></dt>
<dd><p>ESPNOW peer information parameters. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_now_peer_info9peer_addrE">
<span id="_CPPv3N17esp_now_peer_info9peer_addrE"></span><span id="_CPPv2N17esp_now_peer_info9peer_addrE"></span><span id="esp_now_peer_info::peer_addr__uint8_tA"></span><span class="target" id="structesp__now__peer__info_1ae9f5500b248a6ba7a05c8272bf8b0c5b"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">peer_addr</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">ESP_NOW_ETH_ALEN</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N17esp_now_peer_info9peer_addrE" title="Permalink to this definition"></a><br /></dt>
<dd><p>ESPNOW peer MAC address that is also the MAC address of station or softap </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_now_peer_info3lmkE">
<span id="_CPPv3N17esp_now_peer_info3lmkE"></span><span id="_CPPv2N17esp_now_peer_info3lmkE"></span><span id="esp_now_peer_info::lmk__uint8_tA"></span><span class="target" id="structesp__now__peer__info_1ab88af5a4967526436461d367c25f18b8"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lmk</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">ESP_NOW_KEY_LEN</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N17esp_now_peer_info3lmkE" title="Permalink to this definition"></a><br /></dt>
<dd><p>ESPNOW peer local master key that is used to encrypt data </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_now_peer_info7channelE">
<span id="_CPPv3N17esp_now_peer_info7channelE"></span><span id="_CPPv2N17esp_now_peer_info7channelE"></span><span id="esp_now_peer_info::channel__uint8_t"></span><span class="target" id="structesp__now__peer__info_1a51a122de026dcd84844f1d03eed1dfe9"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">channel</span></span></span><a class="headerlink" href="#_CPPv4N17esp_now_peer_info7channelE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Wi-Fi channel that peer uses to send/receive ESPNOW data. If the value is 0, use the current channel which station or softap is on. Otherwise, it must be set as the channel that station or softap is on. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_now_peer_info5ifidxE">
<span id="_CPPv3N17esp_now_peer_info5ifidxE"></span><span id="_CPPv2N17esp_now_peer_info5ifidxE"></span><span id="esp_now_peer_info::ifidx__wifi_interface_t"></span><span class="target" id="structesp__now__peer__info_1a8654fff80b3c890cc495b06ceb4eee35"></span><a class="reference internal" href="esp_wifi.html#_CPPv416wifi_interface_t" title="wifi_interface_t"><span class="n"><span class="pre">wifi_interface_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ifidx</span></span></span><a class="headerlink" href="#_CPPv4N17esp_now_peer_info5ifidxE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Wi-Fi interface that peer uses to send/receive ESPNOW data </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_now_peer_info7encryptE">
<span id="_CPPv3N17esp_now_peer_info7encryptE"></span><span id="_CPPv2N17esp_now_peer_info7encryptE"></span><span id="esp_now_peer_info::encrypt__b"></span><span class="target" id="structesp__now__peer__info_1aedc05c5b5bcfdaf22d91a2cecf56d3fb"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">encrypt</span></span></span><a class="headerlink" href="#_CPPv4N17esp_now_peer_info7encryptE" title="Permalink to this definition"></a><br /></dt>
<dd><p>ESPNOW data that this peer sends/receives is encrypted or not </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_now_peer_info4privE">
<span id="_CPPv3N17esp_now_peer_info4privE"></span><span id="_CPPv2N17esp_now_peer_info4privE"></span><span id="esp_now_peer_info::priv__voidP"></span><span class="target" id="structesp__now__peer__info_1a89e13f5c9425c6bfa9f03fa9e07bb398"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">priv</span></span></span><a class="headerlink" href="#_CPPv4N17esp_now_peer_info4privE" title="Permalink to this definition"></a><br /></dt>
<dd><p>ESPNOW peer private data </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv416esp_now_peer_num">
<span id="_CPPv316esp_now_peer_num"></span><span id="_CPPv216esp_now_peer_num"></span><span id="esp_now_peer_num"></span><span class="target" id="structesp__now__peer__num"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_now_peer_num</span></span></span><a class="headerlink" href="#_CPPv416esp_now_peer_num" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of ESPNOW peers which exist currently. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N16esp_now_peer_num9total_numE">
<span id="_CPPv3N16esp_now_peer_num9total_numE"></span><span id="_CPPv2N16esp_now_peer_num9total_numE"></span><span id="esp_now_peer_num::total_num__i"></span><span class="target" id="structesp__now__peer__num_1ae49c234f9b7e9d30b5e244c830c326be"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">total_num</span></span></span><a class="headerlink" href="#_CPPv4N16esp_now_peer_num9total_numE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Total number of ESPNOW peers, maximum value is ESP_NOW_MAX_TOTAL_PEER_NUM </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N16esp_now_peer_num11encrypt_numE">
<span id="_CPPv3N16esp_now_peer_num11encrypt_numE"></span><span id="_CPPv2N16esp_now_peer_num11encrypt_numE"></span><span id="esp_now_peer_num::encrypt_num__i"></span><span class="target" id="structesp__now__peer__num_1a8a87b1a626986e3f64aa2beeae0a0c85"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">encrypt_num</span></span></span><a class="headerlink" href="#_CPPv4N16esp_now_peer_num11encrypt_numE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of encrypted ESPNOW peers, maximum value is ESP_NOW_MAX_ENCRYPT_PEER_NUM </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv417esp_now_recv_info">
<span id="_CPPv317esp_now_recv_info"></span><span id="_CPPv217esp_now_recv_info"></span><span id="esp_now_recv_info"></span><span class="target" id="structesp__now__recv__info"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_now_recv_info</span></span></span><a class="headerlink" href="#_CPPv417esp_now_recv_info" title="Permalink to this definition"></a><br /></dt>
<dd><p>ESPNOW packet information. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_now_recv_info8src_addrE">
<span id="_CPPv3N17esp_now_recv_info8src_addrE"></span><span id="_CPPv2N17esp_now_recv_info8src_addrE"></span><span id="esp_now_recv_info::src_addr__uint8_tP"></span><span class="target" id="structesp__now__recv__info_1a682526de07fede6466b10982e020ce90"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">src_addr</span></span></span><a class="headerlink" href="#_CPPv4N17esp_now_recv_info8src_addrE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Source address of ESPNOW packet </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_now_recv_info8des_addrE">
<span id="_CPPv3N17esp_now_recv_info8des_addrE"></span><span id="_CPPv2N17esp_now_recv_info8des_addrE"></span><span id="esp_now_recv_info::des_addr__uint8_tP"></span><span class="target" id="structesp__now__recv__info_1ab728a92fa87b246717736b7951ca7f00"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">des_addr</span></span></span><a class="headerlink" href="#_CPPv4N17esp_now_recv_info8des_addrE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destination address of ESPNOW packet </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_now_recv_info7rx_ctrlE">
<span id="_CPPv3N17esp_now_recv_info7rx_ctrlE"></span><span id="_CPPv2N17esp_now_recv_info7rx_ctrlE"></span><span id="esp_now_recv_info::rx_ctrl__wifi_pkt_rx_ctrl_tP"></span><span class="target" id="structesp__now__recv__info_1acd2ce7d040b87d97c8efcb571b6d9643"></span><a class="reference internal" href="esp_wifi.html#_CPPv418wifi_pkt_rx_ctrl_t" title="wifi_pkt_rx_ctrl_t"><span class="n"><span class="pre">wifi_pkt_rx_ctrl_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">rx_ctrl</span></span></span><a class="headerlink" href="#_CPPv4N17esp_now_recv_info7rx_ctrlE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Rx control info of ESPNOW packet </p>
</dd></dl>

</div>
</dd></dl>

</section>
</section>
</section>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

           </div>
             <div class="articleComments">

<style>
    .expand-feedback-content {
        display: none;
    }
    .click-like-or-dislike {
        background-color: #d3d3d3;
        pointer-events: none;
    }
</style>

<script>
    function submitFeedbackForm(user_likes_document) {
        // Send to GA4 the user reaction
        gtag('event', 'user_reaction', {
            'user_likes_document': user_likes_document
        });

        if (user_likes_document === 1) {
            document.querySelector('.like-btn').classList.add('click-like-or-dislike');
            document.getElementById("expandContentLike").style.display = 'block';
        } else {
            document.querySelector('.dislike-btn').classList.add('click-like-or-dislike');
            document.getElementById("expandContent").style.display = 'block';
        }

        document.querySelector('.like-btn').style.pointerEvents = 'none';
        document.querySelector('.dislike-btn').style.pointerEvents = 'none';
    }
</script>

<hr>

<p style="text-align:center"><strong>Was this page helpful?</strong></p>
<p style="text-align:center">
    <button class="like-btn" onclick="submitFeedbackForm(1)">
        <svg aria-hidden="true" focusable="false" class="color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom;overflow:visible">
            <path d="M8.834.066c.763.087 1.5.295 2.01.884.505.581.656 1.378.656 2.3 0 .467-.087 1.119-.157 1.637L11.328 5h1.422c.603 0 1.174.085 1.668.333.508.254.911.679 1.137 1.2.453.998.438 2.447.188 4.316l-.04.306c-.105.79-.195 1.473-.313 2.033-.131.63-.315 1.209-.668 1.672C13.97 15.847 12.706 16 11 16c-1.848 0-3.234-.333-4.388-.653-.165-.045-.323-.09-.475-.133-.658-.186-1.2-.34-1.725-.415A1.75 1.75 0 0 1 2.75 16h-1A1.75 1.75 0 0 1 0 14.25v-7.5C0 5.784.784 5 1.75 5h1a1.75 1.75 0 0 1 1.514.872c.258-.105.59-.268.918-.508C5.853 4.874 6.5 4.079 6.5 2.75v-.5c0-1.202.994-2.337 2.334-2.184ZM4.5 13.3c.705.088 1.39.284 2.072.478l.441.125c1.096.305 2.334.598 3.987.598 1.794 0 2.28-.223 2.528-.549.147-.193.276-.505.394-1.07.105-.502.188-1.124.295-1.93l.04-.3c.25-1.882.189-2.933-.068-3.497a.921.921 0 0 0-.442-.48c-.208-.104-.52-.174-.997-.174H11c-.686 0-1.295-.577-1.206-1.336.023-.192.05-.39.076-.586.065-.488.13-.97.13-1.328 0-.809-.144-1.15-.288-1.316-.137-.158-.402-.304-1.048-.378C8.357 1.521 8 1.793 8 2.25v.5c0 1.922-.978 3.128-1.933 3.825a5.831 5.831 0 0 1-1.567.81ZM2.75 6.5h-1a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h1a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
        </svg>
    </button>
    <button class="dislike-btn" onclick="submitFeedbackForm(0)">
        <svg aria-hidden="true" focusable="false" class="" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom;overflow:visible">
            <path d="M7.083 15.986c-.763-.087-1.499-.295-2.011-.884-.504-.581-.655-1.378-.655-2.299 0-.468.087-1.12.157-1.638l.015-.112H3.167c-.603 0-1.174-.086-1.669-.334a2.415 2.415 0 0 1-1.136-1.2c-.454-.998-.438-2.447-.188-4.316l.04-.306C.32 4.108.41 3.424.526 2.864c.132-.63.316-1.209.669-1.672C1.947.205 3.211.053 4.917.053c1.848 0 3.234.332 4.388.652l.474.133c.658.187 1.201.341 1.726.415a1.75 1.75 0 0 1 1.662-1.2h1c.966 0 1.75.784 1.75 1.75v7.5a1.75 1.75 0 0 1-1.75 1.75h-1a1.75 1.75 0 0 1-1.514-.872c-.259.105-.59.268-.919.508-.671.491-1.317 1.285-1.317 2.614v.5c0 1.201-.994 2.336-2.334 2.183Zm4.334-13.232c-.706-.089-1.39-.284-2.072-.479l-.441-.125c-1.096-.304-2.335-.597-3.987-.597-1.794 0-2.28.222-2.529.548-.147.193-.275.505-.393 1.07-.105.502-.188 1.124-.295 1.93l-.04.3c-.25 1.882-.19 2.933.067 3.497a.923.923 0 0 0 .443.48c.208.104.52.175.997.175h1.75c.685 0 1.295.577 1.205 1.335-.022.192-.049.39-.075.586-.066.488-.13.97-.13 1.329 0 .808.144 1.15.288 1.316.137.157.401.303 1.048.377.307.035.664-.237.664-.693v-.5c0-1.922.978-3.127 1.932-3.825a5.878 5.878 0 0 1 1.568-.809Zm1.75 6.798h1a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25h-1a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25Z"></path>
        </svg>
    </button>
</p>

<div class="expand-feedback-content" id="expandContentLike">
    <ul style="text-align:center">
        <li>Thank you! We received your feedback.</li>
        <li>If you have any comments, fill in <a href='https://www.espressif.com/en/company/documents/documentation_feedback?docId=4287&sections=ESP-NOW (api-reference/network/esp_now)&version=esp32 v5.4.2 (v5.4.2)'>Espressif Documentation Feedback Form</a>.</li>
    </ul>
</div>

<div class="expand-feedback-content" id="expandContent">
    <ul style="text-align:center">
        <li>We value your feedback.</li>
        <li>Let us know how we can improve this page by filling in <a href='https://www.espressif.com/en/company/documents/documentation_feedback?docId=4287&sections=ESP-NOW (api-reference/network/esp_now)&version=esp32 v5.4.2 (v5.4.2)'>Espressif Documentation Feedback Form</a>.</li>
    </ul>
</div>

<br>


             </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Networking APIs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="esp-wifi-mesh.html" class="btn btn-neutral float-right" title="ESP-WIFI-MESH Programming Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016 - 2025, Espressif Systems (Shanghai) Co., Ltd.</p>
  </div>

  <ul class="footer">
        <li>
	    
            
            Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/espressif/sphinx_idf_theme">theme</a>  based on <a href="https://github.com/readthedocs/sphinx_rtd_theme">Read the Docs Sphinx Theme</a>.
         </li>
    <li class="footer-aside">
        <a href="../../esp-idf-en-v5.4.2.zip"> Download HTML</a>
    </li>

  </ul> 

</footer>
        </div>
      </div>
    </section>
  </div>

  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>