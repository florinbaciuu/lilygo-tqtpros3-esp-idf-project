<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-73KGWFC8DM"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-73KGWFC8DM');
        </script><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Two-Wire Automotive Interface (TWAI) - ESP32 -  &mdash; ESP-IDF Programming Guide v5.4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=a60756f2" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=949a1ff5" />
      <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css?v=851bd809" />

  
    <link rel="canonical" href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/peripherals/twai.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=c241bbaf"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=ff8fa330"></script>
        <script src="https://wavedrom.com/skins/default.js"></script>
        <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <script src="../../_static/js/theme.js"></script>

    
        

    <script type="text/javascript">
        DOCUMENTATION_OPTIONS.PAGENAME = 'api-reference/peripherals/twai';
        DOCUMENTATION_OPTIONS.PROJECT_SLUG = 'esp-idf';
        DOCUMENTATION_OPTIONS.LATEST_BRANCH_NAME = 'master';
        DOCUMENTATION_OPTIONS.VERSIONS_URL = 'https://dl.espressif.com/dl/esp-idf/idf_versions.js';
        DOCUMENTATION_OPTIONS.LANGUAGES = ["en", "zh_CN"];
        DOCUMENTATION_OPTIONS.IDF_TARGET = 'esp32';
        DOCUMENTATION_OPTIONS.HAS_IDF_TARGETS = ["esp32", "esp32s2", "esp32s3", "esp32c3", "esp32c2", "esp32c5", "esp32c6", "esp32p4"]
        DOCUMENTATION_OPTIONS.RELEASE = 'v5.4.2';
        DOCUMENTATION_OPTIONS.LANGUAGE_URL = 'en';

    </script>

    <script type="text/javascript" src="https://dl.espressif.com/dl/esp-idf/idf_versions.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Universal Asynchronous Receiver/Transmitter (UART)" href="uart.html" />
    <link rel="prev" title="Touch Sensor" href="touch_pad.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            ESP-IDF Programming Guide
              <img src="../../_static/espressif-logo.svg" class="logo" alt="Logo"/>
          </a>

          
            <div class="selectors">
              <select id="target-select" style="width: 150px;" hidden>
                <option value="" disabled selected>Choose target...</option>
              </select>
            </div>
          

          <div class="selectors">
            <select id="version-select" style="width: 150px;" hidden>
              <option value="" disabled selected>Choose version...</option>
            </select>
          </div>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../get-started/index.html">Get Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api-conventions.html">API Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/index.html">Application Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/index.html">Bluetooth® API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-codes.html">Error Codes Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network/index.html">Networking APIs</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Peripherals API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="adc_oneshot.html">Analog to Digital Converter (ADC) Oneshot Mode Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="adc_continuous.html">Analog to Digital Converter (ADC) Continuous Mode Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="adc_calibration.html">Analog to Digital Converter (ADC) Calibration Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="clk_tree.html">Clock Tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="dac.html">Digital To Analog Converter (DAC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="gpio.html">GPIO &amp; RTC GPIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="gptimer.html">General Purpose Timer (GPTimer)</a></li>
<li class="toctree-l3"><a class="reference internal" href="i2c.html">Inter-Integrated Circuit (I2C)</a></li>
<li class="toctree-l3"><a class="reference internal" href="i2s.html">Inter-IC Sound (I2S)</a></li>
<li class="toctree-l3"><a class="reference internal" href="lcd/index.html">LCD</a></li>
<li class="toctree-l3"><a class="reference internal" href="ledc.html">LED Control (LEDC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mcpwm.html">Motor Control Pulse Width Modulator (MCPWM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcnt.html">Pulse Counter (PCNT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="rmt.html">Remote Control Transceiver (RMT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="sd_pullup_requirements.html">SD Pull-up Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="sdmmc_host.html">SDMMC Host Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="sdspi_host.html">SD SPI Host Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="sdio_slave.html">SDIO Card Slave Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="sdm.html">Sigma-Delta Modulation (SDM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="spi_flash/index.html">SPI Flash API</a></li>
<li class="toctree-l3"><a class="reference internal" href="spi_master.html">SPI Master Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="spi_slave.html">SPI Slave Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="touch_pad.html">Touch Sensor</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Two-Wire Automotive Interface (TWAI)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#twai-protocol-summary">TWAI Protocol Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="#signal-lines-and-transceiver">Signal Lines and Transceiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-naming-conventions">API Naming Conventions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#driver-configuration">Driver Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#driver-operation">Driver Operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-reference">API Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="uart.html">Universal Asynchronous Receiver/Transmitter (UART)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kconfig.html">Project Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../provisioning/index.html">Provisioning API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.html">Storage API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../system/index.html">System API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hw-reference/index.html">Hardware Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api-guides/index.html">API Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration-guides/index.html">Migration Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../libraries-and-frameworks/index.html">Libraries and Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contributions Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">ESP-IDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COPYRIGHT.html">Copyrights and Licenses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../languages.html">Switch Between Languages</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ESP-IDF Programming Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="index.html">Peripherals API</a></li>
      <li class="breadcrumb-item active">Two-Wire Automotive Interface (TWAI)</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/espressif/esp-idf/blob/v5.4.2/docs/en/api-reference/peripherals/twai.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="two-wire-automotive-interface-twai">
<h1>Two-Wire Automotive Interface (TWAI)<a class="headerlink" href="#two-wire-automotive-interface-twai" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="../../../../../zh_CN/v5.4.2/esp32/api-reference/peripherals/twai.html">[中文]</a></p>
<p>This programming guide is split into the following sections:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id13">Overview</a></p></li>
<li><p><a class="reference internal" href="#twai-protocol-summary" id="id14">TWAI Protocol Summary</a></p></li>
<li><p><a class="reference internal" href="#signal-lines-and-transceiver" id="id15">Signal Lines and Transceiver</a></p></li>
<li><p><a class="reference internal" href="#api-naming-conventions" id="id16">API Naming Conventions</a></p></li>
<li><p><a class="reference internal" href="#driver-configuration" id="id17">Driver Configuration</a></p></li>
<li><p><a class="reference internal" href="#driver-operation" id="id18">Driver Operation</a></p></li>
<li><p><a class="reference internal" href="#examples" id="id19">Examples</a></p></li>
<li><p><a class="reference internal" href="#api-reference" id="id20">API Reference</a></p></li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>The Two-Wire Automotive Interface (TWAI) is a real-time serial communication protocol suited for automotive and industrial applications. It is compatible with ISO11898-1 Classical frames, thus can support Standard Frame Format (11-bit ID) and Extended Frame Format (29-bit ID). The ESP32 contains 1 TWAI controller(s) that can be configured to communicate on a TWAI bus via an external transceiver.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The TWAI controller is not compatible with ISO11898-1 FD Format frames, and will interpret such frames as errors.</p>
</div>
</section>
<section id="twai-protocol-summary">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">TWAI Protocol Summary</a><a class="headerlink" href="#twai-protocol-summary" title="Permalink to this heading"></a></h2>
<p>The TWAI is a multi-master, multi-cast, asynchronous, serial communication protocol. TWAI also supports error detection and signalling, and inbuilt message prioritization.</p>
<p><strong>Multi-master:</strong> Any node on the bus can initiate the transfer of a message.</p>
<p><strong>Multi-cast:</strong> When a node transmits a message, all nodes on the bus will receive the message (i.e., broadcast) thus ensuring data consistency across all nodes. However, some nodes can selectively choose which messages to accept via the use of acceptance filtering (multi-cast).</p>
<p><strong>Asynchronous:</strong> The bus does not contain a clock signal. All nodes on the bus operate at the same bit rate and synchronize using the edges of the bits transmitted on the bus.</p>
<p><strong>Error Detection and Signaling:</strong> Every node constantly monitors the bus. When any node detects an error, it signals the detection by transmitting an error frame. Other nodes will receive the error frame and transmit their own error frames in response. This results in an error detection being propagated to all nodes on the bus.</p>
<p><strong>Message Priorities:</strong> Messages contain an ID field. If two or more nodes attempt to transmit simultaneously, the node transmitting the message with the lower ID value will win arbitration of the bus. All other nodes will become receivers ensuring that there is at most one transmitter at any time.</p>
<section id="twai-messages">
<h3>TWAI Messages<a class="headerlink" href="#twai-messages" title="Permalink to this heading"></a></h3>
<p>TWAI Messages are split into Data Frames and Remote Frames. Data Frames are used to deliver a data payload to other nodes, whereas a Remote Frame is used to request a Data Frame from other nodes, and other nodes can optionally respond with a Data Frame. Data and Remote Frames have two frame formats known as <strong>Extended Frame</strong> and <strong>Standard Frame</strong> which contain a 29-bit ID and an 11-bit ID respectively. A TWAI message consists of the following fields:</p>
<blockquote>
<div><ul class="simple">
<li><p>29-bit or 11-bit ID: Determines the priority of the message, and lower value has higher priority.</p></li>
<li><p>Data Length Code (DLC) between 0 to 8: Indicates in bytes the size of the data payload for a Data Frame, or the amount of data to request for a Remote Frame.</p></li>
<li><p>Up to 8 bytes of data for a Data Frame, which should match DLC.</p></li>
</ul>
</div></blockquote>
</section>
<section id="error-states-and-counters">
<h3>Error States and Counters<a class="headerlink" href="#error-states-and-counters" title="Permalink to this heading"></a></h3>
<p>The TWAI protocol implements a feature known as &quot;fault confinement&quot; where a persistently erroneous node will eventually eliminate itself from the bus. This is implemented by requiring every node to maintain two internal error counters known as the <strong>Transmit Error Counter (TEC)</strong> and the <strong>Receive Error Counter (REC)</strong>. The two error counters are incremented and decremented according to a set of rules where the counters increase on an error, and decrease on a successful message transmission/reception. The values of the counters are used to determine a node's <strong>error state</strong>, namely <strong>Error Active</strong>, <strong>Error Passive</strong>, and <strong>Bus-Off</strong>.</p>
<p><strong>Error Active:</strong> A node is Error Active when <strong>both TEC and REC are less than 128</strong> and indicates that the node is operating normally. Error Active nodes are allowed to participate in bus communications, and will actively signal the detection of any errors by automatically transmitting an <strong>Active Error Flag</strong> over the bus.</p>
<p><strong>Error Passive:</strong> A node is Error Passive when <strong>either the TEC or REC becomes greater than or equal to 128</strong>. Error Passive nodes are still able to take part in bus communications, but will instead transmit a <strong>Passive Error Flag</strong> upon detection of an error.</p>
<p><strong>Bus-Off:</strong> A node becomes Bus-Off when the <strong>TEC becomes greater than or equal to 256</strong>. A Bus-Off node is unable to influence the bus in any manner, essentially disconnected from the bus, thus eliminating itself from the bus. A node will remain in the Bus-Off state until it undergoes bus-off recovery.</p>
</section>
</section>
<section id="signal-lines-and-transceiver">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Signal Lines and Transceiver</a><a class="headerlink" href="#signal-lines-and-transceiver" title="Permalink to this heading"></a></h2>
<p>The TWAI controller does not contain an integrated transceiver. Therefore, to connect the TWAI controller to a TWAI bus, <strong>an external transceiver is required</strong>. The type of external transceiver used should depend on the application's physical layer specification. E.g., using SN65HVD23x transceivers for ISO 11898-2 compatibility.</p>
<p>The TWAI controller's interface consists of four signal lines known as <strong>TX, RX, BUS-OFF, and CLKOUT</strong>. These four signal lines can be routed through the GPIO Matrix to the ESP32's GPIO pads.</p>
<figure class="align-center" id="id7">
<div class="align-default"><img height="360" src="../../_images/blockdiag-c326ed55cb4352a8aa1ab9fb7c7fb11eab3d98f1.png" width="704" /></div>
<figcaption>
<p><span class="caption-text">Signal lines of the TWAI controller</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p><strong>TX and RX:</strong> The TX and RX signal lines are required to interface with an external transceiver. Both signal lines represent/interpret a dominant bit as a low logic level (0 V) and a recessive bit as a high logic level (3.3 V).</p>
<p><strong>BUS-OFF:</strong> The BUS-OFF signal line is <strong>optional</strong> and is set to a low logic level (0 V) whenever the TWAI controller reaches a bus-off state. The BUS-OFF signal line is set to a high logic level (3.3 V) otherwise.</p>
<p><strong>CLKOUT:</strong> The CLKOUT signal line is <strong>optional</strong> and outputs a prescaled version of the controller's source clock.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An external transceiver <strong>must internally loop back the TX to RX</strong> such that a change in logic level to the TX signal line can be observed on the RX line. Failing to do so will cause the TWAI controller to interpret differences in logic levels between the two signal lines as a loss in arbitration or a bit error.</p>
</div>
</section>
<section id="api-naming-conventions">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">API Naming Conventions</a><a class="headerlink" href="#api-naming-conventions" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The TWAI driver provides two sets of API. One is handle-free and is widely used in IDF versions earlier than v5.2, but it can only support one TWAI hardware controller. The other set is with handles, and the function name is usually suffixed with &quot;v2&quot;, which can support any number of TWAI controllers. These two sets of API can be used at the same time, but it is recommended to use the &quot;v2&quot; version in your new projects.</p>
</div>
</section>
<section id="driver-configuration">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Driver Configuration</a><a class="headerlink" href="#driver-configuration" title="Permalink to this heading"></a></h2>
<p>This section covers how to configure the TWAI driver.</p>
<section id="operating-modes">
<h3>Operating Modes<a class="headerlink" href="#operating-modes" title="Permalink to this heading"></a></h3>
<p>The TWAI driver supports the following modes of operation:</p>
<p><strong>Normal Mode:</strong> The normal operating mode allows the TWAI controller to take part in bus activities such as transmitting and receiving messages/error frames. Acknowledgment from another node is required when transmitting a message.</p>
<p><strong>No Ack Mode:</strong> The No Acknowledgement mode is similar to normal mode, however, acknowledgments are not required for a message transmission to be considered successful. This mode is useful when self-testing the TWAI controller (loopback of transmissions).</p>
<p><strong>Listen Only Mode:</strong> This mode prevents the TWAI controller from influencing the bus. Therefore, the transmission of messages/acknowledgment/error frames will be disabled. However, the TWAI controller is still able to receive messages but will not acknowledge the message. This mode is suited for bus monitor applications.</p>
</section>
<section id="alerts">
<h3>Alerts<a class="headerlink" href="#alerts" title="Permalink to this heading"></a></h3>
<p>The TWAI driver contains an alert feature that is used to notify the application layer of certain TWAI controller or TWAI bus events. Alerts are selectively enabled when the TWAI driver is installed, but can be reconfigured during runtime by calling <a class="reference internal" href="#_CPPv423twai_reconfigure_alerts8uint32_tP8uint32_t" title="twai_reconfigure_alerts"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_reconfigure_alerts()</span></code></a>. The application can then wait for any enabled alerts to occur by calling <a class="reference internal" href="#_CPPv416twai_read_alertsP8uint32_t10TickType_t" title="twai_read_alerts"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_read_alerts()</span></code></a>. The TWAI driver supports the following alerts:</p>
<table class="docutils align-default" id="id8">
<caption><span class="caption-text">TWAI Driver Alerts</span><a class="headerlink" href="#id8" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 40.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Alert Flag</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_TX_IDLE</span></code></p></td>
<td><p>No more messages queued for transmission</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_TX_SUCCESS</span></code></p></td>
<td><p>The previous transmission was successful</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_RX_DATA</span></code></p></td>
<td><p>A frame has been received and added to the RX queue</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_BELOW_ERR_WARN</span></code></p></td>
<td><p>Both error counters have dropped below the error warning limit</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_ERR_ACTIVE</span></code></p></td>
<td><p>TWAI controller has become error-active</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_RECOVERY_IN_PROGRESS</span></code></p></td>
<td><p>TWAI controller is undergoing bus recovery</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_BUS_RECOVERED</span></code></p></td>
<td><p>TWAI controller has successfully completed bus recovery</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_ARB_LOST</span></code></p></td>
<td><p>The previous transmission lost arbitration</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_ABOVE_ERR_WARN</span></code></p></td>
<td><p>One of the error counters has exceeded the error warning limit</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_BUS_ERROR</span></code></p></td>
<td><p>A (Bit, Stuff, CRC, Form, ACK) error has occurred on the bus</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_TX_FAILED</span></code></p></td>
<td><p>The previous transmission has failed</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_RX_QUEUE_FULL</span></code></p></td>
<td><p>The RX queue is full causing a received frame to be lost</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_ERR_PASS</span></code></p></td>
<td><p>TWAI controller has become error-passive</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_BUS_OFF</span></code></p></td>
<td><p>Bus-off condition occurred. TWAI controller can no longer influence the bus</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The TWAI controller's <strong>error warning limit</strong> is used to preemptively warn the application of bus errors before the error passive state is reached. By default, the TWAI driver sets the <strong>error warning limit</strong> to <strong>96</strong>. The <code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_ABOVE_ERR_WARN</span></code> is raised when the TEC or REC becomes larger than or equal to the error warning limit. The <code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_BELOW_ERR_WARN</span></code> is raised when both TEC and REC return to values below <strong>96</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When enabling alerts, the <code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_AND_LOG</span></code> flag can be used to cause the TWAI driver to log any raised alerts to UART. However, alert logging is disabled and <code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_AND_LOG</span></code> if the <a class="reference internal" href="../kconfig.html#config-twai-isr-in-iram"><span class="std std-ref">CONFIG_TWAI_ISR_IN_IRAM</span></a> option is enabled. See <a class="reference internal" href="#placing-isr-into-iram"><span class="std std-ref">Placing ISR into IRAM</span></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_ALL</span></code> and <code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_NONE</span></code> macros can also be used to enable or disable all alerts during configuration or reconfiguration.</p>
</div>
</section>
<section id="bit-timing">
<h3>Bit Timing<a class="headerlink" href="#bit-timing" title="Permalink to this heading"></a></h3>
<p>The operating bit rate of the TWAI driver is configured using the <a class="reference internal" href="#_CPPv420twai_timing_config_t" title="twai_timing_config_t"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">twai_timing_config_t</span></code></a> structure. The period of each bit is made up of multiple <strong>time quanta</strong>, and the period of a <strong>time quantum</strong> is determined by a pre-scaled version of the TWAI controller's source clock. A single bit contains the following segments in the following order:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The <strong>Synchronization Segment</strong> consists of a single time quantum</p></li>
<li><p><strong>Timing Segment 1</strong> consists of 1- to 16-time quanta before the sample point</p></li>
<li><p><strong>Timing Segment 2</strong> consists of 1- to 8-time quanta after the sample point</p></li>
</ol>
</div></blockquote>
<p>The <strong>Baud Rate Prescaler (BRP)</strong> is used to determine the period of each time quantum by dividing the TWAI controller's source clock. On the ESP32, the <code class="docutils literal notranslate"><span class="pre">brp</span></code> can be <strong>any even number from 2 to 128</strong>. Alternatively, you can decide the resolution of each quantum, by setting <a class="reference internal" href="#_CPPv4N20twai_timing_config_t20quanta_resolution_hzE" title="twai_timing_config_t::quanta_resolution_hz"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">twai_timing_config_t::quanta_resolution_hz</span></code></a> to a non-zero value. In this way, the driver can calculate the underlying <code class="docutils literal notranslate"><span class="pre">brp</span></code> value for you. It is useful when you set different clock sources but want the bitrate to keep the same.</p>
<p>The supported clock source for a TWAI controller is listed in the <a class="reference internal" href="#_CPPv419twai_clock_source_t" title="twai_clock_source_t"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">twai_clock_source_t</span></code></a> and can be specified in <a class="reference internal" href="#_CPPv4N20twai_timing_config_t7clk_srcE" title="twai_timing_config_t::clk_src"><code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">twai_timing_config_t::clk_src</span></code></a>.</p>
<p>If the ESP32 is a v2.0 or later chip, the <code class="docutils literal notranslate"><span class="pre">brp</span></code> will <strong>also support any multiple of 4 from 132 to 256</strong>, and can be enabled by setting the <a class="reference internal" href="../kconfig.html#config-esp32-rev-min"><span class="std std-ref">CONFIG_ESP32_REV_MIN</span></a> to v2.0 or higher.</p>
<figure class="align-center" id="id9">
<div><img height="155" src="../../_images/packetdiag-5ca84cb55502933d712cd8fdd0744dd1562143fb.png" width="928" /></div><figcaption>
<p><span class="caption-text">Bit timing configuration for 500kbit/s given BRP = 8, clock source frequency is 80MHz</span><a class="headerlink" href="#id9" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The sample point of a bit is located at the intersection of Timing Segments 1 and 2. Enabling <strong>Triple Sampling</strong> causes 3-time quanta to be sampled per bit instead of 1, and extra samples are located at the tail end of Timing Segment 1.</p>
<p>The <strong>Synchronization Jump Width (SJW)</strong> is used to determine the maximum number of time quanta a single bit time can be lengthened/shortened for synchronization purposes. <code class="docutils literal notranslate"><span class="pre">sjw</span></code> can <strong>range from 1 to 4</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiple combinations of <code class="docutils literal notranslate"><span class="pre">brp</span></code>, <code class="docutils literal notranslate"><span class="pre">tseg_1</span></code>, <code class="docutils literal notranslate"><span class="pre">tseg_2</span></code>, and <code class="docutils literal notranslate"><span class="pre">sjw</span></code> can achieve the same bit rate. Users should tune these values to the physical characteristics of their bus by taking into account factors such as <strong>propagation delay, node information processing time, and phase errors</strong>.</p>
</div>
<p>Bit timing <strong>macro initializers</strong> are also available for commonly used bit rates. The following macro initializers are provided by the TWAI driver.</p>
<p><ul class="simple">
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_1MBITS</span></code></p></li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_800KBITS</span></code></p></li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_500KBITS</span></code></p></li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_250KBITS</span></code></p></li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_125KBITS</span></code></p></li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_100KBITS</span></code></p></li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_50KBITS</span></code></p></li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_25KBITS</span></code></p></li>
</ul>
</p>
<p>v2.0 or later of the ESP32 also supports the following bit rates:</p>
<ul class="simple">
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_20KBITS</span></code></p></li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_16KBITS</span></code></p></li>
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">TWAI_TIMING_CONFIG_12_5KBITS</span></code></p></li>
</ul>
</section>
<section id="acceptance-filter">
<h3>Acceptance Filter<a class="headerlink" href="#acceptance-filter" title="Permalink to this heading"></a></h3>
<p>The TWAI controller contains a hardware acceptance filter which can be used to filter messages of a particular ID. A node that filters out a message <strong>does not receive the message, but will still acknowledge it</strong>. Acceptance filters can make a node more efficient by filtering out messages sent over the bus that are irrelevant to the node. The acceptance filter is configured using two 32-bit values within <a class="reference internal" href="#_CPPv420twai_filter_config_t" title="twai_filter_config_t"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">twai_filter_config_t</span></code></a> known as the <strong>acceptance code</strong> and the <strong>acceptance mask</strong>.</p>
<p>The <strong>acceptance code</strong> specifies the bit sequence in which a message's ID, RTR, and data bytes must match in order for the message to be received by the TWAI controller. The <strong>acceptance mask</strong> is a bit sequence specifying which bits of the acceptance code can be ignored. This allows for messages of different IDs to be accepted by a single acceptance code.</p>
<p>The acceptance filter can be used under <strong>Single or Dual Filter Mode</strong>. Single Filter Mode uses the acceptance code and mask to define a single filter. This allows for the first two data bytes of a standard frame to be filtered or the entirety of an extended frame's 29-bit ID. The following diagram illustrates how the 32-bit acceptance code and mask are interpreted under Single Filter Mode. Note: The yellow and blue fields represent standard and extended frame formats respectively.</p>
<figure class="align-center" id="id10">
<div><img height="190" src="../../_images/packetdiag-2faf16c111612d5584a848b9a91dd7af102d00f2.png" width="1088" /></div><figcaption>
<p><span class="caption-text">Bit layout of single filter mode (Right side MSBit)</span><a class="headerlink" href="#id10" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p><strong>Dual Filter Mode</strong> uses the acceptance code and mask to define two separate filters allowing for increased flexibility of IDs to accept, but does not allow for all 29 bits of an extended ID to be filtered. The following diagram illustrates how the 32-bit acceptance code and mask are interpreted under <strong>Dual Filter Mode</strong>. Note: The yellow and blue fields represent standard and extended frame formats respectively.</p>
<figure class="align-center" id="id11">
<div><img height="190" src="../../_images/packetdiag-a8b59683d479bf08e8ddfcbca3abbf99421bb263.png" width="1088" /></div><figcaption>
<p><span class="caption-text">Bit layout of dual filter mode (Right side MSBit)</span><a class="headerlink" href="#id11" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="disabling-tx-queue">
<h3>Disabling TX Queue<a class="headerlink" href="#disabling-tx-queue" title="Permalink to this heading"></a></h3>
<p>The TX queue can be disabled during configuration by setting the <code class="docutils literal notranslate"><span class="pre">tx_queue_len</span></code> member of <a class="reference internal" href="#_CPPv421twai_general_config_t" title="twai_general_config_t"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">twai_general_config_t</span></code></a> to <code class="docutils literal notranslate"><span class="pre">0</span></code>. This allows applications that do not require message transmission to save a small amount of memory when using the TWAI driver.</p>
</section>
<section id="placing-isr-into-iram">
<span id="id1"></span><h3>Placing ISR into IRAM<a class="headerlink" href="#placing-isr-into-iram" title="Permalink to this heading"></a></h3>
<p>The TWAI driver's ISR (Interrupt Service Routine) can be placed into IRAM so that the ISR can still run whilst the cache is disabled. Placing the ISR into IRAM may be necessary to maintain the TWAI driver's functionality during lengthy cache-disabling operations (such as SPI Flash writes, OTA updates, etc.). Whilst the cache is disabled, the ISR continues to:</p>
<ul class="simple">
<li><p>Read received messages from the RX buffer and place them into the driver's RX queue.</p></li>
<li><p>Load messages pending transmission from the driver's TX queue and write them into the TX buffer.</p></li>
</ul>
<p>To place the TWAI driver's ISR, users must do the following:</p>
<ul class="simple">
<li><p>Enable the <a class="reference internal" href="../kconfig.html#config-twai-isr-in-iram"><span class="std std-ref">CONFIG_TWAI_ISR_IN_IRAM</span></a> option using <code class="docutils literal notranslate"><span class="pre">idf.py</span> <span class="pre">menuconfig</span></code>.</p></li>
<li><p>When calling <a class="reference internal" href="#_CPPv419twai_driver_installPK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_t" title="twai_driver_install"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_driver_install()</span></code></a>, the <code class="docutils literal notranslate"><span class="pre">intr_flags</span></code> member of <a class="reference internal" href="#_CPPv421twai_general_config_t" title="twai_general_config_t"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">twai_general_config_t</span></code></a> should set <code class="xref c c-macro docutils literal notranslate"><span class="pre">ESP_INTR_FLAG_IRAM</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the <a class="reference internal" href="../kconfig.html#config-twai-isr-in-iram"><span class="std std-ref">CONFIG_TWAI_ISR_IN_IRAM</span></a> option is enabled, the TWAI driver will no longer log any alerts, i.e., the <code class="docutils literal notranslate"><span class="pre">TWAI_ALERT_AND_LOG</span></code> flag will not have any effect.</p>
</div>
</section>
<section id="esp32-errata-workarounds">
<h3>ESP32 Errata Workarounds<a class="headerlink" href="#esp32-errata-workarounds" title="Permalink to this heading"></a></h3>
<p>The ESP32's TWAI controller contains multiple hardware errata (more details about the errata can be found in the <a class="reference external" href="https://www.espressif.com/sites/default/files/documentation/eco_and_workarounds_for_bugs_in_esp32_en.pdf">ESP32's ECO document</a>). Some of these errata are critical, and under specific circumstances, can place the TWAI controller into an unrecoverable state (i.e., the controller gets stuck until it is reset by the CPU).</p>
<p>The TWAI driver contains software workarounds for these critical errata. With these workarounds, the ESP32 TWAI driver can operate normally, albeit with degraded performance. The degraded performance will affect users in the following ways depending on what particular errata conditions are encountered:</p>
<ul class="simple">
<li><p>The TWAI driver can occasionally drop some received messages.</p></li>
<li><p>The TWAI driver can be unresponsive for a short period of time, i.e., will not transmit or ACK for 11-bit times or longer.</p></li>
<li><p>If <a class="reference internal" href="../kconfig.html#config-twai-isr-in-iram"><span class="std std-ref">CONFIG_TWAI_ISR_IN_IRAM</span></a> is enabled, the workarounds will increase IRAM usage by approximately 1 KB.</p></li>
</ul>
<p>The software workarounds are enabled by default and it is recommended that users keep these workarounds enabled.</p>
</section>
</section>
<section id="driver-operation">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">Driver Operation</a><a class="headerlink" href="#driver-operation" title="Permalink to this heading"></a></h2>
<p>The TWAI driver is designed with distinct states and strict rules regarding the functions or conditions that trigger a state transition. The following diagram illustrates the various states and their transitions.</p>
<figure class="align-center" id="id12">
<div class="align-default"><img height="280" src="../../_images/blockdiag-b80b7fceff790304baa5aeaa59ff0859b41a93d9.png" width="940" /></div>
<figcaption>
<p><span class="caption-text">State transition diagram of the TWAI driver (see table below)</span><a class="headerlink" href="#id12" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 40.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>Transition</p></th>
<th class="head"><p>Action/Condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A</p></td>
<td><p>Uninstalled -&gt; Stopped</p></td>
<td><p><a class="reference internal" href="#_CPPv419twai_driver_installPK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_t" title="twai_driver_install"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_driver_install()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>B</p></td>
<td><p>Stopped -&gt; Uninstalled</p></td>
<td><p><a class="reference internal" href="#_CPPv421twai_driver_uninstallv" title="twai_driver_uninstall"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_driver_uninstall()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>C</p></td>
<td><p>Stopped -&gt; Running</p></td>
<td><p><a class="reference internal" href="#_CPPv410twai_startv" title="twai_start"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_start()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>D</p></td>
<td><p>Running -&gt; Stopped</p></td>
<td><p><a class="reference internal" href="#_CPPv49twai_stopv" title="twai_stop"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_stop()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>E</p></td>
<td><p>Running -&gt; Bus-Off</p></td>
<td><p>Transmit Error Counter &gt;= 256</p></td>
</tr>
<tr class="row-odd"><td><p>F</p></td>
<td><p>Bus-Off -&gt; Uninstalled</p></td>
<td><p><a class="reference internal" href="#_CPPv421twai_driver_uninstallv" title="twai_driver_uninstall"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_driver_uninstall()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>G</p></td>
<td><p>Bus-Off -&gt; Recovering</p></td>
<td><p><a class="reference internal" href="#_CPPv422twai_initiate_recoveryv" title="twai_initiate_recovery"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_initiate_recovery()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>H</p></td>
<td><p>Recovering -&gt; Stopped</p></td>
<td><p>128 occurrences of 11 consecutive recessive bits</p></td>
</tr>
</tbody>
</table>
<section id="driver-states">
<h3>Driver States<a class="headerlink" href="#driver-states" title="Permalink to this heading"></a></h3>
<p><strong>Uninstalled</strong>: In the uninstalled state, no memory is allocated for the driver, and the TWAI controller is powered OFF.</p>
<p><strong>Stopped</strong>: In this state, the TWAI controller is powered ON and the TWAI driver has been installed. However, the TWAI controller is unable to take part in any bus activities such as transmitting, receiving, or acknowledging messages.</p>
<p><strong>Running</strong>: In the running state, the TWAI controller is able to take part in bus activities. Therefore messages can be transmitted/received/acknowledged. Furthermore, the TWAI controller is able to transmit error frames upon detection of errors on the bus.</p>
<p><strong>Bus-Off</strong>: The bus-off state is automatically entered when the TWAI controller's Transmit Error Counter becomes greater than or equal to 256. The bus-off state indicates the occurrence of severe errors on the bus or in the TWAI controller. Whilst in the bus-off state, the TWAI controller is unable to take part in any bus activities. To exit the bus-off state, the TWAI controller must undergo the bus recovery process.</p>
<p><strong>Recovering</strong>: The recovering state is entered when the TWAI controller undergoes bus recovery. The TWAI controller/TWAI driver remains in the recovering state until 128 occurrences of 11 consecutive recessive bits are observed on the bus.</p>
</section>
<section id="message-fields-and-flags">
<h3>Message Fields and Flags<a class="headerlink" href="#message-fields-and-flags" title="Permalink to this heading"></a></h3>
<p>The TWAI driver distinguishes different types of messages by using the various bit field members of the <a class="reference internal" href="#_CPPv414twai_message_t" title="twai_message_t"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">twai_message_t</span></code></a> structure. These bit field members determine whether a message is in standard or extended format, a remote frame, and the type of transmission to use when transmitting such a message.</p>
<p>These bit field members can also be toggled using the <code class="docutils literal notranslate"><span class="pre">flags</span></code> member of <a class="reference internal" href="#_CPPv414twai_message_t" title="twai_message_t"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">twai_message_t</span></code></a> and the following message flags:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Message Flag</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_MSG_FLAG_EXTD</span></code></p></td>
<td><p>Message is in Extended Frame Format (29bit ID)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_MSG_FLAG_RTR</span></code></p></td>
<td><p>Message is a Remote Frame (Remote Transmission Request)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_MSG_FLAG_SS</span></code></p></td>
<td><p>Transmit message using Single Shot Transmission, i.e., message will not be retransmitted upon error or loss of arbitration (Unused for the received message)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_MSG_FLAG_SELF</span></code></p></td>
<td><p>Transmit message using Self Reception Request, i.e., transmitted message will also received by the same node (Unused for the received message)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_MSG_FLAG_DLC_NON_COMP</span></code></p></td>
<td><p>Message's Data length code is larger than 8, which breaks compliance with TWAI</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TWAI_MSG_FLAG_NONE</span></code></p></td>
<td><p>Clears all bit fields, and the flag is equivalent to a Standard Frame Format (11bit ID) Data Frame</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="examples">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Examples</a><a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<section id="configuration-installation">
<h3>Configuration &amp; Installation<a class="headerlink" href="#configuration-installation" title="Permalink to this heading"></a></h3>
<p>The following code snippet demonstrates how to configure, install, and start the TWAI driver via the use of the various configuration structures, macro initializers, the <a class="reference internal" href="#_CPPv419twai_driver_installPK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_t" title="twai_driver_install"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_driver_install()</span></code></a> function, and the <a class="reference internal" href="#_CPPv410twai_startv" title="twai_start"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_start()</span></code></a> function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;driver/gpio.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;driver/twai.h&quot;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">app_main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Initialize configuration structures using macro initializers</span>
<span class="w">    </span><span class="n">twai_general_config_t</span><span class="w"> </span><span class="n">g_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TWAI_GENERAL_CONFIG_DEFAULT</span><span class="p">(</span><span class="n">GPIO_NUM_21</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_NUM_22</span><span class="p">,</span><span class="w"> </span><span class="n">TWAI_MODE_NORMAL</span><span class="p">);</span>
<span class="w">    </span><span class="n">twai_timing_config_t</span><span class="w"> </span><span class="n">t_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TWAI_TIMING_CONFIG_500KBITS</span><span class="p">();</span>
<span class="w">    </span><span class="n">twai_filter_config_t</span><span class="w"> </span><span class="n">f_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TWAI_FILTER_CONFIG_ACCEPT_ALL</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Install TWAI driver</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_driver_install</span><span class="p">(</span><span class="o">&amp;</span><span class="n">g_config</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">t_config</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">f_config</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Driver installed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to install driver</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Start TWAI driver</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_start</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Driver started</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to start driver</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">...</span>

<span class="p">}</span>
</pre></div>
</div>
<p>The usage of macro initializers is not mandatory and each of the configuration structures can be done manually.</p>
</section>
<section id="install-multiple-twai-instances">
<h3>Install Multiple TWAI Instances<a class="headerlink" href="#install-multiple-twai-instances" title="Permalink to this heading"></a></h3>
<p><strong>Note:</strong> You can create 1 functional TWAI instance(s) because the ESP32 has 1 physical TWAI controller(s).</p>
<p>The following code snippet demonstrates how to install multiple TWAI instances via the use of the <a class="reference internal" href="#_CPPv422twai_driver_install_v2PK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_tP13twai_handle_t" title="twai_driver_install_v2"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_driver_install_v2()</span></code></a> function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;driver/gpio.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;driver/twai.h&quot;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">app_main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">twai_handle_t</span><span class="w"> </span><span class="n">twai_bus_0</span><span class="p">;</span>
<span class="w">    </span><span class="n">twai_handle_t</span><span class="w"> </span><span class="n">twai_bus_1</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// Initialize configuration structures using macro initializers</span>
<span class="w">    </span><span class="n">twai_general_config_t</span><span class="w"> </span><span class="n">g_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TWAI_GENERAL_CONFIG_DEFAULT</span><span class="p">(</span><span class="n">GPIO_NUM_0</span><span class="p">,</span><span class="w"> </span><span class="n">GPIO_NUM_1</span><span class="p">,</span><span class="w"> </span><span class="n">TWAI_MODE_NORMAL</span><span class="p">);</span>
<span class="w">    </span><span class="n">twai_timing_config_t</span><span class="w"> </span><span class="n">t_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TWAI_TIMING_CONFIG_500KBITS</span><span class="p">();</span>
<span class="w">    </span><span class="n">twai_filter_config_t</span><span class="w"> </span><span class="n">f_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TWAI_FILTER_CONFIG_ACCEPT_ALL</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Install driver for TWAI bus 0</span>
<span class="w">    </span><span class="n">g_config</span><span class="p">.</span><span class="n">controller_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_driver_install_v2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">g_config</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">t_config</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">f_config</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">twai_bus_0</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Driver installed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to install driver</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// Start TWAI driver</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_start_v2</span><span class="p">(</span><span class="n">twai_bus_0</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Driver started</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to start driver</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Install driver for TWAI bus 1</span>
<span class="w">    </span><span class="n">g_config</span><span class="p">.</span><span class="n">controller_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">g_config</span><span class="p">.</span><span class="n">tx_io</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GPIO_NUM_2</span><span class="p">;</span>
<span class="w">    </span><span class="n">g_config</span><span class="p">.</span><span class="n">rx_io</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GPIO_NUM_3</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_driver_install_v2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">g_config</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">t_config</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">f_config</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">twai_bus_1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Driver installed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to install driver</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// Start TWAI driver</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_start_v2</span><span class="p">(</span><span class="n">twai_bus_1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Driver started</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to start driver</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Other Driver operations must use version 2 API as well</span>
<span class="w">    </span><span class="p">...</span>

<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="message-transmission">
<h3>Message Transmission<a class="headerlink" href="#message-transmission" title="Permalink to this heading"></a></h3>
<p>The following code snippet demonstrates how to transmit a message via the usage of the <a class="reference internal" href="#_CPPv414twai_message_t" title="twai_message_t"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">twai_message_t</span></code></a> type and <a class="reference internal" href="#_CPPv413twai_transmitPK14twai_message_t10TickType_t" title="twai_transmit"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_transmit()</span></code></a> function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;driver/twai.h&quot;</span>

<span class="p">...</span>

<span class="c1">// Configure message to transmit</span>
<span class="n">twai_message_t</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Message type and format settings</span>
<span class="w">    </span><span class="p">.</span><span class="n">extd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">              </span><span class="c1">// Standard vs extended format</span>
<span class="w">    </span><span class="p">.</span><span class="n">rtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">               </span><span class="c1">// Data vs RTR frame</span>
<span class="w">    </span><span class="p">.</span><span class="n">ss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">                </span><span class="c1">// Whether the message is single shot (i.e., does not repeat on error)</span>
<span class="w">    </span><span class="p">.</span><span class="n">self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">              </span><span class="c1">// Whether the message is a self reception request (loopback)</span>
<span class="w">    </span><span class="p">.</span><span class="n">dlc_non_comp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">      </span><span class="c1">// DLC is less than 8</span>
<span class="w">    </span><span class="c1">// Message ID and payload</span>
<span class="w">    </span><span class="p">.</span><span class="n">identifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xAAAA</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">data_length_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span>
<span class="p">};</span>

<span class="c1">// Queue message for transmission</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_transmit</span><span class="p">(</span><span class="o">&amp;</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">pdMS_TO_TICKS</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Message queued for transmission</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to queue message for transmission</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="message-reception">
<h3>Message Reception<a class="headerlink" href="#message-reception" title="Permalink to this heading"></a></h3>
<p>The following code snippet demonstrates how to receive a message via the usage of the <a class="reference internal" href="#_CPPv414twai_message_t" title="twai_message_t"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">twai_message_t</span></code></a> type and <a class="reference internal" href="#_CPPv412twai_receiveP14twai_message_t10TickType_t" title="twai_receive"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_receive()</span></code></a> function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;driver/twai.h&quot;</span>

<span class="p">...</span>

<span class="c1">// Wait for the message to be received</span>
<span class="n">twai_message_t</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_receive</span><span class="p">(</span><span class="o">&amp;</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">pdMS_TO_TICKS</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Message received</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to receive message</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Process received message</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">extd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Message is in Extended Format</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Message is in Standard Format</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ID is %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="n">identifier</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">rtr</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="n">data_length_code</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Data byte %d = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="reconfiguring-and-reading-alerts">
<h3>Reconfiguring and Reading Alerts<a class="headerlink" href="#reconfiguring-and-reading-alerts" title="Permalink to this heading"></a></h3>
<p>The following code snippet demonstrates how to reconfigure and read TWAI driver alerts via the use of the <a class="reference internal" href="#_CPPv423twai_reconfigure_alerts8uint32_tP8uint32_t" title="twai_reconfigure_alerts"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_reconfigure_alerts()</span></code></a> and <a class="reference internal" href="#_CPPv416twai_read_alertsP8uint32_t10TickType_t" title="twai_read_alerts"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_read_alerts()</span></code></a> functions.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;driver/twai.h&quot;</span>

<span class="p">...</span>

<span class="c1">// Reconfigure alerts to detect Error Passive and Bus-Off error states</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">alerts_to_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TWAI_ALERT_ERR_PASS</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">TWAI_ALERT_BUS_OFF</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_reconfigure_alerts</span><span class="p">(</span><span class="n">alerts_to_enable</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Alerts reconfigured</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to reconfigure alerts&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Block indefinitely until an alert occurs</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">alerts_triggered</span><span class="p">;</span>
<span class="n">twai_read_alerts</span><span class="p">(</span><span class="o">&amp;</span><span class="n">alerts_triggered</span><span class="p">,</span><span class="w"> </span><span class="n">portMAX_DELAY</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="stop-and-uninstall">
<h3>Stop and Uninstall<a class="headerlink" href="#stop-and-uninstall" title="Permalink to this heading"></a></h3>
<p>The following code demonstrates how to stop and uninstall the TWAI driver via the use of the <a class="reference internal" href="#_CPPv49twai_stopv" title="twai_stop"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_stop()</span></code></a> and <a class="reference internal" href="#_CPPv421twai_driver_uninstallv" title="twai_driver_uninstall"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">twai_driver_uninstall()</span></code></a> functions.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;driver/twai.h&quot;</span>

<span class="p">...</span>

<span class="c1">// Stop the TWAI driver</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_stop</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Driver stopped</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to stop driver</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Uninstall the TWAI driver</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">twai_driver_uninstall</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ESP_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Driver uninstalled</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to uninstall driver</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="multiple-id-filter-configuration">
<h3>Multiple ID Filter Configuration<a class="headerlink" href="#multiple-id-filter-configuration" title="Permalink to this heading"></a></h3>
<p>The acceptance mask in <a class="reference internal" href="#_CPPv420twai_filter_config_t" title="twai_filter_config_t"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">twai_filter_config_t</span></code></a> can be configured such that two or more IDs are accepted for a single filter. For a particular filter to accept multiple IDs, the conflicting bit positions amongst the IDs must be set in the acceptance mask. The acceptance code can be set to any one of the IDs.</p>
<p>The following example shows how to calculate the acceptance mask given multiple IDs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ID1</span> <span class="o">=</span>  <span class="mi">11</span><span class="s1">&#39;b101 1010 0000</span>
<span class="n">ID2</span> <span class="o">=</span>  <span class="mi">11</span><span class="s1">&#39;b101 1010 0001</span>
<span class="n">ID3</span> <span class="o">=</span>  <span class="mi">11</span><span class="s1">&#39;b101 1010 0100</span>
<span class="n">ID4</span> <span class="o">=</span>  <span class="mi">11</span><span class="s1">&#39;b101 1010 1000</span>
<span class="o">//</span> <span class="n">Acceptance</span> <span class="n">Mask</span>
<span class="n">MASK</span> <span class="o">=</span> <span class="mi">11</span><span class="s1">&#39;b000 0000 1101</span>
</pre></div>
</div>
</section>
<section id="application-examples">
<h3>Application Examples<a class="headerlink" href="#application-examples" title="Permalink to this heading"></a></h3>
<p><strong>Network Example:</strong> <a class="reference external" href="https://github.com/espressif/esp-idf/tree/v5.4.2/examples/peripherals/twai/twai_network">peripherals/twai/twai_network</a> demonstrates communication between two ESP32s using the TWAI driver API. One TWAI node acts as a network master that initiates and ceases the transfer of data from another node acting as a network slave.</p>
<p><strong>Alert and Recovery Example:</strong> <a class="reference external" href="https://github.com/espressif/esp-idf/tree/v5.4.2/examples/peripherals/twai/twai_alert_and_recovery">peripherals/twai/twai_alert_and_recovery</a> demonstrates how to use the TWAI driver's alert and bus recovery features on ESP32, by initializing the driver, creating tasks for message transmission and alert handling, triggering bit errors to enter the Bus-Off state, and initiating the Bus-Off recovery process.</p>
<p><strong>Self-Test Example:</strong> <a class="reference external" href="https://github.com/espressif/esp-idf/tree/v5.4.2/examples/peripherals/twai/twai_self_test">peripherals/twai/twai_self_test</a> demonstrates how a node can transmit TWAI messages to itself using the TWAI driver's &quot;No Acknowledgement&quot; mode and Self Reception Requests, testing the proper connection of a target to a working external transceiver.</p>
</section>
</section>
<section id="api-reference">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">API Reference</a><a class="headerlink" href="#api-reference" title="Permalink to this heading"></a></h2>
<section id="header-file">
<h3>Header File<a class="headerlink" href="#header-file" title="Permalink to this heading"></a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/blob/v5.4.2/components/hal/include/hal/twai_types.h">components/hal/include/hal/twai_types.h</a></p></li>
<li><p>This header file can be included with:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;hal/twai_types.h&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="structures">
<h3>Structures<a class="headerlink" href="#structures" title="Permalink to this heading"></a></h3>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv414twai_message_t">
<span id="_CPPv314twai_message_t"></span><span id="_CPPv214twai_message_t"></span><span id="twai_message_t"></span><span class="target" id="structtwai__message__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_message_t</span></span></span><a class="headerlink" href="#_CPPv414twai_message_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure to store a TWAI message. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The flags member is deprecated </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14twai_message_t4extdE">
<span id="_CPPv3N14twai_message_t4extdE"></span><span id="_CPPv2N14twai_message_t4extdE"></span><span id="twai_message_t::extd__uint32_t"></span><span class="target" id="structtwai__message__t_1a7e2cf32cfb6f07d078a80a4ad3a61e76"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extd</span></span></span><a class="headerlink" href="#_CPPv4N14twai_message_t4extdE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Extended Frame Format (29bit ID) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14twai_message_t3rtrE">
<span id="_CPPv3N14twai_message_t3rtrE"></span><span id="_CPPv2N14twai_message_t3rtrE"></span><span id="twai_message_t::rtr__uint32_t"></span><span class="target" id="structtwai__message__t_1a58c80818a391424a33c891f6ce370d3f"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rtr</span></span></span><a class="headerlink" href="#_CPPv4N14twai_message_t3rtrE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Message is a Remote Frame </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14twai_message_t2ssE">
<span id="_CPPv3N14twai_message_t2ssE"></span><span id="_CPPv2N14twai_message_t2ssE"></span><span id="twai_message_t::ss__uint32_t"></span><span class="target" id="structtwai__message__t_1a99e189a2f3528fb5d62c684313d6821c"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ss</span></span></span><a class="headerlink" href="#_CPPv4N14twai_message_t2ssE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Transmit as a Single Shot Transmission. Unused for received. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14twai_message_t4selfE">
<span id="_CPPv3N14twai_message_t4selfE"></span><span id="_CPPv2N14twai_message_t4selfE"></span><span id="twai_message_t::self__uint32_t"></span><span class="target" id="structtwai__message__t_1a5905c460a4c83efbe8dd72dd69f1b99a"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">self</span></span></span><a class="headerlink" href="#_CPPv4N14twai_message_t4selfE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Transmit as a Self Reception Request. Unused for received. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14twai_message_t12dlc_non_compE">
<span id="_CPPv3N14twai_message_t12dlc_non_compE"></span><span id="_CPPv2N14twai_message_t12dlc_non_compE"></span><span id="twai_message_t::dlc_non_comp__uint32_t"></span><span class="target" id="structtwai__message__t_1a8954dcb5be53249c5179ddb834514c54"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dlc_non_comp</span></span></span><a class="headerlink" href="#_CPPv4N14twai_message_t12dlc_non_compE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Message's Data length code is larger than 8. This will break compliance with ISO 11898-1 </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14twai_message_t8reservedE">
<span id="_CPPv3N14twai_message_t8reservedE"></span><span id="_CPPv2N14twai_message_t8reservedE"></span><span id="twai_message_t::reserved__uint32_t"></span><span class="target" id="structtwai__message__t_1a495fa736d8e82f02606754fb0280d5d9"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reserved</span></span></span><a class="headerlink" href="#_CPPv4N14twai_message_t8reservedE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Reserved bits </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14twai_message_t5flagsE">
<span id="_CPPv3N14twai_message_t5flagsE"></span><span id="_CPPv2N14twai_message_t5flagsE"></span><span id="twai_message_t::flags__uint32_t"></span><span class="target" id="structtwai__message__t_1aa30bd8b870dc21deebdbb5f03994f1b5"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flags</span></span></span><a class="headerlink" href="#_CPPv4N14twai_message_t5flagsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Deprecated: Alternate way to set bits using message flags </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14twai_message_t10identifierE">
<span id="_CPPv3N14twai_message_t10identifierE"></span><span id="_CPPv2N14twai_message_t10identifierE"></span><span id="twai_message_t::identifier__uint32_t"></span><span class="target" id="structtwai__message__t_1a763861c683e24bda3b27c34d7fb21d7f"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">identifier</span></span></span><a class="headerlink" href="#_CPPv4N14twai_message_t10identifierE" title="Permalink to this definition"></a><br /></dt>
<dd><p>11 or 29 bit identifier </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14twai_message_t16data_length_codeE">
<span id="_CPPv3N14twai_message_t16data_length_codeE"></span><span id="_CPPv2N14twai_message_t16data_length_codeE"></span><span id="twai_message_t::data_length_code__uint8_t"></span><span class="target" id="structtwai__message__t_1a59be7a73d9ff1db54a3d436b5cc6c496"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">data_length_code</span></span></span><a class="headerlink" href="#_CPPv4N14twai_message_t16data_length_codeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Data length code </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N14twai_message_t4dataE">
<span id="_CPPv3N14twai_message_t4dataE"></span><span id="_CPPv2N14twai_message_t4dataE"></span><span id="twai_message_t::data__uint8_tA"></span><span class="target" id="structtwai__message__t_1ab7f551f34e1b42d7da7e0301c85bcbcb"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">data</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">TWAI_FRAME_MAX_DLC</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N14twai_message_t4dataE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Data bytes (not relevant in RTR frame) </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv420twai_timing_config_t">
<span id="_CPPv320twai_timing_config_t"></span><span id="_CPPv220twai_timing_config_t"></span><span id="twai_timing_config_t"></span><span class="target" id="structtwai__timing__config__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_timing_config_t</span></span></span><a class="headerlink" href="#_CPPv420twai_timing_config_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure for bit timing configuration of the TWAI driver. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Macro initializers are available for this structure </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20twai_timing_config_t7clk_srcE">
<span id="_CPPv3N20twai_timing_config_t7clk_srcE"></span><span id="_CPPv2N20twai_timing_config_t7clk_srcE"></span><span id="twai_timing_config_t::clk_src__twai_clock_source_t"></span><span class="target" id="structtwai__timing__config__t_1a14a1a87f9bb233a328e1d376f1483ddc"></span><a class="reference internal" href="#_CPPv419twai_clock_source_t" title="twai_clock_source_t"><span class="n"><span class="pre">twai_clock_source_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">clk_src</span></span></span><a class="headerlink" href="#_CPPv4N20twai_timing_config_t7clk_srcE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Clock source, set to 0 or TWAI_CLK_SRC_DEFAULT if you want a default clock source </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20twai_timing_config_t20quanta_resolution_hzE">
<span id="_CPPv3N20twai_timing_config_t20quanta_resolution_hzE"></span><span id="_CPPv2N20twai_timing_config_t20quanta_resolution_hzE"></span><span id="twai_timing_config_t::quanta_resolution_hz__uint32_t"></span><span class="target" id="structtwai__timing__config__t_1a54254ca0c914649069bb0b77e56aa085"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quanta_resolution_hz</span></span></span><a class="headerlink" href="#_CPPv4N20twai_timing_config_t20quanta_resolution_hzE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The resolution of one timing quanta, in Hz. Note: the value of <code class="docutils literal notranslate"><span class="pre">brp</span></code> will reflected by this field if it's non-zero, otherwise, <code class="docutils literal notranslate"><span class="pre">brp</span></code> needs to be set manually </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20twai_timing_config_t3brpE">
<span id="_CPPv3N20twai_timing_config_t3brpE"></span><span id="_CPPv2N20twai_timing_config_t3brpE"></span><span id="twai_timing_config_t::brp__uint32_t"></span><span class="target" id="structtwai__timing__config__t_1a969f1dbe0d68316f83325fefa0b3831c"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">brp</span></span></span><a class="headerlink" href="#_CPPv4N20twai_timing_config_t3brpE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Baudrate prescale (i.e., clock divider). Any even number from 2 to 128 for ESP32, 2 to 32768 for non-ESP32 chip. Note: For ESP32 ECO 2 or later, multiples of 4 from 132 to 256 are also supported </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20twai_timing_config_t6tseg_1E">
<span id="_CPPv3N20twai_timing_config_t6tseg_1E"></span><span id="_CPPv2N20twai_timing_config_t6tseg_1E"></span><span id="twai_timing_config_t::tseg_1__uint8_t"></span><span class="target" id="structtwai__timing__config__t_1ab73bb29cb598da219b274133c5b73ab9"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tseg_1</span></span></span><a class="headerlink" href="#_CPPv4N20twai_timing_config_t6tseg_1E" title="Permalink to this definition"></a><br /></dt>
<dd><p>Timing segment 1 (Number of time quanta, between 1 to 16) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20twai_timing_config_t6tseg_2E">
<span id="_CPPv3N20twai_timing_config_t6tseg_2E"></span><span id="_CPPv2N20twai_timing_config_t6tseg_2E"></span><span id="twai_timing_config_t::tseg_2__uint8_t"></span><span class="target" id="structtwai__timing__config__t_1a45047c38e3d03a65847047afab79a3ae"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tseg_2</span></span></span><a class="headerlink" href="#_CPPv4N20twai_timing_config_t6tseg_2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>Timing segment 2 (Number of time quanta, 1 to 8) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20twai_timing_config_t3sjwE">
<span id="_CPPv3N20twai_timing_config_t3sjwE"></span><span id="_CPPv2N20twai_timing_config_t3sjwE"></span><span id="twai_timing_config_t::sjw__uint8_t"></span><span class="target" id="structtwai__timing__config__t_1a4816ea53d70f7030a11219b0cb8befbb"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sjw</span></span></span><a class="headerlink" href="#_CPPv4N20twai_timing_config_t3sjwE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Synchronization Jump Width (Max time quanta jump for synchronize from 1 to 4) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20twai_timing_config_t15triple_samplingE">
<span id="_CPPv3N20twai_timing_config_t15triple_samplingE"></span><span id="_CPPv2N20twai_timing_config_t15triple_samplingE"></span><span id="twai_timing_config_t::triple_sampling__b"></span><span class="target" id="structtwai__timing__config__t_1ad75205adb4bdcfe278caf042dcd9b2ed"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">triple_sampling</span></span></span><a class="headerlink" href="#_CPPv4N20twai_timing_config_t15triple_samplingE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Enables triple sampling when the TWAI controller samples a bit </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv420twai_filter_config_t">
<span id="_CPPv320twai_filter_config_t"></span><span id="_CPPv220twai_filter_config_t"></span><span id="twai_filter_config_t"></span><span class="target" id="structtwai__filter__config__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_filter_config_t</span></span></span><a class="headerlink" href="#_CPPv420twai_filter_config_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure for acceptance filter configuration of the TWAI driver (see documentation) </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Macro initializers are available for this structure </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20twai_filter_config_t15acceptance_codeE">
<span id="_CPPv3N20twai_filter_config_t15acceptance_codeE"></span><span id="_CPPv2N20twai_filter_config_t15acceptance_codeE"></span><span id="twai_filter_config_t::acceptance_code__uint32_t"></span><span class="target" id="structtwai__filter__config__t_1a8f6ab32c98eb0b3be2614cc927058b65"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">acceptance_code</span></span></span><a class="headerlink" href="#_CPPv4N20twai_filter_config_t15acceptance_codeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>32-bit acceptance code </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20twai_filter_config_t15acceptance_maskE">
<span id="_CPPv3N20twai_filter_config_t15acceptance_maskE"></span><span id="_CPPv2N20twai_filter_config_t15acceptance_maskE"></span><span id="twai_filter_config_t::acceptance_mask__uint32_t"></span><span class="target" id="structtwai__filter__config__t_1afa58737c48c8cbddf0a5aa775581ebe4"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">acceptance_mask</span></span></span><a class="headerlink" href="#_CPPv4N20twai_filter_config_t15acceptance_maskE" title="Permalink to this definition"></a><br /></dt>
<dd><p>32-bit acceptance mask </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20twai_filter_config_t13single_filterE">
<span id="_CPPv3N20twai_filter_config_t13single_filterE"></span><span id="_CPPv2N20twai_filter_config_t13single_filterE"></span><span id="twai_filter_config_t::single_filter__b"></span><span class="target" id="structtwai__filter__config__t_1a1906506014412da8920bcefa57af8bbc"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">single_filter</span></span></span><a class="headerlink" href="#_CPPv4N20twai_filter_config_t13single_filterE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Use Single Filter Mode (see documentation) </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="macros">
<h3>Macros<a class="headerlink" href="#macros" title="Permalink to this heading"></a></h3>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.TWAI_EXTD_ID_MASK">
<span class="target" id="twai__types_8h_1ad79fad293ff8f34931e79adec2d98dd6"></span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_EXTD_ID_MASK</span></span></span><a class="headerlink" href="#c.TWAI_EXTD_ID_MASK" title="Permalink to this definition"></a><br /></dt>
<dd><p>TWAI Constants. </p>
<p>Bit mask for 29 bit Extended Frame Format ID </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.TWAI_STD_ID_MASK">
<span class="target" id="twai__types_8h_1aeeef00ad1186051a9ffaf47d720cea22"></span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_STD_ID_MASK</span></span></span><a class="headerlink" href="#c.TWAI_STD_ID_MASK" title="Permalink to this definition"></a><br /></dt>
<dd><p>Bit mask for 11 bit Standard Frame Format ID </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.TWAI_FRAME_MAX_DLC">
<span class="target" id="twai__types_8h_1a93083e2d6dd282430f463ddf3a80dca9"></span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_FRAME_MAX_DLC</span></span></span><a class="headerlink" href="#c.TWAI_FRAME_MAX_DLC" title="Permalink to this definition"></a><br /></dt>
<dd><p>Max data bytes allowed in TWAI </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.TWAI_FRAME_EXTD_ID_LEN_BYTES">
<span class="target" id="twai__types_8h_1a899c21660d02318d528f77251a5539df"></span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_FRAME_EXTD_ID_LEN_BYTES</span></span></span><a class="headerlink" href="#c.TWAI_FRAME_EXTD_ID_LEN_BYTES" title="Permalink to this definition"></a><br /></dt>
<dd><p>EFF ID requires 4 bytes (29bit) </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.TWAI_FRAME_STD_ID_LEN_BYTES">
<span class="target" id="twai__types_8h_1a35f196649011f2ce0a80ff0010609e91"></span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_FRAME_STD_ID_LEN_BYTES</span></span></span><a class="headerlink" href="#c.TWAI_FRAME_STD_ID_LEN_BYTES" title="Permalink to this definition"></a><br /></dt>
<dd><p>SFF ID requires 2 bytes (11bit) </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.TWAI_ERR_PASS_THRESH">
<span class="target" id="twai__types_8h_1a138973476d6af0ad640a8254260245a2"></span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_ERR_PASS_THRESH</span></span></span><a class="headerlink" href="#c.TWAI_ERR_PASS_THRESH" title="Permalink to this definition"></a><br /></dt>
<dd><p>Error counter threshold for error passive </p>
</dd></dl>

</section>
<section id="type-definitions">
<h3>Type Definitions<a class="headerlink" href="#type-definitions" title="Permalink to this heading"></a></h3>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv419twai_clock_source_t">
<span id="_CPPv319twai_clock_source_t"></span><span id="_CPPv219twai_clock_source_t"></span><span id="twai_clock_source_t"></span><span class="target" id="twai__types_8h_1a5b6d5db86e261ae648947a2235c9c699"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><a class="reference internal" href="clk_tree.html#_CPPv425soc_periph_twai_clk_src_t" title="soc_periph_twai_clk_src_t"><span class="n"><span class="pre">soc_periph_twai_clk_src_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_clock_source_t</span></span></span><a class="headerlink" href="#_CPPv419twai_clock_source_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>RMT group clock source. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>User should select the clock source based on the power and resolution requirement </p>
</div>
</dd></dl>

</section>
<section id="enumerations">
<h3>Enumerations<a class="headerlink" href="#enumerations" title="Permalink to this heading"></a></h3>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv411twai_mode_t">
<span id="_CPPv311twai_mode_t"></span><span id="_CPPv211twai_mode_t"></span><span class="target" id="twai__types_8h_1a46d0a9eb9c411f7014c08daf7239e770"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_mode_t</span></span></span><a class="headerlink" href="#_CPPv411twai_mode_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>TWAI Controller operating modes. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11twai_mode_t16TWAI_MODE_NORMALE">
<span id="_CPPv3N11twai_mode_t16TWAI_MODE_NORMALE"></span><span id="_CPPv2N11twai_mode_t16TWAI_MODE_NORMALE"></span><span class="target" id="twai__types_8h_1a46d0a9eb9c411f7014c08daf7239e770ae0f8df94306858fde685bcfdddf402f7"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_MODE_NORMAL</span></span></span><a class="headerlink" href="#_CPPv4N11twai_mode_t16TWAI_MODE_NORMALE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Normal operating mode where TWAI controller can send/receive/acknowledge messages </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11twai_mode_t16TWAI_MODE_NO_ACKE">
<span id="_CPPv3N11twai_mode_t16TWAI_MODE_NO_ACKE"></span><span id="_CPPv2N11twai_mode_t16TWAI_MODE_NO_ACKE"></span><span class="target" id="twai__types_8h_1a46d0a9eb9c411f7014c08daf7239e770a3a636625461fe905ff21f93b17d8ed3a"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_MODE_NO_ACK</span></span></span><a class="headerlink" href="#_CPPv4N11twai_mode_t16TWAI_MODE_NO_ACKE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Transmission does not require acknowledgment. Use this mode for self testing </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11twai_mode_t21TWAI_MODE_LISTEN_ONLYE">
<span id="_CPPv3N11twai_mode_t21TWAI_MODE_LISTEN_ONLYE"></span><span id="_CPPv2N11twai_mode_t21TWAI_MODE_LISTEN_ONLYE"></span><span class="target" id="twai__types_8h_1a46d0a9eb9c411f7014c08daf7239e770a953e0ebe35df9817cea44a73434b1f2c"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_MODE_LISTEN_ONLY</span></span></span><a class="headerlink" href="#_CPPv4N11twai_mode_t21TWAI_MODE_LISTEN_ONLYE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The TWAI controller will not influence the bus (No transmissions or acknowledgments) but can receive messages </p>
</dd></dl>

</dd></dl>

</section>
<section id="id2">
<h3>Header File<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/blob/v5.4.2/components/driver/twai/include/driver/twai.h">components/driver/twai/include/driver/twai.h</a></p></li>
<li><p>This header file can be included with:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;driver/twai.h&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>This header file is a part of the API provided by the <code class="docutils literal notranslate"><span class="pre">driver</span></code> component. To declare that your component depends on <code class="docutils literal notranslate"><span class="pre">driver</span></code>, add the following to your CMakeLists.txt:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>REQUIRES driver
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>PRIV_REQUIRES driver
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h3>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419twai_driver_installPK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_t">
<span id="_CPPv319twai_driver_installPK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_t"></span><span id="_CPPv219twai_driver_installPK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_t"></span><span id="twai_driver_install__twai_general_config_tCP.twai_timing_config_tCP.twai_filter_config_tCP"></span><span class="target" id="twai_8h_1ae9576066eb5ab9cdb00e632f6c50d5b6"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_driver_install</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv421twai_general_config_t" title="twai_general_config_t"><span class="n"><span class="pre">twai_general_config_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">g_config</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420twai_timing_config_t" title="twai_timing_config_t"><span class="n"><span class="pre">twai_timing_config_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">t_config</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420twai_filter_config_t" title="twai_filter_config_t"><span class="n"><span class="pre">twai_filter_config_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">f_config</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419twai_driver_installPK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Install TWAI driver. </p>
<p>This function installs the TWAI driver using three configuration structures. The required memory is allocated and the TWAI driver is placed in the stopped state after running this function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Macro initializers are available for the configuration structures (see documentation)</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To reinstall the TWAI driver, call twai_driver_uninstall() first</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g_config</strong> -- <strong>[in]</strong> General configuration structure </p></li>
<li><p><strong>t_config</strong> -- <strong>[in]</strong> Timing configuration structure </p></li>
<li><p><strong>f_config</strong> -- <strong>[in]</strong> Filter configuration structure</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Successfully installed TWAI driver</p></li>
<li><p>ESP_ERR_INVALID_ARG: Arguments are invalid, e.g. invalid clock source, invalid quanta resolution</p></li>
<li><p>ESP_ERR_NO_MEM: Insufficient memory</p></li>
<li><p>ESP_ERR_INVALID_STATE: Driver is already installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422twai_driver_install_v2PK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_tP13twai_handle_t">
<span id="_CPPv322twai_driver_install_v2PK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_tP13twai_handle_t"></span><span id="_CPPv222twai_driver_install_v2PK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_tP13twai_handle_t"></span><span id="twai_driver_install_v2__twai_general_config_tCP.twai_timing_config_tCP.twai_filter_config_tCP.twai_handle_tP"></span><span class="target" id="twai_8h_1ae581187a294deaa34fa3ddc1e47754d5"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_driver_install_v2</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv421twai_general_config_t" title="twai_general_config_t"><span class="n"><span class="pre">twai_general_config_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">g_config</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420twai_timing_config_t" title="twai_timing_config_t"><span class="n"><span class="pre">twai_timing_config_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">t_config</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420twai_filter_config_t" title="twai_filter_config_t"><span class="n"><span class="pre">twai_filter_config_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">f_config</span></span>, <a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ret_twai</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422twai_driver_install_v2PK21twai_general_config_tPK20twai_timing_config_tPK20twai_filter_config_tP13twai_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Install TWAI driver and return a handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_driver_install</span></code> that can return a driver handle, so that it allows you to install multiple TWAI drivers. Don't forget to set the proper controller_id in the <code class="docutils literal notranslate"><a class="reference internal" href="#structtwai__general__config__t"><span class="std std-ref"><span class="pre">twai_general_config_t</span></span></a></code> Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_driver_install</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g_config</strong> -- <strong>[in]</strong> General configuration structure </p></li>
<li><p><strong>t_config</strong> -- <strong>[in]</strong> Timing configuration structure </p></li>
<li><p><strong>f_config</strong> -- <strong>[in]</strong> Filter configuration structure </p></li>
<li><p><strong>ret_twai</strong> -- <strong>[out]</strong> Pointer to a new created TWAI handle</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Successfully installed TWAI driver</p></li>
<li><p>ESP_ERR_INVALID_ARG: Arguments are invalid, e.g. invalid clock source, invalid quanta resolution, invalid controller ID</p></li>
<li><p>ESP_ERR_NO_MEM: Insufficient memory</p></li>
<li><p>ESP_ERR_INVALID_STATE: Driver is already installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421twai_driver_uninstallv">
<span id="_CPPv321twai_driver_uninstallv"></span><span id="_CPPv221twai_driver_uninstallv"></span><span id="twai_driver_uninstall__void"></span><span class="target" id="twai_8h_1a34278809bafb345dbfda3a6790e0265c"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_driver_uninstall</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421twai_driver_uninstallv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Uninstall the TWAI driver. </p>
<p>This function uninstalls the TWAI driver, freeing the memory utilized by the driver. This function can only be called when the driver is in the stopped state or the bus-off state.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The application must ensure that no tasks are blocked on TX/RX queues or alerts when this function is called.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>ESP_OK: Successfully uninstalled TWAI driver</p></li>
<li><p>ESP_ERR_INVALID_STATE: Driver is not in stopped/bus-off state, or is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424twai_driver_uninstall_v213twai_handle_t">
<span id="_CPPv324twai_driver_uninstall_v213twai_handle_t"></span><span id="_CPPv224twai_driver_uninstall_v213twai_handle_t"></span><span id="twai_driver_uninstall_v2__twai_handle_t"></span><span class="target" id="twai_8h_1aa779689775cf33ba44269767276a8209"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_driver_uninstall_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424twai_driver_uninstall_v213twai_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Uninstall the TWAI driver with a given handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_driver_uninstall</span></code> that can uninstall a TWAI driver with a given handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_driver_uninstall</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Successfully uninstalled TWAI driver</p></li>
<li><p>ESP_ERR_INVALID_STATE: Driver is not in stopped/bus-off state, or is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410twai_startv">
<span id="_CPPv310twai_startv"></span><span id="_CPPv210twai_startv"></span><span id="twai_start__void"></span><span class="target" id="twai_8h_1ad674db89a72cb569d849ef4f5ab71e72"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_start</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410twai_startv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start the TWAI driver. </p>
<p>This function starts the TWAI driver, putting the TWAI driver into the running state. This allows the TWAI driver to participate in TWAI bus activities such as transmitting/receiving messages. The TX and RX queue are reset in this function, clearing any messages that are unread or pending transmission. This function can only be called when the TWAI driver is in the stopped state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>ESP_OK: TWAI driver is now running</p></li>
<li><p>ESP_ERR_INVALID_STATE: Driver is not in stopped state, or is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413twai_start_v213twai_handle_t">
<span id="_CPPv313twai_start_v213twai_handle_t"></span><span id="_CPPv213twai_start_v213twai_handle_t"></span><span id="twai_start_v2__twai_handle_t"></span><span class="target" id="twai_8h_1af532dff462f0f3e4fe3309ab2fb8dd73"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_start_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413twai_start_v213twai_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start the TWAI driver with a given handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_start</span></code> that can start a TWAI driver with a given handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_start</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: TWAI driver is now running</p></li>
<li><p>ESP_ERR_INVALID_STATE: Driver is not in stopped state, or is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv49twai_stopv">
<span id="_CPPv39twai_stopv"></span><span id="_CPPv29twai_stopv"></span><span id="twai_stop__void"></span><span class="target" id="twai_8h_1aa9c4b34377d4d645f5468333cf5af775"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_stop</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv49twai_stopv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Stop the TWAI driver. </p>
<p>This function stops the TWAI driver, preventing any further message from being transmitted or received until twai_start() is called. Any messages in the TX queue are cleared. Any messages in the RX queue should be read by the application after this function is called. This function can only be called when the TWAI driver is in the running state.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A message currently being transmitted/received on the TWAI bus will be ceased immediately. This may lead to other TWAI nodes interpreting the unfinished message as an error.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>ESP_OK: TWAI driver is now Stopped</p></li>
<li><p>ESP_ERR_INVALID_STATE: Driver is not in running state, or is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412twai_stop_v213twai_handle_t">
<span id="_CPPv312twai_stop_v213twai_handle_t"></span><span id="_CPPv212twai_stop_v213twai_handle_t"></span><span id="twai_stop_v2__twai_handle_t"></span><span class="target" id="twai_8h_1a6b3b7f1675954c0d59d4c557ae785313"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_stop_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412twai_stop_v213twai_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Stop the TWAI driver with a given handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_stop</span></code> that can stop a TWAI driver with a given handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_stop</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: TWAI driver is now Stopped</p></li>
<li><p>ESP_ERR_INVALID_STATE: Driver is not in running state, or is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413twai_transmitPK14twai_message_t10TickType_t">
<span id="_CPPv313twai_transmitPK14twai_message_t10TickType_t"></span><span id="_CPPv213twai_transmitPK14twai_message_t10TickType_t"></span><span id="twai_transmit__twai_message_tCP.TickType_t"></span><span class="target" id="twai_8h_1a4f123d75f61565c45ee91898656e3c4a"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_transmit</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414twai_message_t" title="twai_message_t"><span class="n"><span class="pre">twai_message_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">message</span></span>, <span class="n"><span class="pre">TickType_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ticks_to_wait</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413twai_transmitPK14twai_message_t10TickType_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Transmit a TWAI message. </p>
<p>This function queues a TWAI message for transmission. Transmission will start immediately if no other messages are queued for transmission. If the TX queue is full, this function will block until more space becomes available or until it times out. If the TX queue is disabled (TX queue length = 0 in configuration), this function will return immediately if another message is undergoing transmission. This function can only be called when the TWAI driver is in the running state and cannot be called under Listen Only Mode.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function does not guarantee that the transmission is successful. The TX_SUCCESS/TX_FAILED alert can be enabled to alert the application upon the success/failure of a transmission.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The TX_IDLE alert can be used to alert the application when no other messages are awaiting transmission.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> -- <strong>[in]</strong> Message to transmit </p></li>
<li><p><strong>ticks_to_wait</strong> -- <strong>[in]</strong> Number of FreeRTOS ticks to block on the TX queue</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Transmission successfully queued/initiated</p></li>
<li><p>ESP_ERR_INVALID_ARG: Arguments are invalid</p></li>
<li><p>ESP_ERR_TIMEOUT: Timed out waiting for space on TX queue</p></li>
<li><p>ESP_FAIL: TX queue is disabled and another message is currently transmitting</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not in running state, or is not installed</p></li>
<li><p>ESP_ERR_NOT_SUPPORTED: Listen Only Mode does not support transmissions </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416twai_transmit_v213twai_handle_tPK14twai_message_t10TickType_t">
<span id="_CPPv316twai_transmit_v213twai_handle_tPK14twai_message_t10TickType_t"></span><span id="_CPPv216twai_transmit_v213twai_handle_tPK14twai_message_t10TickType_t"></span><span id="twai_transmit_v2__twai_handle_t.twai_message_tCP.TickType_t"></span><span class="target" id="twai_8h_1a8f7848f4ced94ac101eba57523a9c8e3"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_transmit_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv414twai_message_t" title="twai_message_t"><span class="n"><span class="pre">twai_message_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">message</span></span>, <span class="n"><span class="pre">TickType_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ticks_to_wait</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416twai_transmit_v213twai_handle_tPK14twai_message_t10TickType_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Transmit a TWAI message via a given handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_transmit</span></code> that can transmit a TWAI message with a given handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_transmit</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p></li>
<li><p><strong>message</strong> -- <strong>[in]</strong> Message to transmit </p></li>
<li><p><strong>ticks_to_wait</strong> -- <strong>[in]</strong> Number of FreeRTOS ticks to block on the TX queue</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Transmission successfully queued/initiated</p></li>
<li><p>ESP_ERR_INVALID_ARG: Arguments are invalid</p></li>
<li><p>ESP_ERR_TIMEOUT: Timed out waiting for space on TX queue</p></li>
<li><p>ESP_FAIL: TX queue is disabled and another message is currently transmitting</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not in running state, or is not installed</p></li>
<li><p>ESP_ERR_NOT_SUPPORTED: Listen Only Mode does not support transmissions </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412twai_receiveP14twai_message_t10TickType_t">
<span id="_CPPv312twai_receiveP14twai_message_t10TickType_t"></span><span id="_CPPv212twai_receiveP14twai_message_t10TickType_t"></span><span id="twai_receive__twai_message_tP.TickType_t"></span><span class="target" id="twai_8h_1afea8f939474f8daaa8a8bcad4fa3aee6"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_receive</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv414twai_message_t" title="twai_message_t"><span class="n"><span class="pre">twai_message_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">message</span></span>, <span class="n"><span class="pre">TickType_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ticks_to_wait</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412twai_receiveP14twai_message_t10TickType_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Receive a TWAI message. </p>
<p>This function receives a message from the RX queue. The flags field of the message structure will indicate the type of message received. This function will block if there are no messages in the RX queue</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The flags field of the received message should be checked to determine if the received message contains any data bytes.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> -- <strong>[out]</strong> Received message </p></li>
<li><p><strong>ticks_to_wait</strong> -- <strong>[in]</strong> Number of FreeRTOS ticks to block on RX queue</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Message successfully received from RX queue</p></li>
<li><p>ESP_ERR_TIMEOUT: Timed out waiting for message</p></li>
<li><p>ESP_ERR_INVALID_ARG: Arguments are invalid</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415twai_receive_v213twai_handle_tP14twai_message_t10TickType_t">
<span id="_CPPv315twai_receive_v213twai_handle_tP14twai_message_t10TickType_t"></span><span id="_CPPv215twai_receive_v213twai_handle_tP14twai_message_t10TickType_t"></span><span id="twai_receive_v2__twai_handle_t.twai_message_tP.TickType_t"></span><span class="target" id="twai_8h_1a29bc7835927d44532af4ade211f32aa3"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_receive_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv414twai_message_t" title="twai_message_t"><span class="n"><span class="pre">twai_message_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">message</span></span>, <span class="n"><span class="pre">TickType_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ticks_to_wait</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415twai_receive_v213twai_handle_tP14twai_message_t10TickType_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Receive a TWAI message via a given handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_receive</span></code> that can receive a TWAI message with a given handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_receive</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p></li>
<li><p><strong>message</strong> -- <strong>[out]</strong> Received message </p></li>
<li><p><strong>ticks_to_wait</strong> -- <strong>[in]</strong> Number of FreeRTOS ticks to block on RX queue</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Message successfully received from RX queue</p></li>
<li><p>ESP_ERR_TIMEOUT: Timed out waiting for message</p></li>
<li><p>ESP_ERR_INVALID_ARG: Arguments are invalid</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416twai_read_alertsP8uint32_t10TickType_t">
<span id="_CPPv316twai_read_alertsP8uint32_t10TickType_t"></span><span id="_CPPv216twai_read_alertsP8uint32_t10TickType_t"></span><span id="twai_read_alerts__uint32_tP.TickType_t"></span><span class="target" id="twai_8h_1aef2f6cb0c8a4efbee23c43e76a5b825b"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_read_alerts</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">alerts</span></span>, <span class="n"><span class="pre">TickType_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ticks_to_wait</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416twai_read_alertsP8uint32_t10TickType_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read TWAI driver alerts. </p>
<p>This function will read the alerts raised by the TWAI driver. If no alert has been issued when this function is called, this function will block until an alert occurs or until it timeouts.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiple alerts can be raised simultaneously. The application should check for all alerts that have been enabled.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alerts</strong> -- <strong>[out]</strong> Bit field of raised alerts (see documentation for alert flags) </p></li>
<li><p><strong>ticks_to_wait</strong> -- <strong>[in]</strong> Number of FreeRTOS ticks to block for alert</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Alerts read</p></li>
<li><p>ESP_ERR_TIMEOUT: Timed out waiting for alerts</p></li>
<li><p>ESP_ERR_INVALID_ARG: Arguments are invalid</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419twai_read_alerts_v213twai_handle_tP8uint32_t10TickType_t">
<span id="_CPPv319twai_read_alerts_v213twai_handle_tP8uint32_t10TickType_t"></span><span id="_CPPv219twai_read_alerts_v213twai_handle_tP8uint32_t10TickType_t"></span><span id="twai_read_alerts_v2__twai_handle_t.uint32_tP.TickType_t"></span><span class="target" id="twai_8h_1a643eea03eda26370588c54546b1dc8ee"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_read_alerts_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">alerts</span></span>, <span class="n"><span class="pre">TickType_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ticks_to_wait</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419twai_read_alerts_v213twai_handle_tP8uint32_t10TickType_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read TWAI driver alerts with a given handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_read_alerts</span></code> that can read TWAI driver alerts with a given handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_read_alerts</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p></li>
<li><p><strong>alerts</strong> -- <strong>[out]</strong> Bit field of raised alerts (see documentation for alert flags) </p></li>
<li><p><strong>ticks_to_wait</strong> -- <strong>[in]</strong> Number of FreeRTOS ticks to block for alert</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Alerts read</p></li>
<li><p>ESP_ERR_TIMEOUT: Timed out waiting for alerts</p></li>
<li><p>ESP_ERR_INVALID_ARG: Arguments are invalid</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423twai_reconfigure_alerts8uint32_tP8uint32_t">
<span id="_CPPv323twai_reconfigure_alerts8uint32_tP8uint32_t"></span><span id="_CPPv223twai_reconfigure_alerts8uint32_tP8uint32_t"></span><span id="twai_reconfigure_alerts__uint32_t.uint32_tP"></span><span class="target" id="twai_8h_1a007382583fcf3c1c6ec9426d01a2bc81"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_reconfigure_alerts</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">alerts_enabled</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">current_alerts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423twai_reconfigure_alerts8uint32_tP8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Reconfigure which alerts are enabled. </p>
<p>This function reconfigures which alerts are enabled. If there are alerts which have not been read whilst reconfiguring, this function can read those alerts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alerts_enabled</strong> -- <strong>[in]</strong> Bit field of alerts to enable (see documentation for alert flags) </p></li>
<li><p><strong>current_alerts</strong> -- <strong>[out]</strong> Bit field of currently raised alerts. Set to NULL if unused</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Alerts reconfigured</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv426twai_reconfigure_alerts_v213twai_handle_t8uint32_tP8uint32_t">
<span id="_CPPv326twai_reconfigure_alerts_v213twai_handle_t8uint32_tP8uint32_t"></span><span id="_CPPv226twai_reconfigure_alerts_v213twai_handle_t8uint32_tP8uint32_t"></span><span id="twai_reconfigure_alerts_v2__twai_handle_t.uint32_t.uint32_tP"></span><span class="target" id="twai_8h_1a6be77fc49dde430d3cc8745cb37684d9"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_reconfigure_alerts_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">alerts_enabled</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">current_alerts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv426twai_reconfigure_alerts_v213twai_handle_t8uint32_tP8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Reconfigure which alerts are enabled, with a given handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_reconfigure_alerts</span></code> that can reconfigure which alerts are enabled with a given handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_reconfigure_alerts</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p></li>
<li><p><strong>alerts_enabled</strong> -- <strong>[in]</strong> Bit field of alerts to enable (see documentation for alert flags) </p></li>
<li><p><strong>current_alerts</strong> -- <strong>[out]</strong> Bit field of currently raised alerts. Set to NULL if unused</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Alerts reconfigured</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422twai_initiate_recoveryv">
<span id="_CPPv322twai_initiate_recoveryv"></span><span id="_CPPv222twai_initiate_recoveryv"></span><span id="twai_initiate_recovery__void"></span><span class="target" id="twai_8h_1a6225538de3d525501edc80d2a86af4bc"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_initiate_recovery</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422twai_initiate_recoveryv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start the bus recovery process. </p>
<p>This function initiates the bus recovery process when the TWAI driver is in the bus-off state. Once initiated, the TWAI driver will enter the recovering state and wait for 128 occurrences of the bus-free signal on the TWAI bus before returning to the stopped state. This function will reset the TX queue, clearing any messages pending transmission.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The BUS_RECOVERED alert can be enabled to alert the application when the bus recovery process completes.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>ESP_OK: Bus recovery started</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not in the bus-off state, or is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425twai_initiate_recovery_v213twai_handle_t">
<span id="_CPPv325twai_initiate_recovery_v213twai_handle_t"></span><span id="_CPPv225twai_initiate_recovery_v213twai_handle_t"></span><span id="twai_initiate_recovery_v2__twai_handle_t"></span><span class="target" id="twai_8h_1a0a5792b62d2e9e2a617501a25828f69c"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_initiate_recovery_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425twai_initiate_recovery_v213twai_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start the bus recovery process with a given handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_initiate_recovery</span></code> that can start the bus recovery process with a given handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_initiate_recovery</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Bus recovery started</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not in the bus-off state, or is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420twai_get_status_infoP18twai_status_info_t">
<span id="_CPPv320twai_get_status_infoP18twai_status_info_t"></span><span id="_CPPv220twai_get_status_infoP18twai_status_info_t"></span><span id="twai_get_status_info__twai_status_info_tP"></span><span class="target" id="twai_8h_1a7da5f8e8fe978d5705a9f14a9c96b1ee"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_get_status_info</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv418twai_status_info_t" title="twai_status_info_t"><span class="n"><span class="pre">twai_status_info_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">status_info</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420twai_get_status_infoP18twai_status_info_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get current status information of the TWAI driver. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>status_info</strong> -- <strong>[out]</strong> Status information</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Status information retrieved</p></li>
<li><p>ESP_ERR_INVALID_ARG: Arguments are invalid</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423twai_get_status_info_v213twai_handle_tP18twai_status_info_t">
<span id="_CPPv323twai_get_status_info_v213twai_handle_tP18twai_status_info_t"></span><span id="_CPPv223twai_get_status_info_v213twai_handle_tP18twai_status_info_t"></span><span id="twai_get_status_info_v2__twai_handle_t.twai_status_info_tP"></span><span class="target" id="twai_8h_1a406c2042cb10aebd8094b6a94fb79113"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_get_status_info_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv418twai_status_info_t" title="twai_status_info_t"><span class="n"><span class="pre">twai_status_info_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">status_info</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423twai_get_status_info_v213twai_handle_tP18twai_status_info_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get current status information of a given TWAI driver handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_get_status_info</span></code> that can get current status information of a given TWAI driver handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_get_status_info</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p></li>
<li><p><strong>status_info</strong> -- <strong>[out]</strong> Status information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Status information retrieved</p></li>
<li><p>ESP_ERR_INVALID_ARG: Arguments are invalid</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425twai_clear_transmit_queuev">
<span id="_CPPv325twai_clear_transmit_queuev"></span><span id="_CPPv225twai_clear_transmit_queuev"></span><span id="twai_clear_transmit_queue__void"></span><span class="target" id="twai_8h_1aab717cf8c5a8bcf26eca86458a8e85e7"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_clear_transmit_queue</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425twai_clear_transmit_queuev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Clear the transmit queue. </p>
<p>This function will clear the transmit queue of all messages.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The transmit queue is automatically cleared when twai_stop() or twai_initiate_recovery() is called.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>ESP_OK: Transmit queue cleared</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed or TX queue is disabled </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428twai_clear_transmit_queue_v213twai_handle_t">
<span id="_CPPv328twai_clear_transmit_queue_v213twai_handle_t"></span><span id="_CPPv228twai_clear_transmit_queue_v213twai_handle_t"></span><span id="twai_clear_transmit_queue_v2__twai_handle_t"></span><span class="target" id="twai_8h_1aa34b65d9f06f0822332e0c1ff116cd76"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_clear_transmit_queue_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428twai_clear_transmit_queue_v213twai_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Clear the transmit queue of a given TWAI driver handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_clear_transmit_queue</span></code> that can clear the transmit queue of a given TWAI driver handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_clear_transmit_queue</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Transmit queue cleared</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed or TX queue is disabled </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424twai_clear_receive_queuev">
<span id="_CPPv324twai_clear_receive_queuev"></span><span id="_CPPv224twai_clear_receive_queuev"></span><span id="twai_clear_receive_queue__void"></span><span class="target" id="twai_8h_1a9a7c4d161aaaa7f36dd3eefa991dc2e1"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_clear_receive_queue</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424twai_clear_receive_queuev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Clear the receive queue. </p>
<p>This function will clear the receive queue of all messages.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The receive queue is automatically cleared when twai_start() is called.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>ESP_OK: Transmit queue cleared</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427twai_clear_receive_queue_v213twai_handle_t">
<span id="_CPPv327twai_clear_receive_queue_v213twai_handle_t"></span><span id="_CPPv227twai_clear_receive_queue_v213twai_handle_t"></span><span id="twai_clear_receive_queue_v2__twai_handle_t"></span><span class="target" id="twai_8h_1ab56721851c277b06f02297af33fb1cb9"></span><a class="reference internal" href="../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_clear_receive_queue_v2</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv413twai_handle_t" title="twai_handle_t"><span class="n"><span class="pre">twai_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427twai_clear_receive_queue_v213twai_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Clear the receive queue of a given TWAI driver handle. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an advanced version of <code class="docutils literal notranslate"><span class="pre">twai_clear_receive_queue</span></code> that can clear the receive queue of a given TWAI driver handle. Please refer to the documentation of <code class="docutils literal notranslate"><span class="pre">twai_clear_receive_queue</span></code> for more details.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>handle</strong> -- <strong>[in]</strong> TWAI driver handle returned by <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: Transmit queue cleared</p></li>
<li><p>ESP_ERR_INVALID_STATE: TWAI driver is not installed </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id3">
<h3>Structures<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv421twai_general_config_t">
<span id="_CPPv321twai_general_config_t"></span><span id="_CPPv221twai_general_config_t"></span><span id="twai_general_config_t"></span><span class="target" id="structtwai__general__config__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_general_config_t</span></span></span><a class="headerlink" href="#_CPPv421twai_general_config_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure for general configuration of the TWAI driver. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Macro initializers are available for this structure </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t13controller_idE">
<span id="_CPPv3N21twai_general_config_t13controller_idE"></span><span id="_CPPv2N21twai_general_config_t13controller_idE"></span><span id="twai_general_config_t::controller_id__i"></span><span class="target" id="structtwai__general__config__t_1a24ea58427ca5790f574101c408db9639"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">controller_id</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t13controller_idE" title="Permalink to this definition"></a><br /></dt>
<dd><p>TWAI controller ID, index from 0. If you want to install TWAI driver with a non-zero controller_id, please use <code class="docutils literal notranslate"><span class="pre">twai_driver_install_v2</span></code></p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t4modeE">
<span id="_CPPv3N21twai_general_config_t4modeE"></span><span id="_CPPv2N21twai_general_config_t4modeE"></span><span id="twai_general_config_t::mode__twai_mode_t"></span><span class="target" id="structtwai__general__config__t_1a25dc1805a7128c14a13727a07b253cd4"></span><a class="reference internal" href="#_CPPv411twai_mode_t" title="twai_mode_t"><span class="n"><span class="pre">twai_mode_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mode</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t4modeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Mode of TWAI controller </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t5tx_ioE">
<span id="_CPPv3N21twai_general_config_t5tx_ioE"></span><span id="_CPPv2N21twai_general_config_t5tx_ioE"></span><span id="twai_general_config_t::tx_io__gpio_num_t"></span><span class="target" id="structtwai__general__config__t_1a2b54c46ba84d6511052eb753c3856041"></span><span class="n"><span class="pre">gpio_num_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tx_io</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t5tx_ioE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Transmit GPIO number </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t5rx_ioE">
<span id="_CPPv3N21twai_general_config_t5rx_ioE"></span><span id="_CPPv2N21twai_general_config_t5rx_ioE"></span><span id="twai_general_config_t::rx_io__gpio_num_t"></span><span class="target" id="structtwai__general__config__t_1a6abdeec0af71d9dc4caa141337045cb1"></span><span class="n"><span class="pre">gpio_num_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rx_io</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t5rx_ioE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Receive GPIO number </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t9clkout_ioE">
<span id="_CPPv3N21twai_general_config_t9clkout_ioE"></span><span id="_CPPv2N21twai_general_config_t9clkout_ioE"></span><span id="twai_general_config_t::clkout_io__gpio_num_t"></span><span class="target" id="structtwai__general__config__t_1af904602c9fcaae4c7f389e9547d6703f"></span><span class="n"><span class="pre">gpio_num_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">clkout_io</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t9clkout_ioE" title="Permalink to this definition"></a><br /></dt>
<dd><p>CLKOUT GPIO number (optional, set to -1 if unused) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t10bus_off_ioE">
<span id="_CPPv3N21twai_general_config_t10bus_off_ioE"></span><span id="_CPPv2N21twai_general_config_t10bus_off_ioE"></span><span id="twai_general_config_t::bus_off_io__gpio_num_t"></span><span class="target" id="structtwai__general__config__t_1a028a5dfe7aa7234b6f5728d5f223beab"></span><span class="n"><span class="pre">gpio_num_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bus_off_io</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t10bus_off_ioE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Bus off indicator GPIO number (optional, set to -1 if unused) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t12tx_queue_lenE">
<span id="_CPPv3N21twai_general_config_t12tx_queue_lenE"></span><span id="_CPPv2N21twai_general_config_t12tx_queue_lenE"></span><span id="twai_general_config_t::tx_queue_len__uint32_t"></span><span class="target" id="structtwai__general__config__t_1a7397fd7d1dd655b628471c8156a98180"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tx_queue_len</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t12tx_queue_lenE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of messages TX queue can hold (set to 0 to disable TX Queue) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t12rx_queue_lenE">
<span id="_CPPv3N21twai_general_config_t12rx_queue_lenE"></span><span id="_CPPv2N21twai_general_config_t12rx_queue_lenE"></span><span id="twai_general_config_t::rx_queue_len__uint32_t"></span><span class="target" id="structtwai__general__config__t_1ab2abe1aee81d50c090ff73f764d58fdf"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rx_queue_len</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t12rx_queue_lenE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of messages RX queue can hold </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t14alerts_enabledE">
<span id="_CPPv3N21twai_general_config_t14alerts_enabledE"></span><span id="_CPPv2N21twai_general_config_t14alerts_enabledE"></span><span id="twai_general_config_t::alerts_enabled__uint32_t"></span><span class="target" id="structtwai__general__config__t_1a068ae5169de44e818727fc871be86627"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">alerts_enabled</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t14alerts_enabledE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Bit field of alerts to enable (see documentation) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t14clkout_dividerE">
<span id="_CPPv3N21twai_general_config_t14clkout_dividerE"></span><span id="_CPPv2N21twai_general_config_t14clkout_dividerE"></span><span id="twai_general_config_t::clkout_divider__uint32_t"></span><span class="target" id="structtwai__general__config__t_1a861316049c4876254a359eb84d12ca4e"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">clkout_divider</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t14clkout_dividerE" title="Permalink to this definition"></a><br /></dt>
<dd><p>CLKOUT divider. Can be 1 or any even number from 2 to 14 (optional, set to 0 if unused) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t10intr_flagsE">
<span id="_CPPv3N21twai_general_config_t10intr_flagsE"></span><span id="_CPPv2N21twai_general_config_t10intr_flagsE"></span><span id="twai_general_config_t::intr_flags__i"></span><span class="target" id="structtwai__general__config__t_1ae28d81f46d736c24ada121a463d84526"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">intr_flags</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t10intr_flagsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Interrupt flags to set the priority of the driver's ISR. Note that to use the ESP_INTR_FLAG_IRAM, the CONFIG_TWAI_ISR_IN_IRAM option should be enabled first. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t14sleep_allow_pdE">
<span id="_CPPv3N21twai_general_config_t14sleep_allow_pdE"></span><span id="_CPPv2N21twai_general_config_t14sleep_allow_pdE"></span><span id="twai_general_config_t::sleep_allow_pd__uint32_t"></span><span class="target" id="structtwai__general__config__t_1a6f524e89af63a937cb2e3f2b0685a208"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sleep_allow_pd</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t14sleep_allow_pdE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set to allow power down. When this flag set, the driver will backup/restore the TWAI registers before/after entering/exist sleep mode. By this approach, the system can power off TWAI's power domain. This can save power, but at the expense of more RAM being consumed. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21twai_general_config_t13general_flagsE">
<span id="_CPPv3N21twai_general_config_t13general_flagsE"></span><span id="_CPPv2N21twai_general_config_t13general_flagsE"></span><span id="twai_general_config_t::general_flags__twai_general_config_t"></span><span class="target" id="structtwai__general__config__t_1aed407ad1a06f946294925a1a26b79038"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv421twai_general_config_t" title="twai_general_config_t"><span class="n"><span class="pre">twai_general_config_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">general_flags</span></span></span><a class="headerlink" href="#_CPPv4N21twai_general_config_t13general_flagsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>General flags </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv418twai_status_info_t">
<span id="_CPPv318twai_status_info_t"></span><span id="_CPPv218twai_status_info_t"></span><span id="twai_status_info_t"></span><span class="target" id="structtwai__status__info__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_status_info_t</span></span></span><a class="headerlink" href="#_CPPv418twai_status_info_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure to store status information of TWAI driver. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18twai_status_info_t5stateE">
<span id="_CPPv3N18twai_status_info_t5stateE"></span><span id="_CPPv2N18twai_status_info_t5stateE"></span><span id="twai_status_info_t::state__twai_state_t"></span><span class="target" id="structtwai__status__info__t_1a09a63a5696ff6616216b3c33cb3506e1"></span><a class="reference internal" href="#_CPPv412twai_state_t" title="twai_state_t"><span class="n"><span class="pre">twai_state_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">state</span></span></span><a class="headerlink" href="#_CPPv4N18twai_status_info_t5stateE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Current state of TWAI controller (Stopped/Running/Bus-Off/Recovery) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18twai_status_info_t10msgs_to_txE">
<span id="_CPPv3N18twai_status_info_t10msgs_to_txE"></span><span id="_CPPv2N18twai_status_info_t10msgs_to_txE"></span><span id="twai_status_info_t::msgs_to_tx__uint32_t"></span><span class="target" id="structtwai__status__info__t_1aa604d852d4b8caf03a0a89c3488aecc0"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">msgs_to_tx</span></span></span><a class="headerlink" href="#_CPPv4N18twai_status_info_t10msgs_to_txE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of messages queued for transmission or awaiting transmission completion </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18twai_status_info_t10msgs_to_rxE">
<span id="_CPPv3N18twai_status_info_t10msgs_to_rxE"></span><span id="_CPPv2N18twai_status_info_t10msgs_to_rxE"></span><span id="twai_status_info_t::msgs_to_rx__uint32_t"></span><span class="target" id="structtwai__status__info__t_1ac399447c12f425fb5e123837f2ccc859"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">msgs_to_rx</span></span></span><a class="headerlink" href="#_CPPv4N18twai_status_info_t10msgs_to_rxE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of messages in RX queue waiting to be read </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18twai_status_info_t16tx_error_counterE">
<span id="_CPPv3N18twai_status_info_t16tx_error_counterE"></span><span id="_CPPv2N18twai_status_info_t16tx_error_counterE"></span><span id="twai_status_info_t::tx_error_counter__uint32_t"></span><span class="target" id="structtwai__status__info__t_1a01932167594d16f895d32ce41063b077"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tx_error_counter</span></span></span><a class="headerlink" href="#_CPPv4N18twai_status_info_t16tx_error_counterE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Current value of Transmit Error Counter </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18twai_status_info_t16rx_error_counterE">
<span id="_CPPv3N18twai_status_info_t16rx_error_counterE"></span><span id="_CPPv2N18twai_status_info_t16rx_error_counterE"></span><span id="twai_status_info_t::rx_error_counter__uint32_t"></span><span class="target" id="structtwai__status__info__t_1a71c74f6c01e9f71c8405b05743a9ffd8"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rx_error_counter</span></span></span><a class="headerlink" href="#_CPPv4N18twai_status_info_t16rx_error_counterE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Current value of Receive Error Counter </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18twai_status_info_t15tx_failed_countE">
<span id="_CPPv3N18twai_status_info_t15tx_failed_countE"></span><span id="_CPPv2N18twai_status_info_t15tx_failed_countE"></span><span id="twai_status_info_t::tx_failed_count__uint32_t"></span><span class="target" id="structtwai__status__info__t_1a5f77c20d86d06beb1d7e1cfbeb7a0d11"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tx_failed_count</span></span></span><a class="headerlink" href="#_CPPv4N18twai_status_info_t15tx_failed_countE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of messages that failed transmissions </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18twai_status_info_t15rx_missed_countE">
<span id="_CPPv3N18twai_status_info_t15rx_missed_countE"></span><span id="_CPPv2N18twai_status_info_t15rx_missed_countE"></span><span id="twai_status_info_t::rx_missed_count__uint32_t"></span><span class="target" id="structtwai__status__info__t_1a8ad20d2594a726c44e24e7acfd2b309e"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rx_missed_count</span></span></span><a class="headerlink" href="#_CPPv4N18twai_status_info_t15rx_missed_countE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of messages that were lost due to a full RX queue (or errata workaround if enabled) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18twai_status_info_t16rx_overrun_countE">
<span id="_CPPv3N18twai_status_info_t16rx_overrun_countE"></span><span id="_CPPv2N18twai_status_info_t16rx_overrun_countE"></span><span id="twai_status_info_t::rx_overrun_count__uint32_t"></span><span class="target" id="structtwai__status__info__t_1a9bbe2e11ecac7019a8356e950eb11502"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rx_overrun_count</span></span></span><a class="headerlink" href="#_CPPv4N18twai_status_info_t16rx_overrun_countE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of messages that were lost due to a RX FIFO overrun </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18twai_status_info_t14arb_lost_countE">
<span id="_CPPv3N18twai_status_info_t14arb_lost_countE"></span><span id="_CPPv2N18twai_status_info_t14arb_lost_countE"></span><span id="twai_status_info_t::arb_lost_count__uint32_t"></span><span class="target" id="structtwai__status__info__t_1a36a8581d64cf1f8b5fa5d372227d14bf"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">arb_lost_count</span></span></span><a class="headerlink" href="#_CPPv4N18twai_status_info_t14arb_lost_countE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of instances arbitration was lost </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18twai_status_info_t15bus_error_countE">
<span id="_CPPv3N18twai_status_info_t15bus_error_countE"></span><span id="_CPPv2N18twai_status_info_t15bus_error_countE"></span><span id="twai_status_info_t::bus_error_count__uint32_t"></span><span class="target" id="structtwai__status__info__t_1a131bb4a7c359704b39c99883dc02c435"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bus_error_count</span></span></span><a class="headerlink" href="#_CPPv4N18twai_status_info_t15bus_error_countE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of instances a bus error has occurred </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="id4">
<h3>Macros<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.TWAI_IO_UNUSED">
<span class="target" id="twai_8h_1aab2695fca98cd6b95b92acdd2f71baaf"></span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_IO_UNUSED</span></span></span><a class="headerlink" href="#c.TWAI_IO_UNUSED" title="Permalink to this definition"></a><br /></dt>
<dd><p>Marks GPIO as unused in TWAI configuration </p>
</dd></dl>

</section>
<section id="id5">
<h3>Type Definitions<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv413twai_handle_t">
<span id="_CPPv313twai_handle_t"></span><span id="_CPPv213twai_handle_t"></span><span id="twai_handle_t"></span><span class="target" id="twai_8h_1a5528b7e0379dfed4b3227843672fe515"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">twai_obj_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">twai_handle_t</span></span></span><a class="headerlink" href="#_CPPv413twai_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>TWAI controller handle. </p>
</dd></dl>

</section>
<section id="id6">
<h3>Enumerations<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h3>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv412twai_state_t">
<span id="_CPPv312twai_state_t"></span><span id="_CPPv212twai_state_t"></span><span class="target" id="twai_8h_1a5e574a567b2d643c0cd47a3020597937"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">twai_state_t</span></span></span><a class="headerlink" href="#_CPPv412twai_state_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>TWAI driver states. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N12twai_state_t18TWAI_STATE_STOPPEDE">
<span id="_CPPv3N12twai_state_t18TWAI_STATE_STOPPEDE"></span><span id="_CPPv2N12twai_state_t18TWAI_STATE_STOPPEDE"></span><span class="target" id="twai_8h_1a5e574a567b2d643c0cd47a3020597937a9caf4ddef53a65e404223ef931cb153f"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_STATE_STOPPED</span></span></span><a class="headerlink" href="#_CPPv4N12twai_state_t18TWAI_STATE_STOPPEDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Stopped state. The TWAI controller will not participate in any TWAI bus activities </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N12twai_state_t18TWAI_STATE_RUNNINGE">
<span id="_CPPv3N12twai_state_t18TWAI_STATE_RUNNINGE"></span><span id="_CPPv2N12twai_state_t18TWAI_STATE_RUNNINGE"></span><span class="target" id="twai_8h_1a5e574a567b2d643c0cd47a3020597937a5e3ee9d81d84a6bad260948413b538b1"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_STATE_RUNNING</span></span></span><a class="headerlink" href="#_CPPv4N12twai_state_t18TWAI_STATE_RUNNINGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Running state. The TWAI controller can transmit and receive messages </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N12twai_state_t18TWAI_STATE_BUS_OFFE">
<span id="_CPPv3N12twai_state_t18TWAI_STATE_BUS_OFFE"></span><span id="_CPPv2N12twai_state_t18TWAI_STATE_BUS_OFFE"></span><span class="target" id="twai_8h_1a5e574a567b2d643c0cd47a3020597937a1b9f536bb2c32f28a3cd34da04f4f2ee"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_STATE_BUS_OFF</span></span></span><a class="headerlink" href="#_CPPv4N12twai_state_t18TWAI_STATE_BUS_OFFE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Bus-off state. The TWAI controller cannot participate in bus activities until it has recovered </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N12twai_state_t21TWAI_STATE_RECOVERINGE">
<span id="_CPPv3N12twai_state_t21TWAI_STATE_RECOVERINGE"></span><span id="_CPPv2N12twai_state_t21TWAI_STATE_RECOVERINGE"></span><span class="target" id="twai_8h_1a5e574a567b2d643c0cd47a3020597937a171dcade9ffab748af12c006fcbb920f"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TWAI_STATE_RECOVERING</span></span></span><a class="headerlink" href="#_CPPv4N12twai_state_t21TWAI_STATE_RECOVERINGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Recovering state. The TWAI controller is undergoing bus recovery </p>
</dd></dl>

</dd></dl>

</section>
</section>
</section>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

           </div>
             <div class="articleComments">

<style>
    .expand-feedback-content {
        display: none;
    }
    .click-like-or-dislike {
        background-color: #d3d3d3;
        pointer-events: none;
    }
</style>

<script>
    function submitFeedbackForm(user_likes_document) {
        // Send to GA4 the user reaction
        gtag('event', 'user_reaction', {
            'user_likes_document': user_likes_document
        });

        if (user_likes_document === 1) {
            document.querySelector('.like-btn').classList.add('click-like-or-dislike');
            document.getElementById("expandContentLike").style.display = 'block';
        } else {
            document.querySelector('.dislike-btn').classList.add('click-like-or-dislike');
            document.getElementById("expandContent").style.display = 'block';
        }

        document.querySelector('.like-btn').style.pointerEvents = 'none';
        document.querySelector('.dislike-btn').style.pointerEvents = 'none';
    }
</script>

<hr>

<p style="text-align:center"><strong>Was this page helpful?</strong></p>
<p style="text-align:center">
    <button class="like-btn" onclick="submitFeedbackForm(1)">
        <svg aria-hidden="true" focusable="false" class="color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom;overflow:visible">
            <path d="M8.834.066c.763.087 1.5.295 2.01.884.505.581.656 1.378.656 2.3 0 .467-.087 1.119-.157 1.637L11.328 5h1.422c.603 0 1.174.085 1.668.333.508.254.911.679 1.137 1.2.453.998.438 2.447.188 4.316l-.04.306c-.105.79-.195 1.473-.313 2.033-.131.63-.315 1.209-.668 1.672C13.97 15.847 12.706 16 11 16c-1.848 0-3.234-.333-4.388-.653-.165-.045-.323-.09-.475-.133-.658-.186-1.2-.34-1.725-.415A1.75 1.75 0 0 1 2.75 16h-1A1.75 1.75 0 0 1 0 14.25v-7.5C0 5.784.784 5 1.75 5h1a1.75 1.75 0 0 1 1.514.872c.258-.105.59-.268.918-.508C5.853 4.874 6.5 4.079 6.5 2.75v-.5c0-1.202.994-2.337 2.334-2.184ZM4.5 13.3c.705.088 1.39.284 2.072.478l.441.125c1.096.305 2.334.598 3.987.598 1.794 0 2.28-.223 2.528-.549.147-.193.276-.505.394-1.07.105-.502.188-1.124.295-1.93l.04-.3c.25-1.882.189-2.933-.068-3.497a.921.921 0 0 0-.442-.48c-.208-.104-.52-.174-.997-.174H11c-.686 0-1.295-.577-1.206-1.336.023-.192.05-.39.076-.586.065-.488.13-.97.13-1.328 0-.809-.144-1.15-.288-1.316-.137-.158-.402-.304-1.048-.378C8.357 1.521 8 1.793 8 2.25v.5c0 1.922-.978 3.128-1.933 3.825a5.831 5.831 0 0 1-1.567.81ZM2.75 6.5h-1a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h1a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
        </svg>
    </button>
    <button class="dislike-btn" onclick="submitFeedbackForm(0)">
        <svg aria-hidden="true" focusable="false" class="" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom;overflow:visible">
            <path d="M7.083 15.986c-.763-.087-1.499-.295-2.011-.884-.504-.581-.655-1.378-.655-2.299 0-.468.087-1.12.157-1.638l.015-.112H3.167c-.603 0-1.174-.086-1.669-.334a2.415 2.415 0 0 1-1.136-1.2c-.454-.998-.438-2.447-.188-4.316l.04-.306C.32 4.108.41 3.424.526 2.864c.132-.63.316-1.209.669-1.672C1.947.205 3.211.053 4.917.053c1.848 0 3.234.332 4.388.652l.474.133c.658.187 1.201.341 1.726.415a1.75 1.75 0 0 1 1.662-1.2h1c.966 0 1.75.784 1.75 1.75v7.5a1.75 1.75 0 0 1-1.75 1.75h-1a1.75 1.75 0 0 1-1.514-.872c-.259.105-.59.268-.919.508-.671.491-1.317 1.285-1.317 2.614v.5c0 1.201-.994 2.336-2.334 2.183Zm4.334-13.232c-.706-.089-1.39-.284-2.072-.479l-.441-.125c-1.096-.304-2.335-.597-3.987-.597-1.794 0-2.28.222-2.529.548-.147.193-.275.505-.393 1.07-.105.502-.188 1.124-.295 1.93l-.04.3c-.25 1.882-.19 2.933.067 3.497a.923.923 0 0 0 .443.48c.208.104.52.175.997.175h1.75c.685 0 1.295.577 1.205 1.335-.022.192-.049.39-.075.586-.066.488-.13.97-.13 1.329 0 .808.144 1.15.288 1.316.137.157.401.303 1.048.377.307.035.664-.237.664-.693v-.5c0-1.922.978-3.127 1.932-3.825a5.878 5.878 0 0 1 1.568-.809Zm1.75 6.798h1a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25h-1a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25Z"></path>
        </svg>
    </button>
</p>

<div class="expand-feedback-content" id="expandContentLike">
    <ul style="text-align:center">
        <li>Thank you! We received your feedback.</li>
        <li>If you have any comments, fill in <a href='https://www.espressif.com/en/company/documents/documentation_feedback?docId=4287&sections=Two-Wire Automotive Interface (TWAI) (api-reference/peripherals/twai)&version=esp32 v5.4.2 (v5.4.2)'>Espressif Documentation Feedback Form</a>.</li>
    </ul>
</div>

<div class="expand-feedback-content" id="expandContent">
    <ul style="text-align:center">
        <li>We value your feedback.</li>
        <li>Let us know how we can improve this page by filling in <a href='https://www.espressif.com/en/company/documents/documentation_feedback?docId=4287&sections=Two-Wire Automotive Interface (TWAI) (api-reference/peripherals/twai)&version=esp32 v5.4.2 (v5.4.2)'>Espressif Documentation Feedback Form</a>.</li>
    </ul>
</div>

<br>


             </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="touch_pad.html" class="btn btn-neutral float-left" title="Touch Sensor" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="uart.html" class="btn btn-neutral float-right" title="Universal Asynchronous Receiver/Transmitter (UART)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016 - 2025, Espressif Systems (Shanghai) Co., Ltd.</p>
  </div>

  <ul class="footer">
        <li>
	    
            
            Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/espressif/sphinx_idf_theme">theme</a>  based on <a href="https://github.com/readthedocs/sphinx_rtd_theme">Read the Docs Sphinx Theme</a>.
         </li>
    <li class="footer-aside">
        <a href="../../esp-idf-en-v5.4.2.zip"> Download HTML</a>
    </li>

  </ul> 

</footer>
        </div>
      </div>
    </section>
  </div>

  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>