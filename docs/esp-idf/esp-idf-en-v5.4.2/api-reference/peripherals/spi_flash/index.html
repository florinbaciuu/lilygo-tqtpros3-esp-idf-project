<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-73KGWFC8DM"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-73KGWFC8DM');
        </script><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SPI Flash API - ESP32 -  &mdash; ESP-IDF Programming Guide v5.4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=a60756f2" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=949a1ff5" />
      <link rel="stylesheet" type="text/css" href="../../../_static/theme_overrides.css?v=851bd809" />

  
    <link rel="canonical" href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/peripherals/spi_flash/index.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=c241bbaf"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../_static/copybutton.js?v=ff8fa330"></script>
        <script src="https://wavedrom.com/skins/default.js"></script>
        <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>

    
        

    <script type="text/javascript">
        DOCUMENTATION_OPTIONS.PAGENAME = 'api-reference/peripherals/spi_flash/index';
        DOCUMENTATION_OPTIONS.PROJECT_SLUG = 'esp-idf';
        DOCUMENTATION_OPTIONS.LATEST_BRANCH_NAME = 'master';
        DOCUMENTATION_OPTIONS.VERSIONS_URL = 'https://dl.espressif.com/dl/esp-idf/idf_versions.js';
        DOCUMENTATION_OPTIONS.LANGUAGES = ["en", "zh_CN"];
        DOCUMENTATION_OPTIONS.IDF_TARGET = 'esp32';
        DOCUMENTATION_OPTIONS.HAS_IDF_TARGETS = ["esp32", "esp32s2", "esp32s3", "esp32c3", "esp32c2", "esp32c5", "esp32c6", "esp32p4"]
        DOCUMENTATION_OPTIONS.RELEASE = 'v5.4.2';
        DOCUMENTATION_OPTIONS.LANGUAGE_URL = 'en';

    </script>

    <script type="text/javascript" src="https://dl.espressif.com/dl/esp-idf/idf_versions.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Optional Features for Flash" href="spi_flash_optional_feature.html" />
    <link rel="prev" title="Sigma-Delta Modulation (SDM)" href="../sdm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ESP-IDF Programming Guide
              <img src="../../../_static/espressif-logo.svg" class="logo" alt="Logo"/>
          </a>

          
            <div class="selectors">
              <select id="target-select" style="width: 150px;" hidden>
                <option value="" disabled selected>Choose target...</option>
              </select>
            </div>
          

          <div class="selectors">
            <select id="version-select" style="width: 150px;" hidden>
              <option value="" disabled selected>Choose version...</option>
            </select>
          </div>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/index.html">Get Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../api-conventions.html">API Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../protocols/index.html">Application Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bluetooth/index.html">Bluetooth® API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../error-codes.html">Error Codes Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../network/index.html">Networking APIs</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Peripherals API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../adc_oneshot.html">Analog to Digital Converter (ADC) Oneshot Mode Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../adc_continuous.html">Analog to Digital Converter (ADC) Continuous Mode Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../adc_calibration.html">Analog to Digital Converter (ADC) Calibration Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../clk_tree.html">Clock Tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dac.html">Digital To Analog Converter (DAC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpio.html">GPIO &amp; RTC GPIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gptimer.html">General Purpose Timer (GPTimer)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../i2c.html">Inter-Integrated Circuit (I2C)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../i2s.html">Inter-IC Sound (I2S)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lcd/index.html">LCD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ledc.html">LED Control (LEDC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mcpwm.html">Motor Control Pulse Width Modulator (MCPWM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pcnt.html">Pulse Counter (PCNT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rmt.html">Remote Control Transceiver (RMT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sd_pullup_requirements.html">SD Pull-up Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sdmmc_host.html">SDMMC Host Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sdspi_host.html">SD SPI Host Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sdio_slave.html">SDIO Card Slave Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sdm.html">Sigma-Delta Modulation (SDM)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">SPI Flash API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#support-for-features-of-flash-chips">Support for Features of Flash Chips</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initializing-a-flash-device">Initializing a Flash Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spi-flash-access-api">SPI Flash Access API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spi-flash-size">SPI Flash Size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#concurrency-constraints-for-flash-on-spi1">Concurrency Constraints for Flash on SPI1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spi-flash-encryption">SPI Flash Encryption</a></li>
<li class="toctree-l4"><a class="reference internal" href="#memory-mapping-api">Memory Mapping API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spi-flash-implementation">SPI Flash Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementation-details">Implementation Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="#related-documents">Related Documents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-reference-spi-flash">API Reference - SPI Flash</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-reference-flash-encrypt">API Reference - Flash Encrypt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../spi_master.html">SPI Master Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi_slave.html">SPI Slave Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../touch_pad.html">Touch Sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../twai.html">Two-Wire Automotive Interface (TWAI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../uart.html">Universal Asynchronous Receiver/Transmitter (UART)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../kconfig.html">Project Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../provisioning/index.html">Provisioning API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../storage/index.html">Storage API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../system/index.html">System API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../hw-reference/index.html">Hardware Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api-guides/index.html">API Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/index.html">Security Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../migration-guides/index.html">Migration Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../libraries-and-frameworks/index.html">Libraries and Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute/index.html">Contributions Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../versions.html">ESP-IDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../COPYRIGHT.html">Copyrights and Licenses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../languages.html">Switch Between Languages</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ESP-IDF Programming Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Peripherals API</a></li>
      <li class="breadcrumb-item active">SPI Flash API</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/espressif/esp-idf/blob/v5.4.2/docs/en/api-reference/peripherals/spi_flash/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spi-flash-api">
<h1>SPI Flash API<a class="headerlink" href="#spi-flash-api" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="../../../../../../zh_CN/v5.4.2/esp32/api-reference/peripherals/spi_flash/index.html">[中文]</a></p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>The spi_flash component contains API functions related to reading, writing, erasing, and memory mapping for data in the external flash.</p>
<p>For higher-level API functions which work with partitions defined in the <a class="reference internal" href="../../../api-guides/partition-tables.html"><span class="doc">partition table</span></a>, see <a class="reference internal" href="../../storage/partition.html"><span class="doc">Partitions API</span></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">esp_partition_*</span></code> APIs are recommended to be used instead of the lower level <code class="docutils literal notranslate"><span class="pre">esp_flash_*</span></code> API functions when accessing the main SPI flash chip, since they conduct bounds checking and are guaranteed to calculate correct offsets in flash based on the information in the partition table. <code class="docutils literal notranslate"><span class="pre">esp_flash_*</span></code> functions can still be used directly when accessing an external (secondary) SPI flash chip.</p>
</div>
<p>Different from the API before ESP-IDF v4.0, the functionality of <code class="docutils literal notranslate"><span class="pre">esp_flash_*</span></code> APIs is not limited to the &quot;main&quot; SPI flash chip (the same SPI flash chip from which program runs). With different chip pointers, you can access external flash chips connected to not only SPI0/1 but also other SPI buses like SPI2.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Instead of going through the cache connected to the SPI0 peripheral, most <code class="docutils literal notranslate"><span class="pre">esp_flash_*</span></code> APIs go through other SPI peripherals like SPI1, SPI2, etc. This makes them able to access not only the main flash, but also external (secondary) flash.</p>
<p>However, due to the limitations of the cache, operations through the cache are limited to the main flash. The address range limitation for these operations is also on the cache side. The cache is not able to access external flash chips or address range above its capabilities. These cache operations include: mmap, encrypted read/write, executing code or access to variables in the flash.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Flash APIs after ESP-IDF v4.0 are no longer <strong>atomic</strong>. If a write operation occurs during another on-going read operation, and the flash addresses of both operations overlap, the data returned from the read operation may contain both old data and new data (that was updated written by the write operation).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Encrypted flash operations are only supported with the main flash chip (and not with other flash chips, that is on SPI1 with different CS, or on other SPI buses). Reading through cache is only supported on the main flash, which is determined by the HW.</p>
</div>
</section>
<section id="support-for-features-of-flash-chips">
<h2>Support for Features of Flash Chips<a class="headerlink" href="#support-for-features-of-flash-chips" title="Permalink to this heading"></a></h2>
<section id="quad-dual-mode-chips">
<h3>Quad/Dual Mode Chips<a class="headerlink" href="#quad-dual-mode-chips" title="Permalink to this heading"></a></h3>
<p>Features of different flashes are implemented in different ways and thus need special support. The fast/slow read and Dual mode (DOUT/DIO) of almost all flashes with 24-bit address are supported, because they do not need any vendor-specific commands.</p>
<p>Quad mode (QIO/QOUT) is supported on the following chip types:</p>
<ol class="arabic simple">
<li><p>ISSI</p></li>
<li><p>GD</p></li>
<li><p>MXIC</p></li>
<li><p>FM</p></li>
<li><p>Winbond</p></li>
<li><p>XMC</p></li>
<li><p>BOYA</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only when one flash series listed above is supported by ESP32, this flash series is supported by the chip driver by default. You can use <code class="docutils literal notranslate"><span class="pre">Component</span> <span class="pre">config</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">SPI</span> <span class="pre">Flash</span> <span class="pre">driver</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Auto-detect</span> <span class="pre">flash</span> <span class="pre">chips</span></code> in menuconfig to enable/disable a flash series.</p>
</div>
</section>
<section id="optional-features">
<h3>Optional Features<a class="headerlink" href="#optional-features" title="Permalink to this heading"></a></h3>
<div class="toctree-wrapper compound">
</div>
<p>There are some features that are not supported by all flash chips, or not supported by all Espressif chips. These features include:</p>
<ul class="simple">
<li><p>32-bit address flash - usually means that the flash has higher capacity (equal to or larger than 16 MB) that needs longer addresses.</p></li>
</ul>
<ul class="simple">
<li><p>Flash unique ID - means that flash supports its unique 64-bit ID.</p></li>
</ul>
<p>If you want to use these features, please ensure both ESP32 and ALL flash chips in your product support these features. For more details, refer to <a class="reference internal" href="spi_flash_optional_feature.html"><span class="doc">Optional Features for Flash</span></a>.</p>
<p>You may also customise your own flash chip driver. See <a class="reference internal" href="spi_flash_override_driver.html"><span class="doc">Overriding Default Chip Drivers</span></a> for more details.</p>
<div class="toctree-wrapper compound">
</div>
</section>
</section>
<section id="initializing-a-flash-device">
<h2>Initializing a Flash Device<a class="headerlink" href="#initializing-a-flash-device" title="Permalink to this heading"></a></h2>
<p>To use the <code class="docutils literal notranslate"><span class="pre">esp_flash_*</span></code> APIs, you need to initialise a flash chip on a certain SPI bus, as shown below:</p>
<ol class="arabic simple">
<li><p>Call <a class="reference internal" href="../spi_master.html#_CPPv418spi_bus_initialize17spi_host_device_tPK16spi_bus_config_t14spi_dma_chan_t" title="spi_bus_initialize"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">spi_bus_initialize()</span></code></a> to properly initialize an SPI bus. This function initializes the resources (I/O, DMA, interrupts) shared among devices attached to this bus.</p></li>
<li><p>Call <a class="reference internal" href="#_CPPv424spi_bus_add_flash_devicePP11esp_flash_tPK29esp_flash_spi_device_config_t" title="spi_bus_add_flash_device"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">spi_bus_add_flash_device()</span></code></a> to attach the flash device to the bus. This function allocates memory and fills the members for the <code class="docutils literal notranslate"><span class="pre">esp_flash_t</span></code> structure. The CS I/O is also initialized here.</p></li>
<li><p>Call <a class="reference internal" href="#_CPPv414esp_flash_initP11esp_flash_t" title="esp_flash_init"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_flash_init()</span></code></a> to actually communicate with the chip. This also detects the chip type, and influence the following operations.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiple flash chips can be attached to the same bus now.</p>
</div>
</section>
<section id="spi-flash-access-api">
<h2>SPI Flash Access API<a class="headerlink" href="#spi-flash-access-api" title="Permalink to this heading"></a></h2>
<p>This is the set of API functions for working with data in flash:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#_CPPv414esp_flash_readP11esp_flash_tPv8uint32_t8uint32_t" title="esp_flash_read"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_flash_read()</span></code></a> reads data from flash to RAM</p></li>
<li><p><a class="reference internal" href="#_CPPv415esp_flash_writeP11esp_flash_tPKv8uint32_t8uint32_t" title="esp_flash_write"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_flash_write()</span></code></a> writes data from RAM to flash</p></li>
<li><p><a class="reference internal" href="#_CPPv422esp_flash_erase_regionP11esp_flash_t8uint32_t8uint32_t" title="esp_flash_erase_region"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_flash_erase_region()</span></code></a> erases specific region of flash</p></li>
<li><p><a class="reference internal" href="#_CPPv420esp_flash_erase_chipP11esp_flash_t" title="esp_flash_erase_chip"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_flash_erase_chip()</span></code></a> erases the whole flash</p></li>
<li><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_flash_get_chip_size()</span></code> returns flash chip size, in bytes, as configured in menuconfig</p></li>
</ul>
<p>Generally, try to avoid using the raw SPI flash functions to the &quot;main&quot; SPI flash chip in favour of <a class="reference internal" href="../../storage/partition.html#flash-partition-apis"><span class="std std-ref">partition-specific functions</span></a>.</p>
</section>
<section id="spi-flash-size">
<h2>SPI Flash Size<a class="headerlink" href="#spi-flash-size" title="Permalink to this heading"></a></h2>
<p>The SPI flash size is configured by writing a field in the ESP-IDF second stage bootloader image header, flashed at offset 0x1000.</p>
<p>By default, the SPI flash size is detected by <code class="docutils literal notranslate"><span class="pre">esptool.py</span></code> when this bootloader is written to flash, and the header is updated with the correct size. Alternatively, it is possible to generate a fixed flash size by setting <a class="reference internal" href="../../kconfig.html#config-esptoolpy-flashsize"><span class="std std-ref">CONFIG_ESPTOOLPY_FLASHSIZE</span></a> in the project configuration.</p>
<p>If it is necessary to override the configured flash size at runtime, it is possible to set the <code class="docutils literal notranslate"><span class="pre">chip_size</span></code> member of the <code class="docutils literal notranslate"><span class="pre">g_rom_flashchip</span></code> structure. This size is used by <code class="docutils literal notranslate"><span class="pre">esp_flash_*</span></code> functions (in both software &amp; ROM) to check the bounds.</p>
</section>
<section id="concurrency-constraints-for-flash-on-spi1">
<h2>Concurrency Constraints for Flash on SPI1<a class="headerlink" href="#concurrency-constraints-for-flash-on-spi1" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The SPI0/1 bus is shared between the instruction &amp; data cache (for firmware execution) and the SPI1 peripheral (controlled by the drivers including this SPI flash driver). Hence, calling SPI Flash API on SPI1 bus (including the main flash) causes significant influence to the whole system. See <a class="reference internal" href="spi_flash_concurrency.html"><span class="doc">Concurrency Constraints for Flash on SPI1</span></a> for more details.</p>
</div>
</section>
<section id="spi-flash-encryption">
<h2>SPI Flash Encryption<a class="headerlink" href="#spi-flash-encryption" title="Permalink to this heading"></a></h2>
<p>It is possible to encrypt the contents of SPI flash and have it transparently decrypted by hardware.</p>
<p>Refer to the <a class="reference internal" href="../../../security/flash-encryption.html"><span class="doc">Flash Encryption documentation</span></a> for more details.</p>
</section>
<section id="memory-mapping-api">
<h2>Memory Mapping API<a class="headerlink" href="#memory-mapping-api" title="Permalink to this heading"></a></h2>
<p>ESP32 features memory hardware which allows regions of flash memory to be mapped into instruction and data address spaces. This mapping works only for read operations. It is not possible to modify contents of flash memory by writing to a mapped memory region.</p>
<p>Mapping happens in 64 KB pages. Memory mapping hardware can map flash into the data address space and the instruction address space. See the technical reference manual for more details and limitations about memory mapping hardware.</p>
<p>Note that some pages are used to map the application itself into memory, so the actual number of available pages may be less than the capability of the hardware.</p>
<p>Reading data from flash using a memory mapped region is the only way to decrypt contents of flash when <a class="reference internal" href="../../../security/flash-encryption.html"><span class="doc">flash encryption</span></a> is enabled. Decryption is performed at the hardware level.</p>
<p>Memory mapping API are declared in <code class="docutils literal notranslate"><span class="pre">spi_flash_mmap.h</span></code> and <code class="docutils literal notranslate"><span class="pre">esp_partition.h</span></code>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#_CPPv414spi_flash_mmap6size_t6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t" title="spi_flash_mmap"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">spi_flash_mmap()</span></code></a> maps a region of physical flash addresses into instruction space or data space of the CPU.</p></li>
<li><p><a class="reference internal" href="#_CPPv416spi_flash_munmap23spi_flash_mmap_handle_t" title="spi_flash_munmap"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">spi_flash_munmap()</span></code></a> unmaps previously mapped region.</p></li>
<li><p><a class="reference internal" href="../../storage/partition.html#_CPPv418esp_partition_mmapPK15esp_partition_t6size_t6size_t27esp_partition_mmap_memory_tPPKvP27esp_partition_mmap_handle_t" title="esp_partition_mmap"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_partition_mmap()</span></code></a> maps part of a partition into the instruction space or data space of the CPU.</p></li>
</ul>
<p>Differences between <a class="reference internal" href="#_CPPv414spi_flash_mmap6size_t6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t" title="spi_flash_mmap"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">spi_flash_mmap()</span></code></a> and <a class="reference internal" href="../../storage/partition.html#_CPPv418esp_partition_mmapPK15esp_partition_t6size_t6size_t27esp_partition_mmap_memory_tPPKvP27esp_partition_mmap_handle_t" title="esp_partition_mmap"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_partition_mmap()</span></code></a> are as follows:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#_CPPv414spi_flash_mmap6size_t6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t" title="spi_flash_mmap"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">spi_flash_mmap()</span></code></a> must be given a 64 KB aligned physical address.</p></li>
<li><p><a class="reference internal" href="../../storage/partition.html#_CPPv418esp_partition_mmapPK15esp_partition_t6size_t6size_t27esp_partition_mmap_memory_tPPKvP27esp_partition_mmap_handle_t" title="esp_partition_mmap"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">esp_partition_mmap()</span></code></a> may be given any arbitrary offset within the partition. It adjusts the returned pointer to mapped memory as necessary.</p></li>
</ul>
<p>Note that since memory mapping happens in pages, it may be possible to read data outside of the partition provided to <code class="docutils literal notranslate"><span class="pre">esp_partition_mmap</span></code>, regardless of the partition boundary.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>mmap is supported by cache, so it can only be used on main flash.</p>
</div>
</section>
<section id="spi-flash-implementation">
<h2>SPI Flash Implementation<a class="headerlink" href="#spi-flash-implementation" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">esp_flash_t</span></code> structure holds chip data as well as three important parts of this API:</p>
<ol class="arabic simple">
<li><p>The host driver, which provides the hardware support to access the chip;</p></li>
<li><p>The chip driver, which provides compatibility service to different chips;</p></li>
<li><p>The OS functions, provide support of some OS functions (e.g., lock, delay) in different stages (1st/2nd boot, or the app).</p></li>
</ol>
<section id="host-driver">
<h3>Host Driver<a class="headerlink" href="#host-driver" title="Permalink to this heading"></a></h3>
<p>The host driver relies on an interface (<code class="docutils literal notranslate"><span class="pre">spi_flash_host_driver_t</span></code>) defined in the <code class="docutils literal notranslate"><span class="pre">spi_flash_types.h</span></code> (in the <code class="docutils literal notranslate"><span class="pre">hal/include/hal</span></code> folder). This interface provides some common functions to communicate with the chip.</p>
<p>In other files of the SPI HAL, some of these functions are implemented with existing ESP32 memory-spi functionalities. However, due to the speed limitations of ESP32, the HAL layer cannot provide high-speed implementations to some reading commands (so the support for it was dropped). The files (<code class="docutils literal notranslate"><span class="pre">memspi_host_driver.h</span></code> and <code class="docutils literal notranslate"><span class="pre">.c</span></code>) implement the high-speed version of these commands with the <code class="docutils literal notranslate"><span class="pre">common_command</span></code> function provided in the HAL, and wrap these functions as <code class="docutils literal notranslate"><span class="pre">spi_flash_host_driver_t</span></code> for upper layer to use.</p>
<p>You can also implement your own host driver, even with the GPIO. As long as all the functions in the <code class="docutils literal notranslate"><span class="pre">spi_flash_host_driver_t</span></code> are implemented, the esp_flash API can access the flash regardless of the low-level hardware.</p>
</section>
<section id="chip-driver">
<h3>Chip Driver<a class="headerlink" href="#chip-driver" title="Permalink to this heading"></a></h3>
<p>The chip driver, defined in <code class="docutils literal notranslate"><span class="pre">spi_flash_chip_driver.h</span></code>, wraps basic functions provided by the host driver for the API layer to use.</p>
<p>Some operations need some commands to be sent first, or read some status afterwards. Some chips need different commands or values, or need special communication ways.</p>
<p>There is a type of chip called <code class="docutils literal notranslate"><span class="pre">generic</span> <span class="pre">chip</span></code> which stands for common chips. Other special chip drivers can be developed on the base of the generic chip.</p>
<p>The chip driver relies on the host driver.</p>
</section>
<section id="os-functions">
<span id="esp-flash-os-func"></span><h3>OS Functions<a class="headerlink" href="#os-functions" title="Permalink to this heading"></a></h3>
<div class="toctree-wrapper compound">
</div>
<p>Currently the OS function layer provides entries of a lock and delay.</p>
<p>The lock (see <a class="reference internal" href="../spi_features.html#spi-bus-lock"><span class="std std-ref">SPI Bus Lock</span></a>) is used to resolve the conflicts among the access of devices on the same SPI bus, and the SPI Flash chip access. E.g.</p>
<ol class="arabic simple">
<li><p>On SPI1 bus, the cache (used to fetch the data (code) in the Flash and PSRAM) should be disabled when the flash chip on the SPI0/1 is being accessed.</p></li>
<li><p>On the other buses, the flash driver needs to disable the ISR registered by SPI Master driver, to avoid conflicts.</p></li>
<li><p>Some devices of SPI Master driver may require to use the bus monopolized during a period (especially when the device does not have a CS wire, or the wire is controlled by software like SDSPI driver).</p></li>
</ol>
<p>The delay is used by some long operations which requires the master to wait or polling periodically.</p>
<p>The top API wraps these the chip driver and OS functions into an entire component, and also provides some argument checking.</p>
<p>OS functions can also help to avoid a watchdog timeout when erasing large flash areas. During this time, the CPU is occupied with the flash erasing task. This stops other tasks from being executed. Among these tasks is the idle task to feed the watchdog timer (WDT). If the configuration option <a class="reference internal" href="../../kconfig.html#config-esp-task-wdt-panic"><span class="std std-ref">CONFIG_ESP_TASK_WDT_PANIC</span></a> is selected and the flash operation time is longer than the watchdog timeout period, the system will reboot.</p>
<p>It is pretty hard to totally eliminate this risk, because the erasing time varies with different flash chips, making it hard to be compatible in flash drivers. Therefore, users need to pay attention to it. Please use the following guidelines:</p>
<ol class="arabic simple">
<li><p>It is recommended to enable the <a class="reference internal" href="../../kconfig.html#config-spi-flash-yield-during-erase"><span class="std std-ref">CONFIG_SPI_FLASH_YIELD_DURING_ERASE</span></a> option to allow the scheduler to re-schedule during erasing flash memory. Besides, following parameters can also be used.</p></li>
</ol>
<ul class="simple">
<li><p>Increase <a class="reference internal" href="../../kconfig.html#config-spi-flash-erase-yield-ticks"><span class="std std-ref">CONFIG_SPI_FLASH_ERASE_YIELD_TICKS</span></a> or decrease <a class="reference internal" href="../../kconfig.html#config-spi-flash-erase-yield-duration-ms"><span class="std std-ref">CONFIG_SPI_FLASH_ERASE_YIELD_DURATION_MS</span></a> in menuconfig.</p></li>
<li><p>You can also increase <a class="reference internal" href="../../kconfig.html#config-esp-task-wdt-timeout-s"><span class="std std-ref">CONFIG_ESP_TASK_WDT_TIMEOUT_S</span></a> in menuconfig for a larger watchdog timeout period. However, with larger watchdog timeout period, previously detected timeouts may no longer be detected.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Please be aware of the consequences of enabling the <a class="reference internal" href="../../kconfig.html#config-esp-task-wdt-panic"><span class="std std-ref">CONFIG_ESP_TASK_WDT_PANIC</span></a> option when doing long-running SPI flash operations which triggers the panic handler when it times out. However, this option can also help dealing with unexpected exceptions in your application. Please decide whether this is needed to be enabled according to actual condition.</p></li>
<li><p>During your development, please carefully review the actual flash operation according to the specific requirements and time limits on erasing flash memory of your projects. Always allow reasonable redundancy based on your specific product requirements when configuring the flash erasing timeout threshold, thus improving the reliability of your product.</p></li>
</ol>
</section>
</section>
<section id="implementation-details">
<span id="spi-flash-implementation-details"></span><h2>Implementation Details<a class="headerlink" href="#implementation-details" title="Permalink to this heading"></a></h2>
<p>In order to perform some flash operations, it is necessary to make sure that both CPUs are not running any code from flash for the duration of the flash operation:</p>
<ul class="simple">
<li><p>In a single-core setup, the SDK needs to disable interrupts or scheduler before performing the flash operation.</p></li>
<li><p>In a dual-core setup, the SDK needs to make sure that both CPUs are not running any code from flash.</p></li>
</ul>
<p>When SPI flash API is called on CPU A (can be PRO or APP), start the <code class="docutils literal notranslate"><span class="pre">spi_flash_op_block_func</span></code> function on CPU B using the <code class="docutils literal notranslate"><span class="pre">esp_ipc_call</span></code> API. This API wakes up a high priority task on CPU B and tells it to execute a given function, in this case, <code class="docutils literal notranslate"><span class="pre">spi_flash_op_block_func</span></code>. This function disables cache on CPU B and signals that the cache is disabled by setting the <code class="docutils literal notranslate"><span class="pre">s_flash_op_can_start</span></code> flag. Then the task on CPU A disables cache as well and proceeds to execute flash operation.</p>
<p>While a flash operation is running, interrupts can still run on CPUs A and B. It is assumed that all interrupt code is placed into RAM. Once the interrupt allocation API is added, a flag should be added to request the interrupt to be disabled for the duration of a flash operations.</p>
<p>Once the flash operation is complete, the function on CPU A sets another flag, <code class="docutils literal notranslate"><span class="pre">s_flash_op_complete</span></code>, to let the task on CPU B know that it can re-enable cache and release the CPU. Then the function on CPU A re-enables the cache on CPU A as well and returns control to the calling code.</p>
<p>Additionally, all API functions are protected with a mutex (<code class="docutils literal notranslate"><span class="pre">s_flash_op_mutex</span></code>).</p>
<p>In a single core environment (<a class="reference internal" href="../../kconfig.html#config-freertos-unicore"><span class="std std-ref">CONFIG_FREERTOS_UNICORE</span></a> enabled), you need to disable both caches, so that no inter-CPU communication can take place.</p>
</section>
<section id="related-documents">
<h2>Related Documents<a class="headerlink" href="#related-documents" title="Permalink to this heading"></a></h2>
<p><ul class="simple">
<li><p><a class="reference internal" href="spi_flash_optional_feature.html"><span class="doc">Optional Features for Flash</span></a></p></li>
<li><p><a class="reference internal" href="spi_flash_concurrency.html"><span class="doc">Concurrency Constraints for Flash on SPI1</span></a></p></li>
</ul>
</p>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="api-reference-spi-flash">
<h2>API Reference - SPI Flash<a class="headerlink" href="#api-reference-spi-flash" title="Permalink to this heading"></a></h2>
<section id="header-file">
<h3>Header File<a class="headerlink" href="#header-file" title="Permalink to this heading"></a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/blob/v5.4.2/components/spi_flash/include/esp_flash_spi_init.h">components/spi_flash/include/esp_flash_spi_init.h</a></p></li>
<li><p>This header file can be included with:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;esp_flash_spi_init.h&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>This header file is a part of the API provided by the <code class="docutils literal notranslate"><span class="pre">spi_flash</span></code> component. To declare that your component depends on <code class="docutils literal notranslate"><span class="pre">spi_flash</span></code>, add the following to your CMakeLists.txt:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>REQUIRES spi_flash
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>PRIV_REQUIRES spi_flash
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h3>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424spi_bus_add_flash_devicePP11esp_flash_tPK29esp_flash_spi_device_config_t">
<span id="_CPPv324spi_bus_add_flash_devicePP11esp_flash_tPK29esp_flash_spi_device_config_t"></span><span id="_CPPv224spi_bus_add_flash_devicePP11esp_flash_tPK29esp_flash_spi_device_config_t"></span><span id="spi_bus_add_flash_device__esp_flash_tPP.esp_flash_spi_device_config_tCP"></span><span class="target" id="esp__flash__spi__init_8h_1a91f9a2f5db19be83b03387603841d117"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_bus_add_flash_device</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_chip</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv429esp_flash_spi_device_config_t" title="esp_flash_spi_device_config_t"><span class="n"><span class="pre">esp_flash_spi_device_config_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">config</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424spi_bus_add_flash_devicePP11esp_flash_tPK29esp_flash_spi_device_config_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Add a SPI Flash device onto the SPI bus.</p>
<p>The bus should be already initialized by <code class="docutils literal notranslate"><span class="pre">spi_bus_initialization</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_chip</strong> -- Pointer to hold the initialized chip. </p></li>
<li><p><strong>config</strong> -- Configuration of the chips to initialize.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_ERR_INVALID_ARG: out_chip is NULL, or some field in the config is invalid.</p></li>
<li><p>ESP_ERR_NO_MEM: failed to allocate memory for the chip structures.</p></li>
<li><p>ESP_OK: success. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427spi_bus_remove_flash_deviceP11esp_flash_t">
<span id="_CPPv327spi_bus_remove_flash_deviceP11esp_flash_t"></span><span id="_CPPv227spi_bus_remove_flash_deviceP11esp_flash_t"></span><span id="spi_bus_remove_flash_device__esp_flash_tP"></span><span class="target" id="esp__flash__spi__init_8h_1af932953fb19d81948fead481075d10bb"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_bus_remove_flash_device</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427spi_bus_remove_flash_deviceP11esp_flash_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Remove a SPI Flash device from the SPI bus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chip</strong> -- The flash device to remove.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_ERR_INVALID_ARG: The chip is invalid.</p></li>
<li><p>ESP_OK: success. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="structures">
<h3>Structures<a class="headerlink" href="#structures" title="Permalink to this heading"></a></h3>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv429esp_flash_spi_device_config_t">
<span id="_CPPv329esp_flash_spi_device_config_t"></span><span id="_CPPv229esp_flash_spi_device_config_t"></span><span id="esp_flash_spi_device_config_t"></span><span class="target" id="structesp__flash__spi__device__config__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_spi_device_config_t</span></span></span><a class="headerlink" href="#_CPPv429esp_flash_spi_device_config_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Configurations for the SPI Flash to init. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N29esp_flash_spi_device_config_t7host_idE">
<span id="_CPPv3N29esp_flash_spi_device_config_t7host_idE"></span><span id="_CPPv2N29esp_flash_spi_device_config_t7host_idE"></span><span id="esp_flash_spi_device_config_t::host_id__spi_host_device_t"></span><span class="target" id="structesp__flash__spi__device__config__t_1ad34262ef8627302941d6a1b5a214afb1"></span><a class="reference internal" href="../spi_master.html#_CPPv417spi_host_device_t" title="spi_host_device_t"><span class="n"><span class="pre">spi_host_device_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">host_id</span></span></span><a class="headerlink" href="#_CPPv4N29esp_flash_spi_device_config_t7host_idE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Bus to use. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N29esp_flash_spi_device_config_t9cs_io_numE">
<span id="_CPPv3N29esp_flash_spi_device_config_t9cs_io_numE"></span><span id="_CPPv2N29esp_flash_spi_device_config_t9cs_io_numE"></span><span id="esp_flash_spi_device_config_t::cs_io_num__i"></span><span class="target" id="structesp__flash__spi__device__config__t_1a228ae8731be27d9550bee1343607cb8a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cs_io_num</span></span></span><a class="headerlink" href="#_CPPv4N29esp_flash_spi_device_config_t9cs_io_numE" title="Permalink to this definition"></a><br /></dt>
<dd><p>GPIO pin to output the CS signal. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N29esp_flash_spi_device_config_t7io_modeE">
<span id="_CPPv3N29esp_flash_spi_device_config_t7io_modeE"></span><span id="_CPPv2N29esp_flash_spi_device_config_t7io_modeE"></span><span id="esp_flash_spi_device_config_t::io_mode__esp_flash_io_mode_t"></span><span class="target" id="structesp__flash__spi__device__config__t_1a75cf3f8db7fd32e01a37fab65eaea996"></span><a class="reference internal" href="#_CPPv419esp_flash_io_mode_t" title="esp_flash_io_mode_t"><span class="n"><span class="pre">esp_flash_io_mode_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">io_mode</span></span></span><a class="headerlink" href="#_CPPv4N29esp_flash_spi_device_config_t7io_modeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>IO mode to read from the Flash. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N29esp_flash_spi_device_config_t5speedE">
<span id="_CPPv3N29esp_flash_spi_device_config_t5speedE"></span><span id="_CPPv2N29esp_flash_spi_device_config_t5speedE"></span><span id="esp_flash_spi_device_config_t::speed__esp_flash_speed_s"></span><span class="target" id="structesp__flash__spi__device__config__t_1ac4e68c7ceece9009415d6dd4596c5721"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv417esp_flash_speed_s" title="esp_flash_speed_s"><span class="n"><span class="pre">esp_flash_speed_s</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">speed</span></span></span><a class="headerlink" href="#_CPPv4N29esp_flash_spi_device_config_t5speedE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Speed of the Flash clock. Replaced by freq_mhz. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N29esp_flash_spi_device_config_t14input_delay_nsE">
<span id="_CPPv3N29esp_flash_spi_device_config_t14input_delay_nsE"></span><span id="_CPPv2N29esp_flash_spi_device_config_t14input_delay_nsE"></span><span id="esp_flash_spi_device_config_t::input_delay_ns__i"></span><span class="target" id="structesp__flash__spi__device__config__t_1a2e1b987113f9c99aa18108ec60a73fdd"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">input_delay_ns</span></span></span><a class="headerlink" href="#_CPPv4N29esp_flash_spi_device_config_t14input_delay_nsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Input delay of the data pins, in ns. Set to 0 if unknown. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N29esp_flash_spi_device_config_t5cs_idE">
<span id="_CPPv3N29esp_flash_spi_device_config_t5cs_idE"></span><span id="_CPPv2N29esp_flash_spi_device_config_t5cs_idE"></span><span id="esp_flash_spi_device_config_t::cs_id__i"></span><span class="target" id="structesp__flash__spi__device__config__t_1a8f0fb034115335b6d9a91f99e29e0f08"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cs_id</span></span></span><a class="headerlink" href="#_CPPv4N29esp_flash_spi_device_config_t5cs_idE" title="Permalink to this definition"></a><br /></dt>
<dd><p>CS line ID, ignored when not <code class="docutils literal notranslate"><span class="pre">host_id</span></code> is not SPI1_HOST, or <code class="docutils literal notranslate"><span class="pre">CONFIG_SPI_FLASH_SHARE_SPI1_BUS</span></code> is enabled. In this case, the CS line used is automatically assigned by the SPI bus lock. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N29esp_flash_spi_device_config_t8freq_mhzE">
<span id="_CPPv3N29esp_flash_spi_device_config_t8freq_mhzE"></span><span id="_CPPv2N29esp_flash_spi_device_config_t8freq_mhzE"></span><span id="esp_flash_spi_device_config_t::freq_mhz__i"></span><span class="target" id="structesp__flash__spi__device__config__t_1a3d130ad3981bb064f385ad9497922c96"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">freq_mhz</span></span></span><a class="headerlink" href="#_CPPv4N29esp_flash_spi_device_config_t8freq_mhzE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The frequency of flash chip(MHZ) </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="id1">
<h3>Header File<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/blob/v5.4.2/components/spi_flash/include/esp_flash.h">components/spi_flash/include/esp_flash.h</a></p></li>
<li><p>This header file can be included with:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;esp_flash.h&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>This header file is a part of the API provided by the <code class="docutils literal notranslate"><span class="pre">spi_flash</span></code> component. To declare that your component depends on <code class="docutils literal notranslate"><span class="pre">spi_flash</span></code>, add the following to your CMakeLists.txt:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>REQUIRES spi_flash
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>PRIV_REQUIRES spi_flash
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="id2">
<h3>Functions<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414esp_flash_initP11esp_flash_t">
<span id="_CPPv314esp_flash_initP11esp_flash_t"></span><span id="_CPPv214esp_flash_initP11esp_flash_t"></span><span id="esp_flash_init__esp_flash_tP"></span><span class="target" id="esp__flash_8h_1a7b78c01ff9b885e28ae530d520cf2cd4"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414esp_flash_initP11esp_flash_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initialise SPI flash chip interface. </p>
<p>This function must be called before any other API functions are called for this chip.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only the <code class="docutils literal notranslate"><span class="pre">host</span></code> and <code class="docutils literal notranslate"><span class="pre">read_mode</span></code> fields of the chip structure must be initialised before this function is called. Other fields may be auto-detected if left set to zero or NULL.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the chip-&gt;drv pointer is NULL, chip chip_drv will be auto-detected based on its manufacturer &amp; product IDs. See <code class="docutils literal notranslate"><span class="pre">esp_flash_registered_flash_drivers</span></code> pointer for details of this process.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chip</strong> -- Pointer to SPI flash chip to use. If NULL, esp_flash_default_chip is substituted. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK on success, or a flash error code if initialisation fails. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv433esp_flash_chip_driver_initializedPK11esp_flash_t">
<span id="_CPPv333esp_flash_chip_driver_initializedPK11esp_flash_t"></span><span id="_CPPv233esp_flash_chip_driver_initializedPK11esp_flash_t"></span><span id="esp_flash_chip_driver_initialized__esp_flash_tCP"></span><span class="target" id="esp__flash_8h_1ac0479599990e1a1c4453c14ad36c5869"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_chip_driver_initialized</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv433esp_flash_chip_driver_initializedPK11esp_flash_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if appropriate chip driver is set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chip</strong> -- Pointer to SPI flash chip to use. If NULL, esp_flash_default_chip is substituted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>true if set, otherwise false. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417esp_flash_read_idP11esp_flash_tP8uint32_t">
<span id="_CPPv317esp_flash_read_idP11esp_flash_tP8uint32_t"></span><span id="_CPPv217esp_flash_read_idP11esp_flash_tP8uint32_t"></span><span id="esp_flash_read_id__esp_flash_tP.uint32_tP"></span><span class="target" id="esp__flash_8h_1a9ae74399552dabafaae8b221c7b13f1e"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_read_id</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_id</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417esp_flash_read_idP11esp_flash_tP8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read flash ID via the common &quot;RDID&quot; SPI flash command. </p>
<p>
ID is a 24-bit value. Lower 16 bits of 'id' are the chip ID, upper 8 bits are the manufacturer ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>out_id</strong> -- <strong>[out]</strong> Pointer to receive ID value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK on success, or a flash error code if operation failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418esp_flash_get_sizeP11esp_flash_tP8uint32_t">
<span id="_CPPv318esp_flash_get_sizeP11esp_flash_tP8uint32_t"></span><span id="_CPPv218esp_flash_get_sizeP11esp_flash_tP8uint32_t"></span><span id="esp_flash_get_size__esp_flash_tP.uint32_tP"></span><span class="target" id="esp__flash_8h_1a3e88353604d41a67589c1516e28f7967"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_get_size</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418esp_flash_get_sizeP11esp_flash_tP8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Detect flash size based on flash ID. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>1. Most flash chips use a common format for flash ID, where the lower 4 bits specify the size as a power of 2. If the manufacturer doesn't follow this convention, the size may be incorrectly detected.<ol class="loweralpha simple">
<li><p>The out_size returned only stands for The out_size stands for the size in the binary image header. If you want to get the real size of the chip, please call <code class="docutils literal notranslate"><span class="pre">esp_flash_get_physical_size</span></code> instead.</p></li>
</ol>
</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>out_size</strong> -- <strong>[out]</strong> Detected size in bytes, standing for the size in the binary image header.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK on success, or a flash error code if operation failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427esp_flash_get_physical_sizeP11esp_flash_tP8uint32_t">
<span id="_CPPv327esp_flash_get_physical_sizeP11esp_flash_tP8uint32_t"></span><span id="_CPPv227esp_flash_get_physical_sizeP11esp_flash_tP8uint32_t"></span><span id="esp_flash_get_physical_size__esp_flash_tP.uint32_tP"></span><span class="target" id="esp__flash_8h_1ae461611d61ece106c6a09ecf66f734b2"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_get_physical_size</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">flash_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427esp_flash_get_physical_sizeP11esp_flash_tP8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Detect flash size based on flash ID. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most flash chips use a common format for flash ID, where the lower 4 bits specify the size as a power of 2. If the manufacturer doesn't follow this convention, the size may be incorrectly detected.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>flash_size</strong> -- <strong>[out]</strong> Detected size in bytes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK on success, or a flash error code if operation failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv429esp_flash_read_unique_chip_idP11esp_flash_tP8uint64_t">
<span id="_CPPv329esp_flash_read_unique_chip_idP11esp_flash_tP8uint64_t"></span><span id="_CPPv229esp_flash_read_unique_chip_idP11esp_flash_tP8uint64_t"></span><span id="esp_flash_read_unique_chip_id__esp_flash_tP.uint64_tP"></span><span class="target" id="esp__flash_8h_1a70275046a26071f77294fe2396079c77"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_read_unique_chip_id</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_id</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429esp_flash_read_unique_chip_idP11esp_flash_tP8uint64_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read flash unique ID via the common &quot;RDUID&quot; SPI flash command. </p>
<p>
ID is a 64-bit value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an optional feature, which is not supported on all flash chips. READ PROGRAMMING GUIDE FIRST!</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. Must have been successfully initialised via esp_flash_init(). </p></li>
<li><p><strong>out_id</strong> -- <strong>[out]</strong> Pointer to receive unique ID value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK on success, or a flash error code if operation failed.</p></li>
<li><p>ESP_ERR_NOT_SUPPORTED if the chip doesn't support read id. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420esp_flash_erase_chipP11esp_flash_t">
<span id="_CPPv320esp_flash_erase_chipP11esp_flash_t"></span><span id="_CPPv220esp_flash_erase_chipP11esp_flash_t"></span><span id="esp_flash_erase_chip__esp_flash_tP"></span><span class="target" id="esp__flash_8h_1aa3ce75afa86644bcd48458b438fc97de"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_erase_chip</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420esp_flash_erase_chipP11esp_flash_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Erase flash chip contents. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chip</strong> -- Pointer to identify flash chip. Must have been successfully initialised via esp_flash_init()</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK on success,</p></li>
<li><p>ESP_ERR_NOT_SUPPORTED if the chip is not able to perform the operation. This is indicated by WREN = 1 after the command is sent.</p></li>
<li><p>ESP_ERR_NOT_ALLOWED if a read-only partition is present.</p></li>
<li><p>Other flash error code if operation failed. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422esp_flash_erase_regionP11esp_flash_t8uint32_t8uint32_t">
<span id="_CPPv322esp_flash_erase_regionP11esp_flash_t8uint32_t8uint32_t"></span><span id="_CPPv222esp_flash_erase_regionP11esp_flash_t8uint32_t8uint32_t"></span><span id="esp_flash_erase_region__esp_flash_tP.uint32_t.uint32_t"></span><span class="target" id="esp__flash_8h_1a3463ff7939e150a484c2bfbd5f234611"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_erase_region</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">start</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422esp_flash_erase_regionP11esp_flash_t8uint32_t8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Erase a region of the flash chip. </p>
<p>
Sector size is specified in chip-&gt;drv-&gt;sector_size field (typically 4096 bytes.) ESP_ERR_INVALID_ARG will be returned if the start &amp; length are not a multiple of this size.</p>
<p>Erase is performed using block (multi-sector) erases where possible (block size is specified in chip-&gt;drv-&gt;block_erase_size field, typically 65536 bytes). Remaining sectors are erased using individual sector erase commands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. If NULL, esp_flash_default_chip is substituted. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>start</strong> -- Address to start erasing flash. Must be sector aligned. </p></li>
<li><p><strong>len</strong> -- Length of region to erase. Must also be sector aligned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK on success,</p></li>
<li><p>ESP_ERR_NOT_SUPPORTED if the chip is not able to perform the operation. This is indicated by WREN = 1 after the command is sent.</p></li>
<li><p>ESP_ERR_NOT_ALLOWED if the address range (start  start + len) overlaps with a read-only partition address space</p></li>
<li><p>Other flash error code if operation failed. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv432esp_flash_get_chip_write_protectP11esp_flash_tPb">
<span id="_CPPv332esp_flash_get_chip_write_protectP11esp_flash_tPb"></span><span id="_CPPv232esp_flash_get_chip_write_protectP11esp_flash_tPb"></span><span id="esp_flash_get_chip_write_protect__esp_flash_tP.bP"></span><span class="target" id="esp__flash_8h_1af75fd1e9580c974db822206667aa36f3"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_get_chip_write_protect</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">write_protected</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv432esp_flash_get_chip_write_protectP11esp_flash_tPb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read if the entire chip is write protected. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A correct result for this flag depends on the SPI flash chip model and chip_drv in use (via the 'chip-&gt;drv' field).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. If NULL, esp_flash_default_chip is substituted. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>write_protected</strong> -- <strong>[out]</strong> Pointer to boolean, set to the value of the write protect flag.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK on success, or a flash error code if operation failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv432esp_flash_set_chip_write_protectP11esp_flash_tb">
<span id="_CPPv332esp_flash_set_chip_write_protectP11esp_flash_tb"></span><span id="_CPPv232esp_flash_set_chip_write_protectP11esp_flash_tb"></span><span id="esp_flash_set_chip_write_protect__esp_flash_tP.b"></span><span class="target" id="esp__flash_8h_1a26139972a2be6514ca2174ff9833e39a"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_set_chip_write_protect</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">write_protect</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv432esp_flash_set_chip_write_protectP11esp_flash_tb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set write protection for the SPI flash chip. </p>
<p>
Some SPI flash chips may require a power cycle before write protect status can be cleared. Otherwise, write protection can be removed via a follow-up call to this function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Correct behaviour of this function depends on the SPI flash chip model and chip_drv in use (via the 'chip-&gt;drv' field).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. If NULL, esp_flash_default_chip is substituted. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>write_protect</strong> -- Boolean value for the write protect flag</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK on success, or a flash error code if operation failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv433esp_flash_get_protectable_regionsPK11esp_flash_tPPK18esp_flash_region_tP8uint32_t">
<span id="_CPPv333esp_flash_get_protectable_regionsPK11esp_flash_tPPK18esp_flash_region_tP8uint32_t"></span><span id="_CPPv233esp_flash_get_protectable_regionsPK11esp_flash_tPPK18esp_flash_region_tP8uint32_t"></span><span id="esp_flash_get_protectable_regions__esp_flash_tCP.esp_flash_region_tCPP.uint32_tP"></span><span class="target" id="esp__flash_8h_1a868adb2e74e8d9697ec1b9434e7f2021"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_get_protectable_regions</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv418esp_flash_region_t" title="esp_flash_region_t"><span class="n"><span class="pre">esp_flash_region_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_regions</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_num_regions</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv433esp_flash_get_protectable_regionsPK11esp_flash_tPPK18esp_flash_region_tP8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read the list of individually protectable regions of this SPI flash chip. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Correct behaviour of this function depends on the SPI flash chip model and chip_drv in use (via the 'chip-&gt;drv' field).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>out_regions</strong> -- <strong>[out]</strong> Pointer to receive a pointer to the array of protectable regions of the chip. </p></li>
<li><p><strong>out_num_regions</strong> -- <strong>[out]</strong> Pointer to an integer receiving the count of protectable regions in the array returned in 'regions'.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK on success, or a flash error code if operation failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv430esp_flash_get_protected_regionP11esp_flash_tPK18esp_flash_region_tPb">
<span id="_CPPv330esp_flash_get_protected_regionP11esp_flash_tPK18esp_flash_region_tPb"></span><span id="_CPPv230esp_flash_get_protected_regionP11esp_flash_tPK18esp_flash_region_tPb"></span><span id="esp_flash_get_protected_region__esp_flash_tP.esp_flash_region_tCP.bP"></span><span class="target" id="esp__flash_8h_1a7d0c5c4e6f976774c70712637315c55b"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_get_protected_region</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv418esp_flash_region_t" title="esp_flash_region_t"><span class="n"><span class="pre">esp_flash_region_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">region</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_protected</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv430esp_flash_get_protected_regionP11esp_flash_tPK18esp_flash_region_tPb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Detect if a region of the SPI flash chip is protected. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible for this result to be false and write operations to still fail, if protection is enabled for the entire chip.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Correct behaviour of this function depends on the SPI flash chip model and chip_drv in use (via the 'chip-&gt;drv' field).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>region</strong> -- Pointer to a struct describing a protected region. This must match one of the regions returned from esp_flash_get_protectable_regions(...). </p></li>
<li><p><strong>out_protected</strong> -- <strong>[out]</strong> Pointer to a flag which is set based on the protected status for this region.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK on success, or a flash error code if operation failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv430esp_flash_set_protected_regionP11esp_flash_tPK18esp_flash_region_tb">
<span id="_CPPv330esp_flash_set_protected_regionP11esp_flash_tPK18esp_flash_region_tb"></span><span id="_CPPv230esp_flash_set_protected_regionP11esp_flash_tPK18esp_flash_region_tb"></span><span id="esp_flash_set_protected_region__esp_flash_tP.esp_flash_region_tCP.b"></span><span class="target" id="esp__flash_8h_1a8e088c0f36263ee7198225afeffca8e3"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_set_protected_region</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv418esp_flash_region_t" title="esp_flash_region_t"><span class="n"><span class="pre">esp_flash_region_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">region</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">protect</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv430esp_flash_set_protected_regionP11esp_flash_tPK18esp_flash_region_tb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Update the protected status for a region of the SPI flash chip. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible for the region protection flag to be cleared and write operations to still fail, if protection is enabled for the entire chip.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Correct behaviour of this function depends on the SPI flash chip model and chip_drv in use (via the 'chip-&gt;drv' field).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>region</strong> -- Pointer to a struct describing a protected region. This must match one of the regions returned from esp_flash_get_protectable_regions(...). </p></li>
<li><p><strong>protect</strong> -- Write protection flag to set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK on success, or a flash error code if operation failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414esp_flash_readP11esp_flash_tPv8uint32_t8uint32_t">
<span id="_CPPv314esp_flash_readP11esp_flash_tPv8uint32_t8uint32_t"></span><span id="_CPPv214esp_flash_readP11esp_flash_tPv8uint32_t8uint32_t"></span><span id="esp_flash_read__esp_flash_tP.voidP.uint32_t.uint32_t"></span><span class="target" id="esp__flash_8h_1a3124eba3c0428aa810be82593d49f164"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_read</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">address</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414esp_flash_readP11esp_flash_tPv8uint32_t8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read data from the SPI flash chip. </p>
<p>
There are no alignment constraints on buffer, address or length.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If on-chip flash encryption is used, this function returns raw (ie encrypted) data. Use the flash cache to transparently decrypt data.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. If NULL, esp_flash_default_chip is substituted. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>buffer</strong> -- Pointer to a buffer where the data will be read. To get better performance, this should be in the DRAM and word aligned. </p></li>
<li><p><strong>address</strong> -- Address on flash to read from. Must be less than chip-&gt;size field. </p></li>
<li><p><strong>length</strong> -- Length (in bytes) of data to read.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: success</p></li>
<li><p>ESP_ERR_NO_MEM: Buffer is in external PSRAM which cannot be concurrently accessed, and a temporary internal buffer could not be allocated.</p></li>
<li><p>or a flash error code if operation failed. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415esp_flash_writeP11esp_flash_tPKv8uint32_t8uint32_t">
<span id="_CPPv315esp_flash_writeP11esp_flash_tPKv8uint32_t8uint32_t"></span><span id="_CPPv215esp_flash_writeP11esp_flash_tPKv8uint32_t8uint32_t"></span><span id="esp_flash_write__esp_flash_tP.voidCP.uint32_t.uint32_t"></span><span class="target" id="esp__flash_8h_1ac797be419c7ec74a897ec2292d003f2f"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_write</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">address</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415esp_flash_writeP11esp_flash_tPKv8uint32_t8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Write data to the SPI flash chip. </p>
<p>
There are no alignment constraints on buffer, address or length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. If NULL, esp_flash_default_chip is substituted. Must have been successfully initialised via esp_flash_init() </p></li>
<li><p><strong>address</strong> -- Address on flash to write to. Must be previously erased (SPI NOR flash can only write bits 1-&gt;0). </p></li>
<li><p><strong>buffer</strong> -- Pointer to a buffer with the data to write. To get better performance, this should be in the DRAM and word aligned. </p></li>
<li><p><strong>length</strong> -- Length (in bytes) of data to write.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK on success</p></li>
<li><p>ESP_FAIL, bad write, this will be detected only when CONFIG_SPI_FLASH_VERIFY_WRITE is enabled</p></li>
<li><p>ESP_ERR_NOT_SUPPORTED if the chip is not able to perform the operation. This is indicated by WREN = 1 after the command is sent.</p></li>
<li><p>ESP_ERR_NOT_ALLOWED if the address range (address  address + length) overlaps with a read-only partition address space</p></li>
<li><p>Other flash error code if operation failed. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425esp_flash_write_encryptedP11esp_flash_t8uint32_tPKv8uint32_t">
<span id="_CPPv325esp_flash_write_encryptedP11esp_flash_t8uint32_tPKv8uint32_t"></span><span id="_CPPv225esp_flash_write_encryptedP11esp_flash_t8uint32_tPKv8uint32_t"></span><span id="esp_flash_write_encrypted__esp_flash_tP.uint32_t.voidCP.uint32_t"></span><span class="target" id="esp__flash_8h_1ad30649c5e250eccada206c555be21d34"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_write_encrypted</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">address</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425esp_flash_write_encryptedP11esp_flash_t8uint32_tPKv8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Encrypted and write data to the SPI flash chip using on-chip hardware flash encryption. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both address &amp; length must be 16 byte aligned, as this is the encryption block size</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. Must be NULL (the main flash chip). For other chips, encrypted write is not supported. </p></li>
<li><p><strong>address</strong> -- Address on flash to write to. 16 byte aligned. Must be previously erased (SPI NOR flash can only write bits 1-&gt;0). </p></li>
<li><p><strong>buffer</strong> -- Pointer to a buffer with the data to write. </p></li>
<li><p><strong>length</strong> -- Length (in bytes) of data to write. 16 byte aligned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: on success</p></li>
<li><p>ESP_FAIL: bad write, this will be detected only when CONFIG_SPI_FLASH_VERIFY_WRITE is enabled</p></li>
<li><p>ESP_ERR_NOT_SUPPORTED: encrypted write not supported for this chip.</p></li>
<li><p>ESP_ERR_INVALID_ARG: Either the address, buffer or length is invalid.</p></li>
<li><p>ESP_ERR_NOT_ALLOWED if the address range (address  address + length) overlaps with a read-only partition address space </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424esp_flash_read_encryptedP11esp_flash_t8uint32_tPv8uint32_t">
<span id="_CPPv324esp_flash_read_encryptedP11esp_flash_t8uint32_tPv8uint32_t"></span><span id="_CPPv224esp_flash_read_encryptedP11esp_flash_t8uint32_tPv8uint32_t"></span><span id="esp_flash_read_encrypted__esp_flash_tP.uint32_t.voidP.uint32_t"></span><span class="target" id="esp__flash_8h_1a7a5baa4846df3db2e6a905ffa2ab6272"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_read_encrypted</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">address</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_buffer</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424esp_flash_read_encryptedP11esp_flash_t8uint32_tPv8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read and decrypt data from the SPI flash chip using on-chip hardware flash encryption. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chip</strong> -- Pointer to identify flash chip. Must be NULL (the main flash chip). For other chips, encrypted read is not supported. </p></li>
<li><p><strong>address</strong> -- Address on flash to read from. </p></li>
<li><p><strong>out_buffer</strong> -- Pointer to a buffer for the data to read to. </p></li>
<li><p><strong>length</strong> -- Length (in bytes) of data to read.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK: on success</p></li>
<li><p>ESP_ERR_NOT_SUPPORTED: encrypted read not supported for this chip. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422esp_flash_is_quad_modePK11esp_flash_t">
<span id="_CPPv322esp_flash_is_quad_modePK11esp_flash_t"></span><span id="_CPPv222esp_flash_is_quad_modePK11esp_flash_t"></span><span id="esp_flash_is_quad_mode__esp_flash_tCP"></span><span class="target" id="esp__flash_8h_1a19d9adf990cd3939c2cccebd1fc5c870"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_is_quad_mode</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv411esp_flash_t" title="esp_flash_t"><span class="n"><span class="pre">esp_flash_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chip</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422esp_flash_is_quad_modePK11esp_flash_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Returns true if chip is configured for Quad I/O or Quad Fast Read. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chip</strong> -- Pointer to SPI flash chip to use. If NULL, esp_flash_default_chip is substituted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>true if flash works in quad mode, otherwise false </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id3">
<h3>Structures<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv418esp_flash_region_t">
<span id="_CPPv318esp_flash_region_t"></span><span id="_CPPv218esp_flash_region_t"></span><span id="esp_flash_region_t"></span><span class="target" id="structesp__flash__region__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_region_t</span></span></span><a class="headerlink" href="#_CPPv418esp_flash_region_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure for describing a region of flash. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18esp_flash_region_t6offsetE">
<span id="_CPPv3N18esp_flash_region_t6offsetE"></span><span id="_CPPv2N18esp_flash_region_t6offsetE"></span><span id="esp_flash_region_t::offset__uint32_t"></span><span class="target" id="structesp__flash__region__t_1aac5c054796d5b4d448fa9c2a90d98533"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">offset</span></span></span><a class="headerlink" href="#_CPPv4N18esp_flash_region_t6offsetE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start address of this region. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18esp_flash_region_t4sizeE">
<span id="_CPPv3N18esp_flash_region_t4sizeE"></span><span id="_CPPv2N18esp_flash_region_t4sizeE"></span><span id="esp_flash_region_t::size__uint32_t"></span><span class="target" id="structesp__flash__region__t_1a7d518629b202fc1e31691b954ee9a62b"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><a class="headerlink" href="#_CPPv4N18esp_flash_region_t4sizeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Size of the region. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv424esp_flash_os_functions_t">
<span id="_CPPv324esp_flash_os_functions_t"></span><span id="_CPPv224esp_flash_os_functions_t"></span><span id="esp_flash_os_functions_t"></span><span class="target" id="structesp__flash__os__functions__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_os_functions_t</span></span></span><a class="headerlink" href="#_CPPv424esp_flash_os_functions_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>OS-level integration hooks for accessing flash chips inside a running OS. </p>
<p>It's in the public header because some instances should be allocated statically in the startup code. May be updated according to hardware version and new flash chip feature requirements, shouldn't be treated as public API.</p>
<p>For advanced developers, you may replace some of them with your implementations at your own risk. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N24esp_flash_os_functions_t5startE">
<span id="_CPPv3N24esp_flash_os_functions_t5startE"></span><span id="_CPPv2N24esp_flash_os_functions_t5startE"></span><span class="target" id="structesp__flash__os__functions__t_1a03327849d6fe7e61ab47c4cb9b7e8f6c"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">start</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24esp_flash_os_functions_t5startE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Called before commencing any flash operation. Does not need to be recursive (ie is called at most once for each call to 'end'). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N24esp_flash_os_functions_t3endE">
<span id="_CPPv3N24esp_flash_os_functions_t3endE"></span><span id="_CPPv2N24esp_flash_os_functions_t3endE"></span><span class="target" id="structesp__flash__os__functions__t_1acb785e0f059ab204a63ecd9b68afa192"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">end</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24esp_flash_os_functions_t3endE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Called after completing any flash operation. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N24esp_flash_os_functions_t16region_protectedE">
<span id="_CPPv3N24esp_flash_os_functions_t16region_protectedE"></span><span id="_CPPv2N24esp_flash_os_functions_t16region_protectedE"></span><span class="target" id="structesp__flash__os__functions__t_1aed1c7236b628522b78582c38da148b4c"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">region_protected</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">start_addr</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24esp_flash_os_functions_t16region_protectedE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Called before any erase/write operations to check whether the region is limited by the OS </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N24esp_flash_os_functions_t8delay_usE">
<span id="_CPPv3N24esp_flash_os_functions_t8delay_usE"></span><span id="_CPPv2N24esp_flash_os_functions_t8delay_usE"></span><span class="target" id="structesp__flash__os__functions__t_1a2717ac8f2a409ae3b7d1d994f694fdfd"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">delay_us</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">us</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24esp_flash_os_functions_t8delay_usE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Delay for at least 'us' microseconds. Called in between 'start' and 'end'. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N24esp_flash_os_functions_t15get_temp_bufferE">
<span id="_CPPv3N24esp_flash_os_functions_t15get_temp_bufferE"></span><span id="_CPPv2N24esp_flash_os_functions_t15get_temp_bufferE"></span><span class="target" id="structesp__flash__os__functions__t_1af87b1bb4e8bed69b93159776eae9c602"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">get_temp_buffer</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">reqest_size</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out_size</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24esp_flash_os_functions_t15get_temp_bufferE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Called for get temp buffer when buffer from application cannot be directly read into/write from. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N24esp_flash_os_functions_t19release_temp_bufferE">
<span id="_CPPv3N24esp_flash_os_functions_t19release_temp_bufferE"></span><span id="_CPPv2N24esp_flash_os_functions_t19release_temp_bufferE"></span><span class="target" id="structesp__flash__os__functions__t_1ae4adac15ebc2945c4a0c8c6a61353042"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">release_temp_buffer</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">temp_buf</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24esp_flash_os_functions_t19release_temp_bufferE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Called for release temp buffer. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N24esp_flash_os_functions_t11check_yieldE">
<span id="_CPPv3N24esp_flash_os_functions_t11check_yieldE"></span><span id="_CPPv2N24esp_flash_os_functions_t11check_yieldE"></span><span class="target" id="structesp__flash__os__functions__t_1a2421a030fbeab1b25f5e2f5071ac6093"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">check_yield</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">chip_status</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out_request</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24esp_flash_os_functions_t11check_yieldE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Yield to other tasks. Called during erase operations. </p>
<dl class="field-list simple">
<dt class="field-odd">Return<span class="colon">:</span></dt>
<dd class="field-odd"><p>ESP_OK means yield needs to be called (got an event to handle), while ESP_ERR_TIMEOUT means skip yield. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N24esp_flash_os_functions_t5yieldE">
<span id="_CPPv3N24esp_flash_os_functions_t5yieldE"></span><span id="_CPPv2N24esp_flash_os_functions_t5yieldE"></span><span class="target" id="structesp__flash__os__functions__t_1a687e13477543a6a2dccfe772b560ae2f"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">yield</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out_status</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24esp_flash_os_functions_t5yieldE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Yield to other tasks. Called during erase operations. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N24esp_flash_os_functions_t15get_system_timeE">
<span id="_CPPv3N24esp_flash_os_functions_t15get_system_timeE"></span><span id="_CPPv2N24esp_flash_os_functions_t15get_system_timeE"></span><span class="target" id="structesp__flash__os__functions__t_1a55812269427cd4f845f705c534333b39"></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">get_system_time</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24esp_flash_os_functions_t15get_system_timeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Called for get system time. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N24esp_flash_os_functions_t19set_flash_op_statusE">
<span id="_CPPv3N24esp_flash_os_functions_t19set_flash_op_statusE"></span><span id="_CPPv2N24esp_flash_os_functions_t19set_flash_op_statusE"></span><span class="target" id="structesp__flash__os__functions__t_1a0221154d2ac7543864d48b2d3ae417ae"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">set_flash_op_status</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">op_status</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N24esp_flash_os_functions_t19set_flash_op_statusE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Call to set flash operation status </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv411esp_flash_t">
<span id="_CPPv311esp_flash_t"></span><span id="_CPPv211esp_flash_t"></span><span id="esp_flash_t"></span><span class="target" id="structesp__flash__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_t</span></span></span><a class="headerlink" href="#_CPPv411esp_flash_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure to describe a SPI flash chip connected to the system. </p>
<p>Structure must be initialized before use (passed to esp_flash_init()). It's in the public header because some instances should be allocated statically in the startup code. May be updated according to hardware version and new flash chip feature requirements, shouldn't be treated as public API.</p>
<p>For advanced developers, you may replace some of them with your implementations at your own risk. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11esp_flash_t4hostE">
<span id="_CPPv3N11esp_flash_t4hostE"></span><span id="_CPPv2N11esp_flash_t4hostE"></span><span id="esp_flash_t::host__spi_flash_host_inst_tP"></span><span class="target" id="structesp__flash__t_1a068532322c12e98e037213613911c1fd"></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">host</span></span></span><a class="headerlink" href="#_CPPv4N11esp_flash_t4hostE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to hardware-specific &quot;host_driver&quot; structure. Must be initialized before used. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11esp_flash_t8chip_drvE">
<span id="_CPPv3N11esp_flash_t8chip_drvE"></span><span id="_CPPv2N11esp_flash_t8chip_drvE"></span><span id="esp_flash_t::chip_drv__spi_flash_chip_tCP"></span><span class="target" id="structesp__flash__t_1aab7d29613cd6dff8966fbca826131982"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv416spi_flash_chip_t" title="spi_flash_chip_t"><span class="n"><span class="pre">spi_flash_chip_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">chip_drv</span></span></span><a class="headerlink" href="#_CPPv4N11esp_flash_t8chip_drvE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to chip-model-specific &quot;adapter&quot; structure. If NULL, will be detected during initialisation. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11esp_flash_t7os_funcE">
<span id="_CPPv3N11esp_flash_t7os_funcE"></span><span id="_CPPv2N11esp_flash_t7os_funcE"></span><span id="esp_flash_t::os_func__esp_flash_os_functions_tCP"></span><span class="target" id="structesp__flash__t_1aae53f01d3709cad4e387165691f248bc"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv424esp_flash_os_functions_t" title="esp_flash_os_functions_t"><span class="n"><span class="pre">esp_flash_os_functions_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">os_func</span></span></span><a class="headerlink" href="#_CPPv4N11esp_flash_t7os_funcE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to os-specific hook structure. Call <code class="docutils literal notranslate"><span class="pre">esp_flash_init_os_functions()</span></code> to setup this field, after the host is properly initialized. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11esp_flash_t12os_func_dataE">
<span id="_CPPv3N11esp_flash_t12os_func_dataE"></span><span id="_CPPv2N11esp_flash_t12os_func_dataE"></span><span id="esp_flash_t::os_func_data__voidP"></span><span class="target" id="structesp__flash__t_1a72ca149555a0d3617ac0737f5c06f0ce"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">os_func_data</span></span></span><a class="headerlink" href="#_CPPv4N11esp_flash_t12os_func_dataE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to argument for os-specific hooks. Left NULL and will be initialized with <code class="docutils literal notranslate"><span class="pre">os_func</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11esp_flash_t9read_modeE">
<span id="_CPPv3N11esp_flash_t9read_modeE"></span><span id="_CPPv2N11esp_flash_t9read_modeE"></span><span id="esp_flash_t::read_mode__esp_flash_io_mode_t"></span><span class="target" id="structesp__flash__t_1a7a2be47d1127ec3a6666c1ed492d5549"></span><a class="reference internal" href="#_CPPv419esp_flash_io_mode_t" title="esp_flash_io_mode_t"><span class="n"><span class="pre">esp_flash_io_mode_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_mode</span></span></span><a class="headerlink" href="#_CPPv4N11esp_flash_t9read_modeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Configured SPI flash read mode. Set before <code class="docutils literal notranslate"><span class="pre">esp_flash_init</span></code> is called. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11esp_flash_t4sizeE">
<span id="_CPPv3N11esp_flash_t4sizeE"></span><span id="_CPPv2N11esp_flash_t4sizeE"></span><span id="esp_flash_t::size__uint32_t"></span><span class="target" id="structesp__flash__t_1a241862dd55bf586b82030d6c43ec47cc"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><a class="headerlink" href="#_CPPv4N11esp_flash_t4sizeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Size of SPI flash in bytes. If 0, size will be detected during initialisation. Note: this stands for the size in the binary image header. If you want to get the flash physical size, please call <code class="docutils literal notranslate"><span class="pre">esp_flash_get_physical_size</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11esp_flash_t7chip_idE">
<span id="_CPPv3N11esp_flash_t7chip_idE"></span><span id="_CPPv2N11esp_flash_t7chip_idE"></span><span id="esp_flash_t::chip_id__uint32_t"></span><span class="target" id="structesp__flash__t_1a6b0bbaac1061e0ca1c3498c60dbb4118"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">chip_id</span></span></span><a class="headerlink" href="#_CPPv4N11esp_flash_t7chip_idE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Detected chip id. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11esp_flash_t4busyE">
<span id="_CPPv3N11esp_flash_t4busyE"></span><span id="_CPPv2N11esp_flash_t4busyE"></span><span id="esp_flash_t::busy__uint32_t"></span><span class="target" id="structesp__flash__t_1a9d860aec45616888c51ac1c5032c3543"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">busy</span></span></span><a class="headerlink" href="#_CPPv4N11esp_flash_t4busyE" title="Permalink to this definition"></a><br /></dt>
<dd><p>This flag is used to verify chip's status. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11esp_flash_t13hpm_dummy_enaE">
<span id="_CPPv3N11esp_flash_t13hpm_dummy_enaE"></span><span id="_CPPv2N11esp_flash_t13hpm_dummy_enaE"></span><span id="esp_flash_t::hpm_dummy_ena__uint32_t"></span><span class="target" id="structesp__flash__t_1a4d979c08dedc3b8f77c30f43e611b768"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hpm_dummy_ena</span></span></span><a class="headerlink" href="#_CPPv4N11esp_flash_t13hpm_dummy_enaE" title="Permalink to this definition"></a><br /></dt>
<dd><p>This flag is used to verify whether flash works under HPM status. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11esp_flash_t14reserved_flagsE">
<span id="_CPPv3N11esp_flash_t14reserved_flagsE"></span><span id="_CPPv2N11esp_flash_t14reserved_flagsE"></span><span id="esp_flash_t::reserved_flags__uint32_t"></span><span class="target" id="structesp__flash__t_1acb06189b000dfe60c3526e7cdf9fd4f2"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reserved_flags</span></span></span><a class="headerlink" href="#_CPPv4N11esp_flash_t14reserved_flagsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>reserved. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="macros">
<h3>Macros<a class="headerlink" href="#macros" title="Permalink to this heading"></a></h3>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_YIELD_REQ_YIELD">
<span class="target" id="esp__flash_8h_1abb642ed8b2fbebcb60f72e7128830a04"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_YIELD_REQ_YIELD</span></span></span><a class="headerlink" href="#c.SPI_FLASH_YIELD_REQ_YIELD" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_YIELD_REQ_SUSPEND">
<span class="target" id="esp__flash_8h_1a5e81725924baafc180bd03805c1f06ef"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_YIELD_REQ_SUSPEND</span></span></span><a class="headerlink" href="#c.SPI_FLASH_YIELD_REQ_SUSPEND" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_YIELD_STA_RESUME">
<span class="target" id="esp__flash_8h_1aec24187a48c377b93cc5d573dfeaa38f"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_YIELD_STA_RESUME</span></span></span><a class="headerlink" href="#c.SPI_FLASH_YIELD_STA_RESUME" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_OS_IS_ERASING_STATUS_FLAG">
<span class="target" id="esp__flash_8h_1a062c704c71a152a33354dad5b67c5139"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_OS_IS_ERASING_STATUS_FLAG</span></span></span><a class="headerlink" href="#c.SPI_FLASH_OS_IS_ERASING_STATUS_FLAG" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</section>
<section id="type-definitions">
<h3>Type Definitions<a class="headerlink" href="#type-definitions" title="Permalink to this heading"></a></h3>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv416spi_flash_chip_t">
<span id="_CPPv316spi_flash_chip_t"></span><span id="_CPPv216spi_flash_chip_t"></span><span id="spi_flash_chip_t"></span><span class="target" id="esp__flash_8h_1a0ebb6ac2b4a1b31b03c091308f6645c1"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv416spi_flash_chip_t" title="spi_flash_chip_t"><span class="n"><span class="pre">spi_flash_chip_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_chip_t</span></span></span><a class="headerlink" href="#_CPPv416spi_flash_chip_t" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</section>
<section id="id4">
<h3>Header File<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/blob/v5.4.2/components/spi_flash/include/spi_flash_mmap.h">components/spi_flash/include/spi_flash_mmap.h</a></p></li>
<li><p>This header file can be included with:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;spi_flash_mmap.h&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>This header file is a part of the API provided by the <code class="docutils literal notranslate"><span class="pre">spi_flash</span></code> component. To declare that your component depends on <code class="docutils literal notranslate"><span class="pre">spi_flash</span></code>, add the following to your CMakeLists.txt:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>REQUIRES spi_flash
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>PRIV_REQUIRES spi_flash
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="id5">
<h3>Functions<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414spi_flash_mmap6size_t6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t">
<span id="_CPPv314spi_flash_mmap6size_t6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t"></span><span id="_CPPv214spi_flash_mmap6size_t6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t"></span><span id="spi_flash_mmap__s.s.spi_flash_mmap_memory_t.voidCPP.spi_flash_mmap_handle_tP"></span><span class="target" id="spi__flash__mmap_8h_1a67db63d2f5295f914e5cb26c7f913ee7"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_mmap</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">src_addr</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <a class="reference internal" href="#_CPPv423spi_flash_mmap_memory_t" title="spi_flash_mmap_memory_t"><span class="n"><span class="pre">spi_flash_mmap_memory_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">memory</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_ptr</span></span>, <a class="reference internal" href="#_CPPv423spi_flash_mmap_handle_t" title="spi_flash_mmap_handle_t"><span class="n"><span class="pre">spi_flash_mmap_handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_handle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414spi_flash_mmap6size_t6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Map region of flash memory into data or instruction address space. </p>
<p>This function allocates sufficient number of 64kB MMU pages and configures them to map the requested region of flash memory into the address space. It may reuse MMU pages which already provide the required mapping.</p>
<p>As with any allocator, if mmap/munmap are heavily used then the address space may become fragmented. To troubleshoot issues with page allocation, use spi_flash_mmap_dump() function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src_addr</strong> -- Physical address in flash where requested region starts. This address <em>must</em> be aligned to 64kB boundary (SPI_FLASH_MMU_PAGE_SIZE) </p></li>
<li><p><strong>size</strong> -- Size of region to be mapped. This size will be rounded up to a 64kB boundary </p></li>
<li><p><strong>memory</strong> -- Address space where the region should be mapped (data or instruction) </p></li>
<li><p><strong>out_ptr</strong> -- <strong>[out]</strong> Output, pointer to the mapped memory region </p></li>
<li><p><strong>out_handle</strong> -- <strong>[out]</strong> Output, handle which should be used for spi_flash_munmap call</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK on success, ESP_ERR_NO_MEM if pages can not be allocated </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420spi_flash_mmap_pagesPKi6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t">
<span id="_CPPv320spi_flash_mmap_pagesPKi6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t"></span><span id="_CPPv220spi_flash_mmap_pagesPKi6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t"></span><span id="spi_flash_mmap_pages__iCP.s.spi_flash_mmap_memory_t.voidCPP.spi_flash_mmap_handle_tP"></span><span class="target" id="spi__flash__mmap_8h_1a07a8069d498c0f7645dbf59d5f06a484"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_mmap_pages</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pages</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">page_count</span></span>, <a class="reference internal" href="#_CPPv423spi_flash_mmap_memory_t" title="spi_flash_mmap_memory_t"><span class="n"><span class="pre">spi_flash_mmap_memory_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">memory</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_ptr</span></span>, <a class="reference internal" href="#_CPPv423spi_flash_mmap_handle_t" title="spi_flash_mmap_handle_t"><span class="n"><span class="pre">spi_flash_mmap_handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_handle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420spi_flash_mmap_pagesPKi6size_t23spi_flash_mmap_memory_tPPKvP23spi_flash_mmap_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Map sequences of pages of flash memory into data or instruction address space. </p>
<p>This function allocates sufficient number of 64kB MMU pages and configures them to map the indicated pages of flash memory contiguously into address space. In this respect, it works in a similar way as spi_flash_mmap() but it allows mapping a (maybe non-contiguous) set of pages into a contiguous region of memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pages</strong> -- An array of numbers indicating the 64kB pages in flash to be mapped contiguously into memory. These indicate the indexes of the 64kB pages, not the byte-size addresses as used in other functions. Array must be located in internal memory. </p></li>
<li><p><strong>page_count</strong> -- Number of entries in the pages array </p></li>
<li><p><strong>memory</strong> -- Address space where the region should be mapped (instruction or data) </p></li>
<li><p><strong>out_ptr</strong> -- <strong>[out]</strong> Output, pointer to the mapped memory region </p></li>
<li><p><strong>out_handle</strong> -- <strong>[out]</strong> Output, handle which should be used for spi_flash_munmap call</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ESP_OK on success</p></li>
<li><p>ESP_ERR_NO_MEM if pages can not be allocated</p></li>
<li><p>ESP_ERR_INVALID_ARG if pagecount is zero or pages array is not in internal memory </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416spi_flash_munmap23spi_flash_mmap_handle_t">
<span id="_CPPv316spi_flash_munmap23spi_flash_mmap_handle_t"></span><span id="_CPPv216spi_flash_munmap23spi_flash_mmap_handle_t"></span><span id="spi_flash_munmap__spi_flash_mmap_handle_t"></span><span class="target" id="spi__flash__mmap_8h_1afa00cc4e800e5ed031430d940d7a0001"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_munmap</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv423spi_flash_mmap_handle_t" title="spi_flash_mmap_handle_t"><span class="n"><span class="pre">spi_flash_mmap_handle_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">handle</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416spi_flash_munmap23spi_flash_mmap_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Release region previously obtained using spi_flash_mmap. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calling this function will not necessarily unmap memory region. Region will only be unmapped when there are no other handles which reference this region. In case of partially overlapping regions it is possible that memory will be unmapped partially.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>handle</strong> -- Handle obtained from spi_flash_mmap </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419spi_flash_mmap_dumpv">
<span id="_CPPv319spi_flash_mmap_dumpv"></span><span id="_CPPv219spi_flash_mmap_dumpv"></span><span id="spi_flash_mmap_dump__void"></span><span class="target" id="spi__flash__mmap_8h_1af43766b1060a8e9af2bcecbbdca032ae"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_mmap_dump</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419spi_flash_mmap_dumpv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Display information about mapped regions. </p>
<p>This function lists handles obtained using spi_flash_mmap, along with range of pages allocated to each handle. It also lists all non-zero entries of MMU table and corresponding reference counts. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv429spi_flash_mmap_get_free_pages23spi_flash_mmap_memory_t">
<span id="_CPPv329spi_flash_mmap_get_free_pages23spi_flash_mmap_memory_t"></span><span id="_CPPv229spi_flash_mmap_get_free_pages23spi_flash_mmap_memory_t"></span><span id="spi_flash_mmap_get_free_pages__spi_flash_mmap_memory_t"></span><span class="target" id="spi__flash__mmap_8h_1a1eedf38ddbb1ac55b0199bd8dbcfbae3"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_mmap_get_free_pages</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv423spi_flash_mmap_memory_t" title="spi_flash_mmap_memory_t"><span class="n"><span class="pre">spi_flash_mmap_memory_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">memory</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429spi_flash_mmap_get_free_pages23spi_flash_mmap_memory_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>get free pages number which can be mmap </p>
<p>This function will return number of free pages available in mmu table. This could be useful before calling actual spi_flash_mmap (maps flash range to DCache or ICache memory) to check if there is sufficient space available for mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>memory</strong> -- memory type of MMU table free page</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>number of free pages which can be mmaped </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420spi_flash_cache2physPKv">
<span id="_CPPv320spi_flash_cache2physPKv"></span><span id="_CPPv220spi_flash_cache2physPKv"></span><span id="spi_flash_cache2phys__voidCP"></span><span class="target" id="spi__flash__mmap_8h_1a16fcc5322fcfe1df401ea5820873084f"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_cache2phys</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cached</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420spi_flash_cache2physPKv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Given a memory address where flash is mapped, return the corresponding physical flash offset. </p>
<p>Cache address does not have have been assigned via spi_flash_mmap(), any address in memory mapped flash space can be looked up.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cached</strong> -- Pointer to flashed cached memory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>SPI_FLASH_CACHE2PHYS_FAIL If cache address is outside flash cache region, or the address is not mapped.</p></li>
<li><p>Otherwise, returns physical offset in flash </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420spi_flash_phys2cache6size_t23spi_flash_mmap_memory_t">
<span id="_CPPv320spi_flash_phys2cache6size_t23spi_flash_mmap_memory_t"></span><span id="_CPPv220spi_flash_phys2cache6size_t23spi_flash_mmap_memory_t"></span><span id="spi_flash_phys2cache__s.spi_flash_mmap_memory_t"></span><span class="target" id="spi__flash__mmap_8h_1a75db94a7960c23d34ff89773513d81bd"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_phys2cache</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">phys_offs</span></span>, <a class="reference internal" href="#_CPPv423spi_flash_mmap_memory_t" title="spi_flash_mmap_memory_t"><span class="n"><span class="pre">spi_flash_mmap_memory_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">memory</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420spi_flash_phys2cache6size_t23spi_flash_mmap_memory_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Given a physical offset in flash, return the address where it is mapped in the memory space. </p>
<p>Physical address does not have to have been assigned via spi_flash_mmap(), any address in flash can be looked up.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only the first matching cache address is returned. If MMU flash cache table is configured so multiple entries point to the same physical address, there may be more than one cache address corresponding to that physical address. It is also possible for a single physical address to be mapped to both the IROM and DROM regions.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function doesn't impose any alignment constraints, but if memory argument is SPI_FLASH_MMAP_INST and phys_offs is not 4-byte aligned, then reading from the returned pointer will result in a crash.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phys_offs</strong> -- Physical offset in flash memory to look up. </p></li>
<li><p><strong>memory</strong> -- Address space type to look up a flash cache address mapping for (instruction or data)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>NULL if the physical address is invalid or not mapped to flash cache of the specified memory type.</p></li>
<li><p>Cached memory address (in IROM or DROM space) corresponding to phys_offs. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id6">
<h3>Macros<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h3>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ESP_ERR_FLASH_OP_FAIL">
<span class="target" id="spi__flash__mmap_8h_1a757e63109d77e4ba432f8c9fe76767bd"></span><span class="sig-name descname"><span class="n"><span class="pre">ESP_ERR_FLASH_OP_FAIL</span></span></span><a class="headerlink" href="#c.ESP_ERR_FLASH_OP_FAIL" title="Permalink to this definition"></a><br /></dt>
<dd><p>This file contains <code class="docutils literal notranslate"><span class="pre">spi_flash_mmap_xx</span></code> APIs, mainly for doing memory mapping to an SPI0-connected external Flash, as well as some helper functions to convert between virtual and physical address </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ESP_ERR_FLASH_OP_TIMEOUT">
<span class="target" id="spi__flash__mmap_8h_1ae5b1d442b602258a8d69c2cddd2090bc"></span><span class="sig-name descname"><span class="n"><span class="pre">ESP_ERR_FLASH_OP_TIMEOUT</span></span></span><a class="headerlink" href="#c.ESP_ERR_FLASH_OP_TIMEOUT" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_SEC_SIZE">
<span class="target" id="spi__flash__mmap_8h_1a518257817c69fec25290c1bebad544b0"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_SEC_SIZE</span></span></span><a class="headerlink" href="#c.SPI_FLASH_SEC_SIZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>SPI Flash sector size </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_MMU_PAGE_SIZE">
<span class="target" id="spi__flash__mmap_8h_1a18e85b2d8b00a2f0ebd4fb71b4409e9c"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_MMU_PAGE_SIZE</span></span></span><a class="headerlink" href="#c.SPI_FLASH_MMU_PAGE_SIZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Flash cache MMU mapping page size </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_CACHE2PHYS_FAIL">
<span class="target" id="spi__flash__mmap_8h_1a6f333cc6feedb6777fbe2b74b2f89201"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_CACHE2PHYS_FAIL</span></span></span><a class="headerlink" href="#c.SPI_FLASH_CACHE2PHYS_FAIL" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</section>
<section id="id7">
<h3>Type Definitions<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h3>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv423spi_flash_mmap_handle_t">
<span id="_CPPv323spi_flash_mmap_handle_t"></span><span id="_CPPv223spi_flash_mmap_handle_t"></span><span id="spi_flash_mmap_handle_t"></span><span class="target" id="spi__flash__mmap_8h_1ac5101ad2d6bde58272d6467f8046f8a5"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_mmap_handle_t</span></span></span><a class="headerlink" href="#_CPPv423spi_flash_mmap_handle_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Opaque handle for memory region obtained from spi_flash_mmap. </p>
</dd></dl>

</section>
<section id="enumerations">
<h3>Enumerations<a class="headerlink" href="#enumerations" title="Permalink to this heading"></a></h3>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv423spi_flash_mmap_memory_t">
<span id="_CPPv323spi_flash_mmap_memory_t"></span><span id="_CPPv223spi_flash_mmap_memory_t"></span><span class="target" id="spi__flash__mmap_8h_1aa42bc94be93468811b9b2014039a4534"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_mmap_memory_t</span></span></span><a class="headerlink" href="#_CPPv423spi_flash_mmap_memory_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Enumeration which specifies memory space requested in an mmap call. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_mmap_memory_t19SPI_FLASH_MMAP_DATAE">
<span id="_CPPv3N23spi_flash_mmap_memory_t19SPI_FLASH_MMAP_DATAE"></span><span id="_CPPv2N23spi_flash_mmap_memory_t19SPI_FLASH_MMAP_DATAE"></span><span class="target" id="spi__flash__mmap_8h_1aa42bc94be93468811b9b2014039a4534abdd9b606741a239b9ff14eadfababd7b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_MMAP_DATA</span></span></span><a class="headerlink" href="#_CPPv4N23spi_flash_mmap_memory_t19SPI_FLASH_MMAP_DATAE" title="Permalink to this definition"></a><br /></dt>
<dd><p>map to data memory, allows byte-aligned access </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_mmap_memory_t19SPI_FLASH_MMAP_INSTE">
<span id="_CPPv3N23spi_flash_mmap_memory_t19SPI_FLASH_MMAP_INSTE"></span><span id="_CPPv2N23spi_flash_mmap_memory_t19SPI_FLASH_MMAP_INSTE"></span><span class="target" id="spi__flash__mmap_8h_1aa42bc94be93468811b9b2014039a4534a97ab1deabb3e0febd25c23bef5ce1a3f"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_MMAP_INST</span></span></span><a class="headerlink" href="#_CPPv4N23spi_flash_mmap_memory_t19SPI_FLASH_MMAP_INSTE" title="Permalink to this definition"></a><br /></dt>
<dd><p>map to instruction memory, allows only 4-byte-aligned access </p>
</dd></dl>

</dd></dl>

</section>
<section id="id8">
<h3>Header File<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/blob/v5.4.2/components/hal/include/hal/spi_flash_types.h">components/hal/include/hal/spi_flash_types.h</a></p></li>
<li><p>This header file can be included with:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;hal/spi_flash_types.h&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="id9">
<h3>Structures<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h3>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv417spi_flash_trans_t">
<span id="_CPPv317spi_flash_trans_t"></span><span id="_CPPv217spi_flash_trans_t"></span><span id="spi_flash_trans_t"></span><span class="target" id="structspi__flash__trans__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_trans_t</span></span></span><a class="headerlink" href="#_CPPv417spi_flash_trans_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Definition of a common transaction. Also holds the return value. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t8reservedE">
<span id="_CPPv3N17spi_flash_trans_t8reservedE"></span><span id="_CPPv2N17spi_flash_trans_t8reservedE"></span><span id="spi_flash_trans_t::reserved__uint8_t"></span><span class="target" id="structspi__flash__trans__t_1afa02f35c598da87009d91c727c5ad617"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reserved</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t8reservedE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Reserved, must be 0. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t8mosi_lenE">
<span id="_CPPv3N17spi_flash_trans_t8mosi_lenE"></span><span id="_CPPv2N17spi_flash_trans_t8mosi_lenE"></span><span id="spi_flash_trans_t::mosi_len__uint8_t"></span><span class="target" id="structspi__flash__trans__t_1af459e3524ab8fd4760d04a909006d5f5"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mosi_len</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t8mosi_lenE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Output data length, in bytes. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t8miso_lenE">
<span id="_CPPv3N17spi_flash_trans_t8miso_lenE"></span><span id="_CPPv2N17spi_flash_trans_t8miso_lenE"></span><span id="spi_flash_trans_t::miso_len__uint8_t"></span><span class="target" id="structspi__flash__trans__t_1a8d022195b8e91be82884b7868796679a"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">miso_len</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t8miso_lenE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Input data length, in bytes. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t14address_bitlenE">
<span id="_CPPv3N17spi_flash_trans_t14address_bitlenE"></span><span id="_CPPv2N17spi_flash_trans_t14address_bitlenE"></span><span id="spi_flash_trans_t::address_bitlen__uint8_t"></span><span class="target" id="structspi__flash__trans__t_1ab75a75e9f5d0bf420609a6084fc5a930"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">address_bitlen</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t14address_bitlenE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Length of address in bits, set to 0 if command does not need an address. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t7addressE">
<span id="_CPPv3N17spi_flash_trans_t7addressE"></span><span id="_CPPv2N17spi_flash_trans_t7addressE"></span><span id="spi_flash_trans_t::address__uint32_t"></span><span class="target" id="structspi__flash__trans__t_1a1907ba6ba0c2f8d4cf4a58e78442d3de"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">address</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t7addressE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Address to perform operation on. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t9mosi_dataE">
<span id="_CPPv3N17spi_flash_trans_t9mosi_dataE"></span><span id="_CPPv2N17spi_flash_trans_t9mosi_dataE"></span><span id="spi_flash_trans_t::mosi_data__uint8_tCP"></span><span class="target" id="structspi__flash__trans__t_1a03550980011273b84e961893c9f4e675"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">mosi_data</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t9mosi_dataE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Output data to salve. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t9miso_dataE">
<span id="_CPPv3N17spi_flash_trans_t9miso_dataE"></span><span id="_CPPv2N17spi_flash_trans_t9miso_dataE"></span><span id="spi_flash_trans_t::miso_data__uint8_tP"></span><span class="target" id="structspi__flash__trans__t_1a87ee657fb9bf3d8e3adb01fdc8a23997"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">miso_data</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t9miso_dataE" title="Permalink to this definition"></a><br /></dt>
<dd><p>[out] Input data from slave, little endian </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t5flagsE">
<span id="_CPPv3N17spi_flash_trans_t5flagsE"></span><span id="_CPPv2N17spi_flash_trans_t5flagsE"></span><span id="spi_flash_trans_t::flags__uint32_t"></span><span class="target" id="structspi__flash__trans__t_1aeb4a33af4d1a546fe35651217155acfe"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flags</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t5flagsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Flags for this transaction. Set to 0 for now. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t7commandE">
<span id="_CPPv3N17spi_flash_trans_t7commandE"></span><span id="_CPPv2N17spi_flash_trans_t7commandE"></span><span id="spi_flash_trans_t::command__uint16_t"></span><span class="target" id="structspi__flash__trans__t_1a4eec220e0128baf3c5cb73f5d16c374c"></span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">command</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t7commandE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Command to send. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t12dummy_bitlenE">
<span id="_CPPv3N17spi_flash_trans_t12dummy_bitlenE"></span><span id="_CPPv2N17spi_flash_trans_t12dummy_bitlenE"></span><span id="spi_flash_trans_t::dummy_bitlen__uint8_t"></span><span class="target" id="structspi__flash__trans__t_1a20df26b70d8d24de3d5d1840fcff393a"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dummy_bitlen</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t12dummy_bitlenE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Basic dummy bits to use. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17spi_flash_trans_t7io_modeE">
<span id="_CPPv3N17spi_flash_trans_t7io_modeE"></span><span id="_CPPv2N17spi_flash_trans_t7io_modeE"></span><span id="spi_flash_trans_t::io_mode__uint32_t"></span><span class="target" id="structspi__flash__trans__t_1a20c803528bff057604a4a730f6f7c82f"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">io_mode</span></span></span><a class="headerlink" href="#_CPPv4N17spi_flash_trans_t7io_modeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Flash working mode when <code class="docutils literal notranslate"><span class="pre">SPI_FLASH_IGNORE_BASEIO</span></code> is specified. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv422spi_flash_sus_cmd_conf">
<span id="_CPPv322spi_flash_sus_cmd_conf"></span><span id="_CPPv222spi_flash_sus_cmd_conf"></span><span id="spi_flash_sus_cmd_conf"></span><span class="target" id="structspi__flash__sus__cmd__conf"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_sus_cmd_conf</span></span></span><a class="headerlink" href="#_CPPv422spi_flash_sus_cmd_conf" title="Permalink to this definition"></a><br /></dt>
<dd><p>Configuration structure for the flash chip suspend feature. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_sus_cmd_conf8sus_maskE">
<span id="_CPPv3N22spi_flash_sus_cmd_conf8sus_maskE"></span><span id="_CPPv2N22spi_flash_sus_cmd_conf8sus_maskE"></span><span id="spi_flash_sus_cmd_conf::sus_mask__uint32_t"></span><span class="target" id="structspi__flash__sus__cmd__conf_1a7d253e33d0aabe73e2255c7072a5e2e0"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sus_mask</span></span></span><a class="headerlink" href="#_CPPv4N22spi_flash_sus_cmd_conf8sus_maskE" title="Permalink to this definition"></a><br /></dt>
<dd><p>SUS/SUS1/SUS2 bit in flash register. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_sus_cmd_conf8cmd_rdsrE">
<span id="_CPPv3N22spi_flash_sus_cmd_conf8cmd_rdsrE"></span><span id="_CPPv2N22spi_flash_sus_cmd_conf8cmd_rdsrE"></span><span id="spi_flash_sus_cmd_conf::cmd_rdsr__uint32_t"></span><span class="target" id="structspi__flash__sus__cmd__conf_1a3a4265ac674a92319f46b72a71c904e7"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cmd_rdsr</span></span></span><a class="headerlink" href="#_CPPv4N22spi_flash_sus_cmd_conf8cmd_rdsrE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read flash status register(2) command. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_sus_cmd_conf7sus_cmdE">
<span id="_CPPv3N22spi_flash_sus_cmd_conf7sus_cmdE"></span><span id="_CPPv2N22spi_flash_sus_cmd_conf7sus_cmdE"></span><span id="spi_flash_sus_cmd_conf::sus_cmd__uint32_t"></span><span class="target" id="structspi__flash__sus__cmd__conf_1a02f82fe3b9c72142ef6289bd6ab362fe"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sus_cmd</span></span></span><a class="headerlink" href="#_CPPv4N22spi_flash_sus_cmd_conf7sus_cmdE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Flash suspend command. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_sus_cmd_conf7res_cmdE">
<span id="_CPPv3N22spi_flash_sus_cmd_conf7res_cmdE"></span><span id="_CPPv2N22spi_flash_sus_cmd_conf7res_cmdE"></span><span id="spi_flash_sus_cmd_conf::res_cmd__uint32_t"></span><span class="target" id="structspi__flash__sus__cmd__conf_1a31a70726f7205def0fdcba6a3773b343"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">res_cmd</span></span></span><a class="headerlink" href="#_CPPv4N22spi_flash_sus_cmd_conf7res_cmdE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Flash resume command. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_sus_cmd_conf8reservedE">
<span id="_CPPv3N22spi_flash_sus_cmd_conf8reservedE"></span><span id="_CPPv2N22spi_flash_sus_cmd_conf8reservedE"></span><span id="spi_flash_sus_cmd_conf::reserved__uint32_t"></span><span class="target" id="structspi__flash__sus__cmd__conf_1a53be348bdcdfbffd3be6d87e0476665b"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reserved</span></span></span><a class="headerlink" href="#_CPPv4N22spi_flash_sus_cmd_conf8reservedE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Reserved, set to 0. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv422spi_flash_encryption_t">
<span id="_CPPv322spi_flash_encryption_t"></span><span id="_CPPv222spi_flash_encryption_t"></span><span id="spi_flash_encryption_t"></span><span class="target" id="structspi__flash__encryption__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_encryption_t</span></span></span><a class="headerlink" href="#_CPPv422spi_flash_encryption_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure for flash encryption operations. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_encryption_t23flash_encryption_enableE">
<span id="_CPPv3N22spi_flash_encryption_t23flash_encryption_enableE"></span><span id="_CPPv2N22spi_flash_encryption_t23flash_encryption_enableE"></span><span class="target" id="structspi__flash__encryption__t_1aa1e7c446bb63df65364c41dfec804b4b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">flash_encryption_enable</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N22spi_flash_encryption_t23flash_encryption_enableE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Enable the flash encryption. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_encryption_t24flash_encryption_disableE">
<span id="_CPPv3N22spi_flash_encryption_t24flash_encryption_disableE"></span><span id="_CPPv2N22spi_flash_encryption_t24flash_encryption_disableE"></span><span class="target" id="structspi__flash__encryption__t_1af39a24d7ad4732783a953f30b94797e9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">flash_encryption_disable</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N22spi_flash_encryption_t24flash_encryption_disableE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Disable the flash encryption. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_encryption_t29flash_encryption_data_prepareE">
<span id="_CPPv3N22spi_flash_encryption_t29flash_encryption_data_prepareE"></span><span id="_CPPv2N22spi_flash_encryption_t29flash_encryption_data_prepareE"></span><span class="target" id="structspi__flash__encryption__t_1a6ed72bb2a2d610d3c2fac76af88fd220"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">flash_encryption_data_prepare</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">address</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N22spi_flash_encryption_t29flash_encryption_data_prepareE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Prepare flash encryption before operation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>address and buffer must be 8-word aligned. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Param address<span class="colon">:</span></dt>
<dd class="field-odd"><p>The destination address in flash for the write operation. </p>
</dd>
<dt class="field-even">Param buffer<span class="colon">:</span></dt>
<dd class="field-even"><p>Data for programming </p>
</dd>
<dt class="field-odd">Param size<span class="colon">:</span></dt>
<dd class="field-odd"><p>Size to program.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_encryption_t21flash_encryption_doneE">
<span id="_CPPv3N22spi_flash_encryption_t21flash_encryption_doneE"></span><span id="_CPPv2N22spi_flash_encryption_t21flash_encryption_doneE"></span><span class="target" id="structspi__flash__encryption__t_1ae960203d6b81202e45c28ec1bfbabf74"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">flash_encryption_done</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N22spi_flash_encryption_t21flash_encryption_doneE" title="Permalink to this definition"></a><br /></dt>
<dd><p>flash data encryption operation is done. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_encryption_t24flash_encryption_destroyE">
<span id="_CPPv3N22spi_flash_encryption_t24flash_encryption_destroyE"></span><span id="_CPPv2N22spi_flash_encryption_t24flash_encryption_destroyE"></span><span class="target" id="structspi__flash__encryption__t_1a5e55a6a0bfc2ac710345707f1f623759"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">flash_encryption_destroy</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N22spi_flash_encryption_t24flash_encryption_destroyE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destroy encrypted result </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22spi_flash_encryption_t22flash_encryption_checkE">
<span id="_CPPv3N22spi_flash_encryption_t22flash_encryption_checkE"></span><span id="_CPPv2N22spi_flash_encryption_t22flash_encryption_checkE"></span><span class="target" id="structspi__flash__encryption__t_1a96ebeccde2becf33f9c887091a9ccd77"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">flash_encryption_check</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">address</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N22spi_flash_encryption_t22flash_encryption_checkE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if is qualified to encrypt the buffer</p>
<dl class="field-list simple">
<dt class="field-odd">Param address<span class="colon">:</span></dt>
<dd class="field-odd"><p>the address of written flash partition. </p>
</dd>
<dt class="field-even">Param length<span class="colon">:</span></dt>
<dd class="field-even"><p>Buffer size. </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv421spi_flash_host_inst_t">
<span id="_CPPv321spi_flash_host_inst_t"></span><span id="_CPPv221spi_flash_host_inst_t"></span><span id="spi_flash_host_inst_t"></span><span class="target" id="structspi__flash__host__inst__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></span><a class="headerlink" href="#_CPPv421spi_flash_host_inst_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>SPI Flash Host driver instance </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21spi_flash_host_inst_t6driverE">
<span id="_CPPv3N21spi_flash_host_inst_t6driverE"></span><span id="_CPPv2N21spi_flash_host_inst_t6driverE"></span><span id="spi_flash_host_inst_t::driver__spi_flash_host_driver_sCP"></span><span class="target" id="structspi__flash__host__inst__t_1a0bcbba5c61f5edc2d3896fdc8876064d"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv423spi_flash_host_driver_s" title="spi_flash_host_driver_s"><span class="n"><span class="pre">spi_flash_host_driver_s</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">driver</span></span></span><a class="headerlink" href="#_CPPv4N21spi_flash_host_inst_t6driverE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Pointer to the implementation function table. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv423spi_flash_host_driver_s">
<span id="_CPPv323spi_flash_host_driver_s"></span><span id="_CPPv223spi_flash_host_driver_s"></span><span id="spi_flash_host_driver_s"></span><span class="target" id="structspi__flash__host__driver__s"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_host_driver_s</span></span></span><a class="headerlink" href="#_CPPv423spi_flash_host_driver_s" title="Permalink to this definition"></a><br /></dt>
<dd><p>Host driver configuration and context structure. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s10dev_configE">
<span id="_CPPv3N23spi_flash_host_driver_s10dev_configE"></span><span id="_CPPv2N23spi_flash_host_driver_s10dev_configE"></span><span class="target" id="structspi__flash__host__driver__s_1a229b279e5b7367dae01f7ac949eea85e"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">dev_config</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s10dev_configE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Configure the device-related register before transactions. This saves some time to re-configure those registers when we send continuously </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s14common_commandE">
<span id="_CPPv3N23spi_flash_host_driver_s14common_commandE"></span><span id="_CPPv2N23spi_flash_host_driver_s14common_commandE"></span><span class="target" id="structspi__flash__host__driver__s_1a80bc0f1b42854fb4cc323015d63a7cf9"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">common_command</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv417spi_flash_trans_t" title="spi_flash_trans_t"><span class="n"><span class="pre">spi_flash_trans_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s14common_commandE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Send an user-defined spi transaction to the device. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s7read_idE">
<span id="_CPPv3N23spi_flash_host_driver_s7read_idE"></span><span id="_CPPv2N23spi_flash_host_driver_s7read_idE"></span><span class="target" id="structspi__flash__host__driver__s_1aadc582888a32d8ea06f3d1aebeca7757"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">read_id</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s7read_idE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read flash ID. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s10erase_chipE">
<span id="_CPPv3N23spi_flash_host_driver_s10erase_chipE"></span><span id="_CPPv2N23spi_flash_host_driver_s10erase_chipE"></span><span class="target" id="structspi__flash__host__driver__s_1abc5117edd55bb300a490b924393f82cf"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">erase_chip</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s10erase_chipE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Erase whole flash chip. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s12erase_sectorE">
<span id="_CPPv3N23spi_flash_host_driver_s12erase_sectorE"></span><span id="_CPPv2N23spi_flash_host_driver_s12erase_sectorE"></span><span class="target" id="structspi__flash__host__driver__s_1abe81e9ec1e56f0ae698fd2c40db1da21"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">erase_sector</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">start_address</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s12erase_sectorE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Erase a specific sector by its start address. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s11erase_blockE">
<span id="_CPPv3N23spi_flash_host_driver_s11erase_blockE"></span><span id="_CPPv2N23spi_flash_host_driver_s11erase_blockE"></span><span class="target" id="structspi__flash__host__driver__s_1af55eaa98db8cc607245c611fd086700b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">erase_block</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">start_address</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s11erase_blockE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Erase a specific block by its start address. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s11read_statusE">
<span id="_CPPv3N23spi_flash_host_driver_s11read_statusE"></span><span id="_CPPv2N23spi_flash_host_driver_s11read_statusE"></span><span class="target" id="structspi__flash__host__driver__s_1ab9344bf0471de0c62cfb527f009cd71a"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">read_status</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out_sr</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s11read_statusE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read the status of the flash chip. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s17set_write_protectE">
<span id="_CPPv3N23spi_flash_host_driver_s17set_write_protectE"></span><span id="_CPPv2N23spi_flash_host_driver_s17set_write_protectE"></span><span class="target" id="structspi__flash__host__driver__s_1a60e78fe2f3fb5a4b762b9b01c257e99a"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">set_write_protect</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n"><span class="pre">wp</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s17set_write_protectE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Disable write protection. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s12program_pageE">
<span id="_CPPv3N23spi_flash_host_driver_s12program_pageE"></span><span id="_CPPv2N23spi_flash_host_driver_s12program_pageE"></span><span class="target" id="structspi__flash__host__driver__s_1a8f4e2a1ffb06358c41ee29e4f2ae5520"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">program_page</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">address</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s12program_pageE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Program a page of the flash. Check <code class="docutils literal notranslate"><span class="pre">max_write_bytes</span></code> for the maximum allowed writing length. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s21supports_direct_writeE">
<span id="_CPPv3N23spi_flash_host_driver_s21supports_direct_writeE"></span><span id="_CPPv2N23spi_flash_host_driver_s21supports_direct_writeE"></span><span class="target" id="structspi__flash__host__driver__s_1af1985acacc7226b01b5c34e24339a807"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">supports_direct_write</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s21supports_direct_writeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check whether the SPI host supports direct write. </p>
<p>When cache is disabled, SPI1 doesn't support directly write when buffer isn't internal. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s17write_data_slicerE">
<span id="_CPPv3N23spi_flash_host_driver_s17write_data_slicerE"></span><span id="_CPPv2N23spi_flash_host_driver_s17write_data_slicerE"></span><span class="target" id="structspi__flash__host__driver__s_1a6f7b65969d6481b6e2f706954968d184"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">write_data_slicer</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">address</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">align_addr</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">page_size</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s17write_data_slicerE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Slicer for write data. The <code class="docutils literal notranslate"><span class="pre">program_page</span></code> should be called iteratively with the return value of this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Param address<span class="colon">:</span></dt>
<dd class="field-odd"><p>Beginning flash address to write </p>
</dd>
<dt class="field-even">Param len<span class="colon">:</span></dt>
<dd class="field-even"><p>Length request to write </p>
</dd>
<dt class="field-odd">Param align_addr<span class="colon">:</span></dt>
<dd class="field-odd"><p>Output of the aligned address to write to </p>
</dd>
<dt class="field-even">Param page_size<span class="colon">:</span></dt>
<dd class="field-even"><p>Physical page size of the flash chip </p>
</dd>
<dt class="field-odd">Return<span class="colon">:</span></dt>
<dd class="field-odd"><p>Length that can be actually written in one <code class="docutils literal notranslate"><span class="pre">program_page</span></code> call </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s4readE">
<span id="_CPPv3N23spi_flash_host_driver_s4readE"></span><span id="_CPPv2N23spi_flash_host_driver_s4readE"></span><span class="target" id="structspi__flash__host__driver__s_1a283f7945ca9e38a9ac47852e46a21288"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">read</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">address</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">read_len</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s4readE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Read data from the flash. Check <code class="docutils literal notranslate"><span class="pre">max_read_bytes</span></code> for the maximum allowed reading length. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s20supports_direct_readE">
<span id="_CPPv3N23spi_flash_host_driver_s20supports_direct_readE"></span><span id="_CPPv2N23spi_flash_host_driver_s20supports_direct_readE"></span><span class="target" id="structspi__flash__host__driver__s_1a2c81263e903f4618f23ac5b36744d086"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">supports_direct_read</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s20supports_direct_readE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check whether the SPI host supports direct read. </p>
<p>When cache is disabled, SPI1 doesn't support directly read when the given buffer isn't internal. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s16read_data_slicerE">
<span id="_CPPv3N23spi_flash_host_driver_s16read_data_slicerE"></span><span id="_CPPv2N23spi_flash_host_driver_s16read_data_slicerE"></span><span class="target" id="structspi__flash__host__driver__s_1a188d2fe4341590d9c79eb153c3a13c71"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">read_data_slicer</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">address</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">align_addr</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">page_size</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s16read_data_slicerE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Slicer for read data. The <code class="docutils literal notranslate"><span class="pre">read</span></code> should be called iteratively with the return value of this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Param address<span class="colon">:</span></dt>
<dd class="field-odd"><p>Beginning flash address to read </p>
</dd>
<dt class="field-even">Param len<span class="colon">:</span></dt>
<dd class="field-even"><p>Length request to read </p>
</dd>
<dt class="field-odd">Param align_addr<span class="colon">:</span></dt>
<dd class="field-odd"><p>Output of the aligned address to read </p>
</dd>
<dt class="field-even">Param page_size<span class="colon">:</span></dt>
<dd class="field-even"><p>Physical page size of the flash chip </p>
</dd>
<dt class="field-odd">Return<span class="colon">:</span></dt>
<dd class="field-odd"><p>Length that can be actually read in one <code class="docutils literal notranslate"><span class="pre">read</span></code> call </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s11host_statusE">
<span id="_CPPv3N23spi_flash_host_driver_s11host_statusE"></span><span id="_CPPv2N23spi_flash_host_driver_s11host_statusE"></span><span class="target" id="structspi__flash__host__driver__s_1ac39479cdc73ab92faa6e6be33d51cbeb"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">host_status</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s11host_statusE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check the host status, 0:busy, 1:idle, 2:suspended. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s22configure_host_io_modeE">
<span id="_CPPv3N23spi_flash_host_driver_s22configure_host_io_modeE"></span><span id="_CPPv2N23spi_flash_host_driver_s22configure_host_io_modeE"></span><span class="target" id="structspi__flash__host__driver__s_1a4d20af086a37c16cbc835e5810620eb2"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">configure_host_io_mode</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">command</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">addr_bitlen</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">dummy_bitlen_base</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv419esp_flash_io_mode_t" title="esp_flash_io_mode_t"><span class="n"><span class="pre">esp_flash_io_mode_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">io_mode</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s22configure_host_io_modeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Configure the host to work at different read mode. Responsible to compensate the timing and set IO mode. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s13poll_cmd_doneE">
<span id="_CPPv3N23spi_flash_host_driver_s13poll_cmd_doneE"></span><span id="_CPPv2N23spi_flash_host_driver_s13poll_cmd_doneE"></span><span class="target" id="structspi__flash__host__driver__s_1a09e7efe944b625914ed9a791588eac17"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">poll_cmd_done</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s13poll_cmd_doneE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Internal use, poll the HW until the last operation is done. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s11flush_cacheE">
<span id="_CPPv3N23spi_flash_host_driver_s11flush_cacheE"></span><span id="_CPPv2N23spi_flash_host_driver_s11flush_cacheE"></span><span class="target" id="structspi__flash__host__driver__s_1ab3a629de7c6289af8e7beb8620e16ab2"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">flush_cache</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">addr</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s11flush_cacheE" title="Permalink to this definition"></a><br /></dt>
<dd><p>For some host (SPI1), they are shared with a cache. When the data is modified, the cache needs to be flushed. Left NULL if not supported. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s13check_suspendE">
<span id="_CPPv3N23spi_flash_host_driver_s13check_suspendE"></span><span id="_CPPv2N23spi_flash_host_driver_s13check_suspendE"></span><span class="target" id="structspi__flash__host__driver__s_1ab34136156c9436d8269548c69e50fc9d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">check_suspend</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s13check_suspendE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Suspend check erase/program operation, reserved for ESP32-C3 and ESP32-S3 spi flash ROM IMPL. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s6resumeE">
<span id="_CPPv3N23spi_flash_host_driver_s6resumeE"></span><span id="_CPPv2N23spi_flash_host_driver_s6resumeE"></span><span class="target" id="structspi__flash__host__driver__s_1a3beba5b8ea7e4f6ccfe19b802532de29"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">resume</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s6resumeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Resume flash from suspend manually </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s7suspendE">
<span id="_CPPv3N23spi_flash_host_driver_s7suspendE"></span><span id="_CPPv2N23spi_flash_host_driver_s7suspendE"></span><span class="target" id="structspi__flash__host__driver__s_1a1835035fe58ca6fa76d9ddb8b734aef1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">suspend</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s7suspendE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set flash in suspend status manually </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N23spi_flash_host_driver_s9sus_setupE">
<span id="_CPPv3N23spi_flash_host_driver_s9sus_setupE"></span><span id="_CPPv2N23spi_flash_host_driver_s9sus_setupE"></span><span class="target" id="structspi__flash__host__driver__s_1ac697362c02f20c83368876b13b0fba53"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">sus_setup</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv421spi_flash_host_inst_t" title="spi_flash_host_inst_t"><span class="n"><span class="pre">spi_flash_host_inst_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv422spi_flash_sus_cmd_conf" title="spi_flash_sus_cmd_conf"><span class="n"><span class="pre">spi_flash_sus_cmd_conf</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sus_conf</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N23spi_flash_host_driver_s9sus_setupE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Suspend feature setup for setting cmd and status register mask. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="id10">
<h3>Macros<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h3>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_TRANS_FLAG_CMD16">
<span class="target" id="spi__flash__types_8h_1a526f3a439d1c8199e62d9a6a1e7dc9be"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_TRANS_FLAG_CMD16</span></span></span><a class="headerlink" href="#c.SPI_FLASH_TRANS_FLAG_CMD16" title="Permalink to this definition"></a><br /></dt>
<dd><p>Send command of 16 bits. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_TRANS_FLAG_IGNORE_BASEIO">
<span class="target" id="spi__flash__types_8h_1ac1db3f3eee21c4088b77f5c078d92f3b"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_TRANS_FLAG_IGNORE_BASEIO</span></span></span><a class="headerlink" href="#c.SPI_FLASH_TRANS_FLAG_IGNORE_BASEIO" title="Permalink to this definition"></a><br /></dt>
<dd><p>Not applying the basic io mode configuration for this transaction. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_TRANS_FLAG_BYTE_SWAP">
<span class="target" id="spi__flash__types_8h_1ada3f5df49444a5561d75a206b9563ca7"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_TRANS_FLAG_BYTE_SWAP</span></span></span><a class="headerlink" href="#c.SPI_FLASH_TRANS_FLAG_BYTE_SWAP" title="Permalink to this definition"></a><br /></dt>
<dd><p>Used for DTR mode, to swap the bytes of a pair of rising/falling edge. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_TRANS_FLAG_PE_CMD">
<span class="target" id="spi__flash__types_8h_1a421232c77a1d6608372ec81aa268320f"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_TRANS_FLAG_PE_CMD</span></span></span><a class="headerlink" href="#c.SPI_FLASH_TRANS_FLAG_PE_CMD" title="Permalink to this definition"></a><br /></dt>
<dd><p>Indicates that this transaction is to erase/program flash chip. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_CONFIG_CONF_BITS">
<span class="target" id="spi__flash__types_8h_1a96b6f5600c87687c1231972aefdd6944"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_CONFIG_CONF_BITS</span></span></span><a class="headerlink" href="#c.SPI_FLASH_CONFIG_CONF_BITS" title="Permalink to this definition"></a><br /></dt>
<dd><p>OR the io_mode with this mask, to enable the dummy output feature or replace the first several dummy bits into address to meet the requirements of conf bits. (Used in DIO/QIO/OIO mode) </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_OPI_FLAG">
<span class="target" id="spi__flash__types_8h_1a628fb90a5bc01305e5078d8235c9789a"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_OPI_FLAG</span></span></span><a class="headerlink" href="#c.SPI_FLASH_OPI_FLAG" title="Permalink to this definition"></a><br /></dt>
<dd><p>A flag for flash work in opi mode, the io mode below are opi, above are SPI/QSPI mode. DO NOT use this value in any API. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SPI_FLASH_READ_MODE_MIN">
<span class="target" id="spi__flash__types_8h_1a08d0d2c78907587f31fb100bc7322726"></span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_READ_MODE_MIN</span></span></span><a class="headerlink" href="#c.SPI_FLASH_READ_MODE_MIN" title="Permalink to this definition"></a><br /></dt>
<dd><p>Slowest io mode supported by ESP32, currently SlowRd. </p>
</dd></dl>

</section>
<section id="id11">
<h3>Type Definitions<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h3>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv417esp_flash_speed_t">
<span id="_CPPv317esp_flash_speed_t"></span><span id="_CPPv217esp_flash_speed_t"></span><span id="esp_flash_speed_t"></span><span class="target" id="spi__flash__types_8h_1ae05ed4a28cee9981e0913046d14904ba"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv417esp_flash_speed_s" title="esp_flash_speed_s"><span class="n"><span class="pre">esp_flash_speed_s</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_speed_t</span></span></span><a class="headerlink" href="#_CPPv417esp_flash_speed_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>SPI flash clock speed values, always refer to them by the enum rather than the actual value (more speed may be appended into the list). </p>
<p>A strategy to select the maximum allowed speed is to enumerate from the <code class="docutils literal notranslate"><span class="pre">ESP_FLSH_SPEED_MAX-1</span></code> or highest frequency supported by your flash, and decrease the speed until the probing success. </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv423spi_flash_host_driver_t">
<span id="_CPPv323spi_flash_host_driver_t"></span><span id="_CPPv223spi_flash_host_driver_t"></span><span id="spi_flash_host_driver_t"></span><span class="target" id="spi__flash__types_8h_1a805881f2150c098ba1cf127dcc429419"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv423spi_flash_host_driver_s" title="spi_flash_host_driver_s"><span class="n"><span class="pre">spi_flash_host_driver_s</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_host_driver_t</span></span></span><a class="headerlink" href="#_CPPv423spi_flash_host_driver_t" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</section>
<section id="id12">
<h3>Enumerations<a class="headerlink" href="#id12" title="Permalink to this heading"></a></h3>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv417esp_flash_speed_s">
<span id="_CPPv317esp_flash_speed_s"></span><span id="_CPPv217esp_flash_speed_s"></span><span class="target" id="spi__flash__types_8h_1abe3d8e775a0a9ad6a4c61cbcf7c76a18"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_speed_s</span></span></span><a class="headerlink" href="#_CPPv417esp_flash_speed_s" title="Permalink to this definition"></a><br /></dt>
<dd><p>SPI flash clock speed values, always refer to them by the enum rather than the actual value (more speed may be appended into the list). </p>
<p>A strategy to select the maximum allowed speed is to enumerate from the <code class="docutils literal notranslate"><span class="pre">ESP_FLSH_SPEED_MAX-1</span></code> or highest frequency supported by your flash, and decrease the speed until the probing success. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_flash_speed_s14ESP_FLASH_5MHZE">
<span id="_CPPv3N17esp_flash_speed_s14ESP_FLASH_5MHZE"></span><span id="_CPPv2N17esp_flash_speed_s14ESP_FLASH_5MHZE"></span><span class="target" id="spi__flash__types_8h_1abe3d8e775a0a9ad6a4c61cbcf7c76a18a1cab8d6e02721883cfc7ff5461ef8785"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_5MHZ</span></span></span><a class="headerlink" href="#_CPPv4N17esp_flash_speed_s14ESP_FLASH_5MHZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The flash runs under 5MHz. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_flash_speed_s15ESP_FLASH_10MHZE">
<span id="_CPPv3N17esp_flash_speed_s15ESP_FLASH_10MHZE"></span><span id="_CPPv2N17esp_flash_speed_s15ESP_FLASH_10MHZE"></span><span class="target" id="spi__flash__types_8h_1abe3d8e775a0a9ad6a4c61cbcf7c76a18ae55c8e7045c3263b6cad136cad565bcf"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_10MHZ</span></span></span><a class="headerlink" href="#_CPPv4N17esp_flash_speed_s15ESP_FLASH_10MHZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The flash runs under 10MHz. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_flash_speed_s15ESP_FLASH_20MHZE">
<span id="_CPPv3N17esp_flash_speed_s15ESP_FLASH_20MHZE"></span><span id="_CPPv2N17esp_flash_speed_s15ESP_FLASH_20MHZE"></span><span class="target" id="spi__flash__types_8h_1abe3d8e775a0a9ad6a4c61cbcf7c76a18a632abdc5eb62f5a6ce23eaa199aac478"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_20MHZ</span></span></span><a class="headerlink" href="#_CPPv4N17esp_flash_speed_s15ESP_FLASH_20MHZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The flash runs under 20MHz. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_flash_speed_s15ESP_FLASH_26MHZE">
<span id="_CPPv3N17esp_flash_speed_s15ESP_FLASH_26MHZE"></span><span id="_CPPv2N17esp_flash_speed_s15ESP_FLASH_26MHZE"></span><span class="target" id="spi__flash__types_8h_1abe3d8e775a0a9ad6a4c61cbcf7c76a18acabc9fa546bce680962b7ff66426b6c9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_26MHZ</span></span></span><a class="headerlink" href="#_CPPv4N17esp_flash_speed_s15ESP_FLASH_26MHZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The flash runs under 26MHz. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_flash_speed_s15ESP_FLASH_40MHZE">
<span id="_CPPv3N17esp_flash_speed_s15ESP_FLASH_40MHZE"></span><span id="_CPPv2N17esp_flash_speed_s15ESP_FLASH_40MHZE"></span><span class="target" id="spi__flash__types_8h_1abe3d8e775a0a9ad6a4c61cbcf7c76a18a9fb715119a227e64c18e5d57616ee45d"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_40MHZ</span></span></span><a class="headerlink" href="#_CPPv4N17esp_flash_speed_s15ESP_FLASH_40MHZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The flash runs under 40MHz. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_flash_speed_s15ESP_FLASH_80MHZE">
<span id="_CPPv3N17esp_flash_speed_s15ESP_FLASH_80MHZE"></span><span id="_CPPv2N17esp_flash_speed_s15ESP_FLASH_80MHZE"></span><span class="target" id="spi__flash__types_8h_1abe3d8e775a0a9ad6a4c61cbcf7c76a18a10a689d90b3fef763fedecc27b5a0d5f"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_80MHZ</span></span></span><a class="headerlink" href="#_CPPv4N17esp_flash_speed_s15ESP_FLASH_80MHZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The flash runs under 80MHz. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_flash_speed_s16ESP_FLASH_120MHZE">
<span id="_CPPv3N17esp_flash_speed_s16ESP_FLASH_120MHZE"></span><span id="_CPPv2N17esp_flash_speed_s16ESP_FLASH_120MHZE"></span><span class="target" id="spi__flash__types_8h_1abe3d8e775a0a9ad6a4c61cbcf7c76a18a8fc2540fb017434e478e40ed56c08acd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_120MHZ</span></span></span><a class="headerlink" href="#_CPPv4N17esp_flash_speed_s16ESP_FLASH_120MHZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The flash runs under 120MHz, 120MHZ can only be used by main flash after timing tuning in system. Do not use this directely in any API. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17esp_flash_speed_s19ESP_FLASH_SPEED_MAXE">
<span id="_CPPv3N17esp_flash_speed_s19ESP_FLASH_SPEED_MAXE"></span><span id="_CPPv2N17esp_flash_speed_s19ESP_FLASH_SPEED_MAXE"></span><span class="target" id="spi__flash__types_8h_1abe3d8e775a0a9ad6a4c61cbcf7c76a18a612f2e1e2af71c2f0c83b7dfefd21a50"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_SPEED_MAX</span></span></span><a class="headerlink" href="#_CPPv4N17esp_flash_speed_s19ESP_FLASH_SPEED_MAXE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The maximum frequency supported by the host is <code class="docutils literal notranslate"><span class="pre">ESP_FLASH_SPEED_MAX-1</span></code>. </p>
</dd></dl>

</dd></dl>

<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv419esp_flash_io_mode_t">
<span id="_CPPv319esp_flash_io_mode_t"></span><span id="_CPPv219esp_flash_io_mode_t"></span><span class="target" id="spi__flash__types_8h_1aed5e725de9342f7843c931c3d5119c88"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_io_mode_t</span></span></span><a class="headerlink" href="#_CPPv419esp_flash_io_mode_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Mode used for reading from SPI flash. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_io_mode_t16SPI_FLASH_SLOWRDE">
<span id="_CPPv3N19esp_flash_io_mode_t16SPI_FLASH_SLOWRDE"></span><span id="_CPPv2N19esp_flash_io_mode_t16SPI_FLASH_SLOWRDE"></span><span class="target" id="spi__flash__types_8h_1aed5e725de9342f7843c931c3d5119c88a33fa10dbe9954678f51a2b879ecf8ea0"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_SLOWRD</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_io_mode_t16SPI_FLASH_SLOWRDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Data read using single I/O, some limits on speed. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_io_mode_t16SPI_FLASH_FASTRDE">
<span id="_CPPv3N19esp_flash_io_mode_t16SPI_FLASH_FASTRDE"></span><span id="_CPPv2N19esp_flash_io_mode_t16SPI_FLASH_FASTRDE"></span><span class="target" id="spi__flash__types_8h_1aed5e725de9342f7843c931c3d5119c88a9ecddeabc897117f4b973ab6cf9aeb86"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_FASTRD</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_io_mode_t16SPI_FLASH_FASTRDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Data read using single I/O, no limit on speed. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_io_mode_t14SPI_FLASH_DOUTE">
<span id="_CPPv3N19esp_flash_io_mode_t14SPI_FLASH_DOUTE"></span><span id="_CPPv2N19esp_flash_io_mode_t14SPI_FLASH_DOUTE"></span><span class="target" id="spi__flash__types_8h_1aed5e725de9342f7843c931c3d5119c88aa36a6bbcf39b8c0aaf335e04910f8b7d"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_DOUT</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_io_mode_t14SPI_FLASH_DOUTE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Data read using dual I/O. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_io_mode_t13SPI_FLASH_DIOE">
<span id="_CPPv3N19esp_flash_io_mode_t13SPI_FLASH_DIOE"></span><span id="_CPPv2N19esp_flash_io_mode_t13SPI_FLASH_DIOE"></span><span class="target" id="spi__flash__types_8h_1aed5e725de9342f7843c931c3d5119c88aa860b6d73aecb05afdf29a316be8a192"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_DIO</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_io_mode_t13SPI_FLASH_DIOE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Both address &amp; data transferred using dual I/O. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_io_mode_t14SPI_FLASH_QOUTE">
<span id="_CPPv3N19esp_flash_io_mode_t14SPI_FLASH_QOUTE"></span><span id="_CPPv2N19esp_flash_io_mode_t14SPI_FLASH_QOUTE"></span><span class="target" id="spi__flash__types_8h_1aed5e725de9342f7843c931c3d5119c88aee60fb3a08f89320a8b8f17febfd3c04"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_QOUT</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_io_mode_t14SPI_FLASH_QOUTE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Data read using quad I/O. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_io_mode_t13SPI_FLASH_QIOE">
<span id="_CPPv3N19esp_flash_io_mode_t13SPI_FLASH_QIOE"></span><span id="_CPPv2N19esp_flash_io_mode_t13SPI_FLASH_QIOE"></span><span class="target" id="spi__flash__types_8h_1aed5e725de9342f7843c931c3d5119c88af170aa9a057beb7aa7e0fa75823413cc"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_QIO</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_io_mode_t13SPI_FLASH_QIOE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Both address &amp; data transferred using quad I/O. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_io_mode_t17SPI_FLASH_OPI_STRE">
<span id="_CPPv3N19esp_flash_io_mode_t17SPI_FLASH_OPI_STRE"></span><span id="_CPPv2N19esp_flash_io_mode_t17SPI_FLASH_OPI_STRE"></span><span class="target" id="spi__flash__types_8h_1aed5e725de9342f7843c931c3d5119c88a873f07bac05d2e8be19d554c1edbf6f7"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_OPI_STR</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_io_mode_t17SPI_FLASH_OPI_STRE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Only support on OPI flash, flash read and write under STR mode. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_io_mode_t17SPI_FLASH_OPI_DTRE">
<span id="_CPPv3N19esp_flash_io_mode_t17SPI_FLASH_OPI_DTRE"></span><span id="_CPPv2N19esp_flash_io_mode_t17SPI_FLASH_OPI_DTRE"></span><span class="target" id="spi__flash__types_8h_1aed5e725de9342f7843c931c3d5119c88a874c47b2187c2cb1fdce2c60bfdec888"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_OPI_DTR</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_io_mode_t17SPI_FLASH_OPI_DTRE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Only support on OPI flash, flash read and write under DTR mode. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_io_mode_t23SPI_FLASH_READ_MODE_MAXE">
<span id="_CPPv3N19esp_flash_io_mode_t23SPI_FLASH_READ_MODE_MAXE"></span><span id="_CPPv2N19esp_flash_io_mode_t23SPI_FLASH_READ_MODE_MAXE"></span><span class="target" id="spi__flash__types_8h_1aed5e725de9342f7843c931c3d5119c88ac9b6bffcb1b257f00f0ac5bce2109d58"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SPI_FLASH_READ_MODE_MAX</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_io_mode_t23SPI_FLASH_READ_MODE_MAXE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The fastest io mode supported by the host is <code class="docutils literal notranslate"><span class="pre">ESP_FLASH_READ_MODE_MAX-1</span></code>. </p>
</dd></dl>

</dd></dl>

</section>
<section id="id13">
<h3>Header File<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/blob/v5.4.2/components/hal/include/hal/esp_flash_err.h">components/hal/include/hal/esp_flash_err.h</a></p></li>
<li><p>This header file can be included with:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;hal/esp_flash_err.h&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="id14">
<h3>Macros<a class="headerlink" href="#id14" title="Permalink to this heading"></a></h3>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ESP_ERR_FLASH_NOT_INITIALISED">
<span class="target" id="esp__flash__err_8h_1ac6d0b8ec96f3d419eccd96cfea0a053b"></span><span class="sig-name descname"><span class="n"><span class="pre">ESP_ERR_FLASH_NOT_INITIALISED</span></span></span><a class="headerlink" href="#c.ESP_ERR_FLASH_NOT_INITIALISED" title="Permalink to this definition"></a><br /></dt>
<dd><p>esp_flash_chip_t structure not correctly initialised by esp_flash_init(). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ESP_ERR_FLASH_UNSUPPORTED_HOST">
<span class="target" id="esp__flash__err_8h_1a85b4208fafcae28164ff21da4a9e1317"></span><span class="sig-name descname"><span class="n"><span class="pre">ESP_ERR_FLASH_UNSUPPORTED_HOST</span></span></span><a class="headerlink" href="#c.ESP_ERR_FLASH_UNSUPPORTED_HOST" title="Permalink to this definition"></a><br /></dt>
<dd><p>Requested operation isn't supported via this host SPI bus (chip-&gt;spi field). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ESP_ERR_FLASH_UNSUPPORTED_CHIP">
<span class="target" id="esp__flash__err_8h_1aa958e8d43bf02552c1e2a5ecac006dfd"></span><span class="sig-name descname"><span class="n"><span class="pre">ESP_ERR_FLASH_UNSUPPORTED_CHIP</span></span></span><a class="headerlink" href="#c.ESP_ERR_FLASH_UNSUPPORTED_CHIP" title="Permalink to this definition"></a><br /></dt>
<dd><p>Requested operation isn't supported by this model of SPI flash chip. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ESP_ERR_FLASH_PROTECTED">
<span class="target" id="esp__flash__err_8h_1a9c6650f9a0d3fd405adf45a27dd939d7"></span><span class="sig-name descname"><span class="n"><span class="pre">ESP_ERR_FLASH_PROTECTED</span></span></span><a class="headerlink" href="#c.ESP_ERR_FLASH_PROTECTED" title="Permalink to this definition"></a><br /></dt>
<dd><p>Write operation failed due to chip's write protection being enabled. </p>
</dd></dl>

</section>
<section id="id15">
<h3>Header File<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/blob/v5.4.2/components/spi_flash/include/esp_spi_flash_counters.h">components/spi_flash/include/esp_spi_flash_counters.h</a></p></li>
<li><p>This header file can be included with:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;esp_spi_flash_counters.h&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>This header file is a part of the API provided by the <code class="docutils literal notranslate"><span class="pre">spi_flash</span></code> component. To declare that your component depends on <code class="docutils literal notranslate"><span class="pre">spi_flash</span></code>, add the following to your CMakeLists.txt:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>REQUIRES spi_flash
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>PRIV_REQUIRES spi_flash
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="id16">
<h3>Functions<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h3>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424esp_flash_reset_countersv">
<span id="_CPPv324esp_flash_reset_countersv"></span><span id="_CPPv224esp_flash_reset_countersv"></span><span id="esp_flash_reset_counters__void"></span><span class="target" id="esp__spi__flash__counters_8h_1aa26501f3fb4fd6d0cedf83059e6658db"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_reset_counters</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424esp_flash_reset_countersv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Reset SPI flash operation counters. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424spi_flash_reset_countersv">
<span id="_CPPv324spi_flash_reset_countersv"></span><span id="_CPPv224spi_flash_reset_countersv"></span><span id="spi_flash_reset_counters__void"></span><span class="target" id="esp__spi__flash__counters_8h_1a7a1b5e141401ddcff5e9a30e969ec3c7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_reset_counters</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424spi_flash_reset_countersv" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423esp_flash_dump_countersP4FILE">
<span id="_CPPv323esp_flash_dump_countersP4FILE"></span><span id="_CPPv223esp_flash_dump_countersP4FILE"></span><span id="esp_flash_dump_counters__FILEP"></span><span class="target" id="esp__spi__flash__counters_8h_1aae3210842325cef247080ee63b4288bb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_dump_counters</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423esp_flash_dump_countersP4FILE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Print SPI flash operation counters. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423spi_flash_dump_countersv">
<span id="_CPPv323spi_flash_dump_countersv"></span><span id="_CPPv223spi_flash_dump_countersv"></span><span id="spi_flash_dump_counters__void"></span><span class="target" id="esp__spi__flash__counters_8h_1a69ef40ffe2dbde92ecd839a3c029530c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_dump_counters</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423spi_flash_dump_countersv" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422esp_flash_get_countersv">
<span id="_CPPv322esp_flash_get_countersv"></span><span id="_CPPv222esp_flash_get_countersv"></span><span id="esp_flash_get_counters__void"></span><span class="target" id="esp__spi__flash__counters_8h_1abae4544dfaf43c42f6074ee486c1260e"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420esp_flash_counters_t" title="esp_flash_counters_t"><span class="n"><span class="pre">esp_flash_counters_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_get_counters</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422esp_flash_get_countersv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Return current SPI flash operation counters. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>pointer to the <a class="reference internal" href="#structesp__flash__counters__t"><span class="std std-ref">esp_flash_counters_t</span></a> structure holding values of the operation counters </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422spi_flash_get_countersv">
<span id="_CPPv322spi_flash_get_countersv"></span><span id="_CPPv222spi_flash_get_countersv"></span><span id="spi_flash_get_counters__void"></span><span class="target" id="esp__spi__flash__counters_8h_1a45167fba41cde6448b8874a567517cc2"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420spi_flash_counters_t" title="spi_flash_counters_t"><span class="n"><span class="pre">spi_flash_counters_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_get_counters</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422spi_flash_get_countersv" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</section>
<section id="id17">
<h3>Structures<a class="headerlink" href="#id17" title="Permalink to this heading"></a></h3>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv419esp_flash_counter_t">
<span id="_CPPv319esp_flash_counter_t"></span><span id="_CPPv219esp_flash_counter_t"></span><span id="esp_flash_counter_t"></span><span class="target" id="structesp__flash__counter__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_counter_t</span></span></span><a class="headerlink" href="#_CPPv419esp_flash_counter_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure holding statistics for one type of operation </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_counter_t5countE">
<span id="_CPPv3N19esp_flash_counter_t5countE"></span><span id="_CPPv2N19esp_flash_counter_t5countE"></span><span id="esp_flash_counter_t::count__uint32_t"></span><span class="target" id="structesp__flash__counter__t_1ada9fd5923d83e181f07ab9ac455ed625"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">count</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_counter_t5countE" title="Permalink to this definition"></a><br /></dt>
<dd><p>number of times operation was executed </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_counter_t4timeE">
<span id="_CPPv3N19esp_flash_counter_t4timeE"></span><span id="_CPPv2N19esp_flash_counter_t4timeE"></span><span id="esp_flash_counter_t::time__uint32_t"></span><span class="target" id="structesp__flash__counter__t_1a18a2fca5a0a44d6be3867ed8dc0003eb"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">time</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_counter_t4timeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>total time taken, in microseconds </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N19esp_flash_counter_t5bytesE">
<span id="_CPPv3N19esp_flash_counter_t5bytesE"></span><span id="_CPPv2N19esp_flash_counter_t5bytesE"></span><span id="esp_flash_counter_t::bytes__uint32_t"></span><span class="target" id="structesp__flash__counter__t_1a29bc9271a0cfca66119723cc2ce727f3"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bytes</span></span></span><a class="headerlink" href="#_CPPv4N19esp_flash_counter_t5bytesE" title="Permalink to this definition"></a><br /></dt>
<dd><p>total number of bytes </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv420esp_flash_counters_t">
<span id="_CPPv320esp_flash_counters_t"></span><span id="_CPPv220esp_flash_counters_t"></span><span id="esp_flash_counters_t"></span><span class="target" id="structesp__flash__counters__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_counters_t</span></span></span><a class="headerlink" href="#_CPPv420esp_flash_counters_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure for counters of flash actions </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20esp_flash_counters_t4readE">
<span id="_CPPv3N20esp_flash_counters_t4readE"></span><span id="_CPPv2N20esp_flash_counters_t4readE"></span><span id="esp_flash_counters_t::read__esp_flash_counter_t"></span><span class="target" id="structesp__flash__counters__t_1a17e879a24ac05a3b3a100e4c1bf334d3"></span><a class="reference internal" href="#_CPPv419esp_flash_counter_t" title="esp_flash_counter_t"><span class="n"><span class="pre">esp_flash_counter_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read</span></span></span><a class="headerlink" href="#_CPPv4N20esp_flash_counters_t4readE" title="Permalink to this definition"></a><br /></dt>
<dd><p>counters for read action, like <code class="docutils literal notranslate"><span class="pre">esp_flash_read</span></code></p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20esp_flash_counters_t5writeE">
<span id="_CPPv3N20esp_flash_counters_t5writeE"></span><span id="_CPPv2N20esp_flash_counters_t5writeE"></span><span id="esp_flash_counters_t::write__esp_flash_counter_t"></span><span class="target" id="structesp__flash__counters__t_1ac68ad9fc138df87b2bfa2685b21dec88"></span><a class="reference internal" href="#_CPPv419esp_flash_counter_t" title="esp_flash_counter_t"><span class="n"><span class="pre">esp_flash_counter_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write</span></span></span><a class="headerlink" href="#_CPPv4N20esp_flash_counters_t5writeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>counters for write action, like <code class="docutils literal notranslate"><span class="pre">esp_flash_write</span></code></p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20esp_flash_counters_t5eraseE">
<span id="_CPPv3N20esp_flash_counters_t5eraseE"></span><span id="_CPPv2N20esp_flash_counters_t5eraseE"></span><span id="esp_flash_counters_t::erase__esp_flash_counter_t"></span><span class="target" id="structesp__flash__counters__t_1a4d94527ed7df15e45b9f49aa75ee1a4d"></span><a class="reference internal" href="#_CPPv419esp_flash_counter_t" title="esp_flash_counter_t"><span class="n"><span class="pre">esp_flash_counter_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">erase</span></span></span><a class="headerlink" href="#_CPPv4N20esp_flash_counters_t5eraseE" title="Permalink to this definition"></a><br /></dt>
<dd><p>counters for erase action, like <code class="docutils literal notranslate"><span class="pre">esp_flash_erase</span></code></p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="id18">
<h3>Type Definitions<a class="headerlink" href="#id18" title="Permalink to this heading"></a></h3>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv419spi_flash_counter_t">
<span id="_CPPv319spi_flash_counter_t"></span><span id="_CPPv219spi_flash_counter_t"></span><span id="spi_flash_counter_t"></span><span class="target" id="esp__spi__flash__counters_8h_1a8a10ba65f163254976c93397f2fd3958"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv419esp_flash_counter_t" title="esp_flash_counter_t"><span class="n"><span class="pre">esp_flash_counter_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_counter_t</span></span></span><a class="headerlink" href="#_CPPv419spi_flash_counter_t" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv420spi_flash_counters_t">
<span id="_CPPv320spi_flash_counters_t"></span><span id="_CPPv220spi_flash_counters_t"></span><span id="spi_flash_counters_t"></span><span class="target" id="esp__spi__flash__counters_8h_1aff57481e2d6cbe2b29be1c7b9ed4c2db"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv420esp_flash_counters_t" title="esp_flash_counters_t"><span class="n"><span class="pre">esp_flash_counters_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spi_flash_counters_t</span></span></span><a class="headerlink" href="#_CPPv420spi_flash_counters_t" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</section>
</section>
<section id="api-reference-flash-encrypt">
<h2>API Reference - Flash Encrypt<a class="headerlink" href="#api-reference-flash-encrypt" title="Permalink to this heading"></a></h2>
<section id="id19">
<h3>Header File<a class="headerlink" href="#id19" title="Permalink to this heading"></a></h3>
<ul>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/blob/v5.4.2/components/bootloader_support/include/esp_flash_encrypt.h">components/bootloader_support/include/esp_flash_encrypt.h</a></p></li>
<li><p>This header file can be included with:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;esp_flash_encrypt.h&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>This header file is a part of the API provided by the <code class="docutils literal notranslate"><span class="pre">bootloader_support</span></code> component. To declare that your component depends on <code class="docutils literal notranslate"><span class="pre">bootloader_support</span></code>, add the following to your CMakeLists.txt:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>REQUIRES bootloader_support
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>PRIV_REQUIRES bootloader_support
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="id20">
<h3>Functions<a class="headerlink" href="#id20" title="Permalink to this heading"></a></h3>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428esp_flash_encryption_enabledv">
<span id="_CPPv328esp_flash_encryption_enabledv"></span><span id="_CPPv228esp_flash_encryption_enabledv"></span><span id="esp_flash_encryption_enabled__void"></span><span class="target" id="esp__flash__encrypt_8h_1ac896a074b9d5e43200c0e89a8efac8a1"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encryption_enabled</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428esp_flash_encryption_enabledv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Is flash encryption currently enabled in hardware? </p>
<p>Flash encryption is enabled if the FLASH_CRYPT_CNT efuse has an odd number of bits set.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>true if flash encryption is enabled. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv434esp_flash_encrypt_check_and_updatev">
<span id="_CPPv334esp_flash_encrypt_check_and_updatev"></span><span id="_CPPv234esp_flash_encrypt_check_and_updatev"></span><span id="esp_flash_encrypt_check_and_update__void"></span><span class="target" id="esp__flash__encrypt_8h_1a376fec1755c5f2354e9b1a5353124fa7"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encrypt_check_and_update</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv434esp_flash_encrypt_check_and_updatev" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423esp_flash_encrypt_statev">
<span id="_CPPv323esp_flash_encrypt_statev"></span><span id="_CPPv223esp_flash_encrypt_statev"></span><span id="esp_flash_encrypt_state__void"></span><span class="target" id="esp__flash__encrypt_8h_1a5b01f80e0bc67fff16e2b3c52f921003"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encrypt_state</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423esp_flash_encrypt_statev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Returns the Flash Encryption state and prints it. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True - Flash Encryption is enabled False - Flash Encryption is not enabled </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv434esp_flash_encrypt_initialized_oncev">
<span id="_CPPv334esp_flash_encrypt_initialized_oncev"></span><span id="_CPPv234esp_flash_encrypt_initialized_oncev"></span><span id="esp_flash_encrypt_initialized_once__void"></span><span class="target" id="esp__flash__encrypt_8h_1ab93d9880ec5ec06f30b084cd0c9b24e5"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encrypt_initialized_once</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv434esp_flash_encrypt_initialized_oncev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Checks if the first initialization was done. </p>
<p>If the first initialization was done then FLASH_CRYPT_CNT != 0</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>true - the first initialization was done false - the first initialization was NOT done </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422esp_flash_encrypt_initv">
<span id="_CPPv322esp_flash_encrypt_initv"></span><span id="_CPPv222esp_flash_encrypt_initv"></span><span id="esp_flash_encrypt_init__void"></span><span class="target" id="esp__flash__encrypt_8h_1a720b9ac2150d9d791e743825c8afaab8"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encrypt_init</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422esp_flash_encrypt_initv" title="Permalink to this definition"></a><br /></dt>
<dd><p>The first initialization of Flash Encryption key and related eFuses. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ESP_OK if all operations succeeded </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv426esp_flash_encrypt_contentsv">
<span id="_CPPv326esp_flash_encrypt_contentsv"></span><span id="_CPPv226esp_flash_encrypt_contentsv"></span><span id="esp_flash_encrypt_contents__void"></span><span class="target" id="esp__flash__encrypt_8h_1ad7de6f4522df05ba1f9d6931dd117faf"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encrypt_contents</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv426esp_flash_encrypt_contentsv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Encrypts flash content. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ESP_OK if all operations succeeded </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424esp_flash_encrypt_enablev">
<span id="_CPPv324esp_flash_encrypt_enablev"></span><span id="_CPPv224esp_flash_encrypt_enablev"></span><span id="esp_flash_encrypt_enable__void"></span><span class="target" id="esp__flash__encrypt_8h_1a9424f3b283759b0c0496690568331f4c"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encrypt_enable</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424esp_flash_encrypt_enablev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Activates Flash encryption on the chip. </p>
<p>It burns FLASH_CRYPT_CNT eFuse based on the CONFIG_SECURE_FLASH_ENCRYPTION_MODE_RELEASE option.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ESP_OK if all operations succeeded </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv436esp_flash_encrypt_is_write_protectedb">
<span id="_CPPv336esp_flash_encrypt_is_write_protectedb"></span><span id="_CPPv236esp_flash_encrypt_is_write_protectedb"></span><span id="esp_flash_encrypt_is_write_protected__b"></span><span class="target" id="esp__flash__encrypt_8h_1a6fc45fc2cf1e9a799341854a8562d999"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encrypt_is_write_protected</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">print_error</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv436esp_flash_encrypt_is_write_protectedb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Returns True if the write protection of FLASH_CRYPT_CNT is set. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>print_error</strong> -- Print error if it is write protected</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>true - if FLASH_CRYPT_CNT is write protected </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424esp_flash_encrypt_region8uint32_t6size_t">
<span id="_CPPv324esp_flash_encrypt_region8uint32_t6size_t"></span><span id="_CPPv224esp_flash_encrypt_region8uint32_t6size_t"></span><span id="esp_flash_encrypt_region__uint32_t.s"></span><span class="target" id="esp__flash__encrypt_8h_1adb91c8abee5d745828b9f7f9b4b08bc8"></span><a class="reference internal" href="../../system/esp_err.html#_CPPv49esp_err_t" title="esp_err_t"><span class="n"><span class="pre">esp_err_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encrypt_region</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">src_addr</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">data_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424esp_flash_encrypt_region8uint32_t6size_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Encrypt-in-place a block of flash sectors. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function resets RTC_WDT between operations with sectors. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src_addr</strong> -- Source offset in flash. Should be multiple of 4096 bytes. </p></li>
<li><p><strong>data_length</strong> -- Length of data to encrypt in bytes. Will be rounded up to next multiple of 4096 bytes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ESP_OK if all operations succeeded, ESP_ERR_FLASH_OP_FAIL if SPI flash fails, ESP_ERR_FLASH_OP_TIMEOUT if flash times out. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv433esp_flash_write_protect_crypt_cntv">
<span id="_CPPv333esp_flash_write_protect_crypt_cntv"></span><span id="_CPPv233esp_flash_write_protect_crypt_cntv"></span><span id="esp_flash_write_protect_crypt_cnt__void"></span><span class="target" id="esp__flash__encrypt_8h_1aaba3b45f2534f95c9352cab967042da7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_write_protect_crypt_cnt</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv433esp_flash_write_protect_crypt_cntv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Write protect FLASH_CRYPT_CNT. </p>
<p>Intended to be called as a part of boot process if flash encryption is enabled but secure boot is not used. This should protect against serial re-flashing of an unauthorised code in absence of secure boot.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On ESP32 V3 only, write protecting FLASH_CRYPT_CNT will also prevent disabling UART Download Mode. If both are wanted, call esp_efuse_disable_rom_download_mode() before calling this function. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv429esp_get_flash_encryption_modev">
<span id="_CPPv329esp_get_flash_encryption_modev"></span><span id="_CPPv229esp_get_flash_encryption_modev"></span><span id="esp_get_flash_encryption_mode__void"></span><span class="target" id="esp__flash__encrypt_8h_1a91f3de7fbb44d88e845ceea3fbf5df4c"></span><a class="reference internal" href="#_CPPv420esp_flash_enc_mode_t" title="esp_flash_enc_mode_t"><span class="n"><span class="pre">esp_flash_enc_mode_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_get_flash_encryption_mode</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429esp_get_flash_encryption_modev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Return the flash encryption mode. </p>
<p>The API is called during boot process but can also be called by application to check the current flash encryption mode of ESP32</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv432esp_flash_encryption_init_checksv">
<span id="_CPPv332esp_flash_encryption_init_checksv"></span><span id="_CPPv232esp_flash_encryption_init_checksv"></span><span id="esp_flash_encryption_init_checks__void"></span><span class="target" id="esp__flash__encrypt_8h_1af9fe12110f4a1f9ab1016be2d56fa1da"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encryption_init_checks</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv432esp_flash_encryption_init_checksv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check the flash encryption mode during startup. </p>
<p>
Verifies the flash encryption config during startup:</p>
<p><ul class="simple">
<li><p>Correct any insecure flash encryption settings if hardware Secure Boot is enabled.</p></li>
<li><p>Log warnings if the efuse config doesn't match the project config in any way </p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is called automatically during app startup, it doesn't need to be called from the app.</p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv444esp_flash_encryption_cfg_verify_release_modev">
<span id="_CPPv344esp_flash_encryption_cfg_verify_release_modev"></span><span id="_CPPv244esp_flash_encryption_cfg_verify_release_modev"></span><span id="esp_flash_encryption_cfg_verify_release_mode__void"></span><span class="target" id="esp__flash__encrypt_8h_1ab790e3a928f0a299caa8a525eb60565c"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encryption_cfg_verify_release_mode</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv444esp_flash_encryption_cfg_verify_release_modev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Returns the verification status for all physical security features of flash encryption in release mode. </p>
<p>If the device has flash encryption feature configured in the release mode, then it is highly recommended to call this API in the application startup code. This API verifies the sanity of the eFuse configuration against the release (production) mode of the flash encryption feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>True - all eFuses are configured correctly</p></li>
<li><p>False - not all eFuses are configured correctly. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv437esp_flash_encryption_set_release_modev">
<span id="_CPPv337esp_flash_encryption_set_release_modev"></span><span id="_CPPv237esp_flash_encryption_set_release_modev"></span><span id="esp_flash_encryption_set_release_mode__void"></span><span class="target" id="esp__flash__encrypt_8h_1afeb5bef971b01b7a2a0ee9de7e86e757"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_encryption_set_release_mode</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv437esp_flash_encryption_set_release_modev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Switches Flash Encryption from &quot;Development&quot; to &quot;Release&quot;. </p>
<p>If already in &quot;Release&quot; mode, the function will do nothing. If flash encryption efuse is not enabled yet then abort. It burns:<ul class="simple">
<li><p>&quot;disable encrypt in dl mode&quot;</p></li>
<li><p>set FLASH_CRYPT_CNT efuse to max </p></li>
</ul>
</p>
</dd></dl>

</section>
<section id="id21">
<h3>Enumerations<a class="headerlink" href="#id21" title="Permalink to this heading"></a></h3>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv420esp_flash_enc_mode_t">
<span id="_CPPv320esp_flash_enc_mode_t"></span><span id="_CPPv220esp_flash_enc_mode_t"></span><span class="target" id="esp__flash__encrypt_8h_1af81f69b7147dfc2991374845dc61dc39"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">esp_flash_enc_mode_t</span></span></span><a class="headerlink" href="#_CPPv420esp_flash_enc_mode_t" title="Permalink to this definition"></a><br /></dt>
<dd><p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N20esp_flash_enc_mode_t27ESP_FLASH_ENC_MODE_DISABLEDE">
<span id="_CPPv3N20esp_flash_enc_mode_t27ESP_FLASH_ENC_MODE_DISABLEDE"></span><span id="_CPPv2N20esp_flash_enc_mode_t27ESP_FLASH_ENC_MODE_DISABLEDE"></span><span class="target" id="esp__flash__encrypt_8h_1af81f69b7147dfc2991374845dc61dc39a92d1bf4ad3ddd1b9f96b732fe5a16be6"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_ENC_MODE_DISABLED</span></span></span><a class="headerlink" href="#_CPPv4N20esp_flash_enc_mode_t27ESP_FLASH_ENC_MODE_DISABLEDE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N20esp_flash_enc_mode_t30ESP_FLASH_ENC_MODE_DEVELOPMENTE">
<span id="_CPPv3N20esp_flash_enc_mode_t30ESP_FLASH_ENC_MODE_DEVELOPMENTE"></span><span id="_CPPv2N20esp_flash_enc_mode_t30ESP_FLASH_ENC_MODE_DEVELOPMENTE"></span><span class="target" id="esp__flash__encrypt_8h_1af81f69b7147dfc2991374845dc61dc39a1ce94d84ba5a74d12b2c9b93cb04cce1"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_ENC_MODE_DEVELOPMENT</span></span></span><a class="headerlink" href="#_CPPv4N20esp_flash_enc_mode_t30ESP_FLASH_ENC_MODE_DEVELOPMENTE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N20esp_flash_enc_mode_t26ESP_FLASH_ENC_MODE_RELEASEE">
<span id="_CPPv3N20esp_flash_enc_mode_t26ESP_FLASH_ENC_MODE_RELEASEE"></span><span id="_CPPv2N20esp_flash_enc_mode_t26ESP_FLASH_ENC_MODE_RELEASEE"></span><span class="target" id="esp__flash__encrypt_8h_1af81f69b7147dfc2991374845dc61dc39a49ab7353633dcf61ad8ec88106085bd8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESP_FLASH_ENC_MODE_RELEASE</span></span></span><a class="headerlink" href="#_CPPv4N20esp_flash_enc_mode_t26ESP_FLASH_ENC_MODE_RELEASEE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>
</section>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

           </div>
             <div class="articleComments">

<style>
    .expand-feedback-content {
        display: none;
    }
    .click-like-or-dislike {
        background-color: #d3d3d3;
        pointer-events: none;
    }
</style>

<script>
    function submitFeedbackForm(user_likes_document) {
        // Send to GA4 the user reaction
        gtag('event', 'user_reaction', {
            'user_likes_document': user_likes_document
        });

        if (user_likes_document === 1) {
            document.querySelector('.like-btn').classList.add('click-like-or-dislike');
            document.getElementById("expandContentLike").style.display = 'block';
        } else {
            document.querySelector('.dislike-btn').classList.add('click-like-or-dislike');
            document.getElementById("expandContent").style.display = 'block';
        }

        document.querySelector('.like-btn').style.pointerEvents = 'none';
        document.querySelector('.dislike-btn').style.pointerEvents = 'none';
    }
</script>

<hr>

<p style="text-align:center"><strong>Was this page helpful?</strong></p>
<p style="text-align:center">
    <button class="like-btn" onclick="submitFeedbackForm(1)">
        <svg aria-hidden="true" focusable="false" class="color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom;overflow:visible">
            <path d="M8.834.066c.763.087 1.5.295 2.01.884.505.581.656 1.378.656 2.3 0 .467-.087 1.119-.157 1.637L11.328 5h1.422c.603 0 1.174.085 1.668.333.508.254.911.679 1.137 1.2.453.998.438 2.447.188 4.316l-.04.306c-.105.79-.195 1.473-.313 2.033-.131.63-.315 1.209-.668 1.672C13.97 15.847 12.706 16 11 16c-1.848 0-3.234-.333-4.388-.653-.165-.045-.323-.09-.475-.133-.658-.186-1.2-.34-1.725-.415A1.75 1.75 0 0 1 2.75 16h-1A1.75 1.75 0 0 1 0 14.25v-7.5C0 5.784.784 5 1.75 5h1a1.75 1.75 0 0 1 1.514.872c.258-.105.59-.268.918-.508C5.853 4.874 6.5 4.079 6.5 2.75v-.5c0-1.202.994-2.337 2.334-2.184ZM4.5 13.3c.705.088 1.39.284 2.072.478l.441.125c1.096.305 2.334.598 3.987.598 1.794 0 2.28-.223 2.528-.549.147-.193.276-.505.394-1.07.105-.502.188-1.124.295-1.93l.04-.3c.25-1.882.189-2.933-.068-3.497a.921.921 0 0 0-.442-.48c-.208-.104-.52-.174-.997-.174H11c-.686 0-1.295-.577-1.206-1.336.023-.192.05-.39.076-.586.065-.488.13-.97.13-1.328 0-.809-.144-1.15-.288-1.316-.137-.158-.402-.304-1.048-.378C8.357 1.521 8 1.793 8 2.25v.5c0 1.922-.978 3.128-1.933 3.825a5.831 5.831 0 0 1-1.567.81ZM2.75 6.5h-1a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h1a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
        </svg>
    </button>
    <button class="dislike-btn" onclick="submitFeedbackForm(0)">
        <svg aria-hidden="true" focusable="false" class="" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom;overflow:visible">
            <path d="M7.083 15.986c-.763-.087-1.499-.295-2.011-.884-.504-.581-.655-1.378-.655-2.299 0-.468.087-1.12.157-1.638l.015-.112H3.167c-.603 0-1.174-.086-1.669-.334a2.415 2.415 0 0 1-1.136-1.2c-.454-.998-.438-2.447-.188-4.316l.04-.306C.32 4.108.41 3.424.526 2.864c.132-.63.316-1.209.669-1.672C1.947.205 3.211.053 4.917.053c1.848 0 3.234.332 4.388.652l.474.133c.658.187 1.201.341 1.726.415a1.75 1.75 0 0 1 1.662-1.2h1c.966 0 1.75.784 1.75 1.75v7.5a1.75 1.75 0 0 1-1.75 1.75h-1a1.75 1.75 0 0 1-1.514-.872c-.259.105-.59.268-.919.508-.671.491-1.317 1.285-1.317 2.614v.5c0 1.201-.994 2.336-2.334 2.183Zm4.334-13.232c-.706-.089-1.39-.284-2.072-.479l-.441-.125c-1.096-.304-2.335-.597-3.987-.597-1.794 0-2.28.222-2.529.548-.147.193-.275.505-.393 1.07-.105.502-.188 1.124-.295 1.93l-.04.3c-.25 1.882-.19 2.933.067 3.497a.923.923 0 0 0 .443.48c.208.104.52.175.997.175h1.75c.685 0 1.295.577 1.205 1.335-.022.192-.049.39-.075.586-.066.488-.13.97-.13 1.329 0 .808.144 1.15.288 1.316.137.157.401.303 1.048.377.307.035.664-.237.664-.693v-.5c0-1.922.978-3.127 1.932-3.825a5.878 5.878 0 0 1 1.568-.809Zm1.75 6.798h1a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25h-1a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25Z"></path>
        </svg>
    </button>
</p>

<div class="expand-feedback-content" id="expandContentLike">
    <ul style="text-align:center">
        <li>Thank you! We received your feedback.</li>
        <li>If you have any comments, fill in <a href='https://www.espressif.com/en/company/documents/documentation_feedback?docId=4287&sections=SPI Flash API (api-reference/peripherals/spi_flash/index)&version=esp32 v5.4.2 (v5.4.2)'>Espressif Documentation Feedback Form</a>.</li>
    </ul>
</div>

<div class="expand-feedback-content" id="expandContent">
    <ul style="text-align:center">
        <li>We value your feedback.</li>
        <li>Let us know how we can improve this page by filling in <a href='https://www.espressif.com/en/company/documents/documentation_feedback?docId=4287&sections=SPI Flash API (api-reference/peripherals/spi_flash/index)&version=esp32 v5.4.2 (v5.4.2)'>Espressif Documentation Feedback Form</a>.</li>
    </ul>
</div>

<br>


             </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../sdm.html" class="btn btn-neutral float-left" title="Sigma-Delta Modulation (SDM)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spi_flash_optional_feature.html" class="btn btn-neutral float-right" title="Optional Features for Flash" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016 - 2025, Espressif Systems (Shanghai) Co., Ltd.</p>
  </div>

  <ul class="footer">
        <li>
	    
            
            Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/espressif/sphinx_idf_theme">theme</a>  based on <a href="https://github.com/readthedocs/sphinx_rtd_theme">Read the Docs Sphinx Theme</a>.
         </li>
    <li class="footer-aside">
        <a href="../../../esp-idf-en-v5.4.2.zip"> Download HTML</a>
    </li>

  </ul> 

</footer>
        </div>
      </div>
    </section>
  </div>

  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>